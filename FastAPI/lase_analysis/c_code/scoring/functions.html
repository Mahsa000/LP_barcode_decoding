<!DOCTYPE html>
<!-- Generated by Cython 0.29.36 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: functions.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.36</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="functions.c">functions.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">003</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: <span class="k">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">csr_array</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_csr_array);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_csr_array);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_csr_array);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_csr_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_csr_array, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">floor</span><span class="p">,</span> <span class="nb">round</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: <span class="k">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_warn);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_warn);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_warn);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_warnings, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_warn, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">012</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="n">CUINT8</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint8_t __pyx_t_9functions_CUINT8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">int8_t</span> <span class="n">CINT8</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int8_t __pyx_t_9functions_CINT8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16_t</span> <span class="n">CUINT16</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint16_t __pyx_t_9functions_CUINT16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">int32_t</span> <span class="n">CINT32</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int32_t __pyx_t_9functions_CINT32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">016</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">CUINT32</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint32_t __pyx_t_9functions_CUINT32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint64_t</span> <span class="n">CUINT64</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint64_t __pyx_t_9functions_CUINT64;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">CFLOAT32</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_float32_t __pyx_t_9functions_CFLOAT32;
</pre><pre class="cython line score-0">&#xA0;<span class="">019</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float64_t</span> <span class="n">CFLOAT64</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">021</span>: <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">_0</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_9functions__0 = 0.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>: <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">_1</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_9functions__1 = 1.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">_2</span> <span class="o">=</span> <span class="mf">2.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_9functions__2 = 2.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">024</span>: <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">_05</span> <span class="o">=</span> <span class="o">.</span><span class="mf">5</span></pre>
<pre class='cython code score-0 '>  __pyx_v_9functions__05 = .5;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">025</span>: <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">_INF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="s">&#39;f4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_9functions__INF = __pyx_t_3;
/* … */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_f4);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">026</span>: <span class="k">cdef</span> <span class="kt">CFLOAT64</span> <span class="nf">_INF_64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="s">&#39;f8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_9functions__INF_64 = __pyx_t_4;
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_f8);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
</pre><pre class="cython line score-0">&#xA0;<span class="">027</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>: <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">_1_64</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_9functions__1_64 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>: <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">_2_64</span> <span class="o">=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_9functions__2_64 = 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;c_argsort.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>:   <span class="n">CINT32</span> <span class="n">argsort_F32</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">array</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">indices</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">length</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">inplace</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>:   <span class="n">CINT32</span> <span class="n">argsort_F64</span><span class="p">(</span><span class="n">CFLOAT64</span><span class="o">*</span> <span class="n">array</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">indices</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">length</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">inplace</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: <span class="c"># ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">ItpMatrix</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_9functions_ItpMatrix {
  __pyx_t_9functions_CFLOAT32 *x;
  __pyx_t_9functions_CFLOAT32 *y;
  __pyx_t_9functions_CFLOAT32 *Z;
  __pyx_t_9functions_CFLOAT32 dx;
  __pyx_t_9functions_CFLOAT32 dy;
  __pyx_t_9functions_CINT32 nx;
  __pyx_t_9functions_CINT32 ny;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">037</span>:   <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>:   <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:   <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">Z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>:   <span class="n">CFLOAT32</span> <span class="n">dx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>:   <span class="n">CFLOAT32</span> <span class="n">dy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>:   <span class="n">CINT32</span> <span class="n">nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:   <span class="n">CINT32</span> <span class="n">ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">PinfoStrct</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_9functions_PinfoStrct {
  struct __pyx_t_9functions_ItpMatrix Mok;
  struct __pyx_t_9functions_ItpMatrix Mno;
  __pyx_t_9functions_CFLOAT64 *Coks;
  __pyx_t_9functions_CINT32 ni;
  __pyx_t_9functions_CINT32 nj;
  __pyx_t_9functions_CINT32 nk;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">048</span>:   <span class="n">ItpMatrix</span> <span class="n">Mok</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:   <span class="n">ItpMatrix</span> <span class="n">Mno</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:   <span class="n">CFLOAT64</span><span class="o">*</span> <span class="n">Coks</span> <span class="c"># ni x nj x nk</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:   <span class="n">CINT32</span> <span class="n">ni</span> <span class="c"># mL</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>:   <span class="n">CINT32</span> <span class="n">nj</span> <span class="c"># mH</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:   <span class="n">CINT32</span> <span class="n">nk</span> <span class="c"># nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">LprobStrct</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_9functions_LprobStrct {
  __pyx_t_9functions_CFLOAT64 *plr;
  __pyx_t_9functions_CINT32 *lnx0;
  __pyx_t_9functions_CINT32 *lnx1;
  __pyx_t_9functions_CINT32 *isort;
  __pyx_t_9functions_CFLOAT64 *pprods;
  __pyx_t_9functions_CINT32 *nxs0;
  __pyx_t_9functions_CINT32 *nxs1;
  __pyx_t_9functions_CINT32 mL;
  __pyx_t_9functions_CINT32 mH;
  __pyx_t_9functions_CINT32 nx0;
  __pyx_t_9functions_CINT32 nx1;
  __pyx_t_9functions_CINT32 nx;
  __pyx_t_9functions_CINT32 npairs;
  __pyx_t_9functions_CINT32 cnt;
  __pyx_t_9functions_CINT32 lmax;
  __pyx_t_9functions_CINT32 imax;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">058</span>:   <span class="n">CFLOAT64</span><span class="o">*</span> <span class="n">plr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>:   <span class="n">CINT32</span><span class="o">*</span> <span class="n">lnx0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>:   <span class="n">CINT32</span><span class="o">*</span> <span class="n">lnx1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>:   <span class="n">CINT32</span><span class="o">*</span> <span class="n">isort</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>:   <span class="n">CFLOAT64</span><span class="o">*</span> <span class="n">pprods</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>:   <span class="n">CINT32</span><span class="o">*</span> <span class="n">nxs0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:   <span class="n">CINT32</span><span class="o">*</span> <span class="n">nxs1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:   <span class="n">CINT32</span> <span class="n">mL</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>:   <span class="n">CINT32</span> <span class="n">mH</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>:   <span class="n">CINT32</span> <span class="n">nx0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>:   <span class="n">CINT32</span> <span class="n">nx1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>:   <span class="n">CINT32</span> <span class="n">nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:   <span class="n">CINT32</span> <span class="n">npairs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:   <span class="n">CINT32</span> <span class="n">cnt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:   <span class="n">CINT32</span> <span class="n">lmax</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:   <span class="n">CINT32</span> <span class="n">imax</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: <span class="c"># ----------------------------- SUPPORT FUNCTIONS ------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>: <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">bits_count</span><span class="p">(</span><span class="n">CUINT64</span> <span class="n">num</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static __pyx_t_9functions_CFLOAT32 __pyx_f_9functions_bits_count(__pyx_t_9functions_CUINT64 __pyx_v_num) {
  __pyx_t_9functions_CFLOAT32 __pyx_v_sum_and;
  __pyx_t_9functions_CFLOAT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bits_count", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">sum_and</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_sum_and = 0.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:   <span class="k">while</span> <span class="n">num</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_num != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:     <span class="n">sum_and</span> <span class="o">+=</span> <span class="n">_1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_sum_and = (__pyx_v_sum_and + __pyx_v_9functions__1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:     <span class="n">num</span> <span class="o">&amp;=</span> <span class="n">num</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num = (__pyx_v_num &amp; (__pyx_v_num - 1));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">091</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:   <span class="k">return</span> <span class="n">sum_and</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_sum_and;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">093</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>: <span class="k">def</span> <span class="nf">_nbits64</span><span class="p">(</span><span class="n">CUINT64</span><span class="p">[:]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-23 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_1_nbits64(PyObject *__pyx_self, PyObject *__pyx_arg_arr); /*proto*/
static PyMethodDef __pyx_mdef_9functions_1_nbits64 = {"_nbits64", (PyCFunction)__pyx_pw_9functions_1_nbits64, METH_O, 0};
static PyObject *__pyx_pw_9functions_1_nbits64(PyObject *__pyx_self, PyObject *__pyx_arg_arr) {
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_nbits64 (wrapper)", 0);
  assert(__pyx_arg_arr); {
    __pyx_v_arr = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(__pyx_arg_arr, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 98, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions._nbits64", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions__nbits64(__pyx_self, __pyx_v_arr);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions__nbits64(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_arr) {
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_N;
  PyObject *__pyx_v_sums = NULL;
  __Pyx_memviewslice __pyx_v__sums_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_nbits64", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions._nbits64", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sums);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__sums_, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_arr, __pyx_n_s_arr, __pyx_n_s_i, __pyx_n_s_N, __pyx_n_s_sums, __pyx_n_s_sums_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_1_nbits64, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_nbits64, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__26 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_nbits64, 98, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">N</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">arr</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-9 '>  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_arr, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyInt_As_npy_int32(__pyx_t_2); if (unlikely((__pyx_t_3 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_N = ((__pyx_t_9functions_CINT32)__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">100</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:   <span class="n">sums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_npy_int32(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_sums = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_sums_</span> <span class="o">=</span> <span class="n">sums</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_sums, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  __pyx_v__sums_ = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">103</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">_sums_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bits_count</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_N;
  __pyx_t_8 = __pyx_t_3;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = __pyx_v_i;
    *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__sums_.data + __pyx_t_11 * __pyx_v__sums_.strides[0]) )) = __pyx_f_9functions_bits_count((*((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_10 * __pyx_v_arr.strides[0]) ))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">105</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>:   <span class="k">return</span> <span class="n">sums</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sums);
  __pyx_r = __pyx_v_sums;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: <span class="c"># error code -1000</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">binom</span><span class="p">(</span><span class="n">CINT32</span> <span class="n">k</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions_binom(__pyx_t_9functions_CINT32 __pyx_v_k, __pyx_t_9functions_CINT32 __pyx_v_n) {
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_val;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("binom", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:   <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_k == 0) != 0);
  if (__pyx_t_1) {
    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:   <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="n">n</span><span class="p">:</span> <span class="k">return</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_k == __pyx_v_n) != 0);
  if (__pyx_t_1) {
    __pyx_r = 1;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:   <span class="k">if</span> <span class="n">k</span><span class="o">&gt;</span><span class="n">n</span><span class="p">:</span>  <span class="k">return</span> <span class="o">-</span><span class="mf">1000</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_k &gt; __pyx_v_n) != 0);
  if (__pyx_t_1) {
    __pyx_r = -1000;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">117</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">val</span><span class="o">=</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_val = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">//</span><span class="n">i</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_k + 1);
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 1; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
    __pyx_v_val = ((__pyx_v_val * ((__pyx_v_n - __pyx_v_i) + 1)) / __pyx_v_i);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:   <span class="k">return</span> <span class="n">val</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_val;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">121</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>: <span class="c"># --------------------------- INTERPOLATION FUNCTION ---------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>: <span class="k">def</span> <span class="nf">interp1d</span><span class="p">(</span><span class="n">CFLOAT32</span> <span class="n">val</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-56 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_3interp1d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_3interp1d = {"interp1d", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_3interp1d, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_3interp1d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __pyx_t_9functions_CFLOAT32 __pyx_v_val;
  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("interp1d (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_val,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_val)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp1d", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp1d", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "interp1d") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_val = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_val == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L3_error)</span>
    __pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 130, __pyx_L3_error)</span>
    __pyx_v_y = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(0, 130, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp1d", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.interp1d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_2interp1d(__pyx_self, __pyx_v_val, __pyx_v_x, __pyx_v_y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_2interp1d(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_9functions_CFLOAT32 __pyx_v_val, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {
  __pyx_t_9functions_CINT32 __pyx_v_n;
  __pyx_t_9functions_CFLOAT32 __pyx_v_out;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("interp1d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.interp1d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_val, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_n, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_3interp1d, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_interp1d, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_interp1d, 130, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">n</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_x); 
  __pyx_v_n = ((__pyx_t_9functions_CINT32)__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">132</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:   <span class="n">_interp1d</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (void)(__pyx_f_9functions__interp1d(__pyx_v_val, __pyx_v_x, __pyx_v_y, __pyx_v_n, (&amp;__pyx_v_out)));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_out);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>: <span class="c"># error code: -1100</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">_interp1d</span><span class="p">(</span><span class="n">CFLOAT32</span> <span class="n">xp</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">y</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">n</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">out</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions__interp1d(__pyx_t_9functions_CFLOAT32 __pyx_v_xp, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __pyx_t_9functions_CINT32 __pyx_v_n, __pyx_t_9functions_CFLOAT32 *__pyx_v_out) {
  __pyx_t_9functions_CFLOAT32 __pyx_v_dx;
  __pyx_t_9functions_CFLOAT32 __pyx_v_f;
  __pyx_t_9functions_CINT32 __pyx_v_k0;
  __pyx_t_9functions_CINT32 __pyx_v_k1;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_interp1d", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:   <span class="n">xp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mf">1</span><span class="p">]),</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_1 * __pyx_v_x.strides[0]) )));
  __pyx_t_1 = (__pyx_v_n - 1);
  __pyx_t_3 = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_1 * __pyx_v_x.strides[0]) )));
  __pyx_t_4 = __pyx_v_xp;
  if (((__pyx_t_3 &lt; __pyx_t_4) != 0)) {
    __pyx_t_5 = __pyx_t_3;
  } else {
    __pyx_t_5 = __pyx_t_4;
  }
  __pyx_t_3 = __pyx_t_5;
  if (((__pyx_t_2 &gt; __pyx_t_3) != 0)) {
    __pyx_t_5 = __pyx_t_2;
  } else {
    __pyx_t_5 = __pyx_t_3;
  }
  __pyx_v_xp = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">144</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">dx</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">f</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 1;
  __pyx_t_6 = 0;
  __pyx_v_dx = ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_1 * __pyx_v_x.strides[0]) ))) - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_6 * __pyx_v_x.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">146</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">k0</span><span class="p">,</span><span class="nf">k1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:   <span class="n">k0</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">((</span><span class="n">xp</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = 0;
  __pyx_v_k0 = ((__pyx_t_9functions_CINT32)floor(((__pyx_v_xp - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_6 * __pyx_v_x.strides[0]) )))) / __pyx_v_dx)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">k0</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">k0</span><span class="o">&lt;</span><span class="n">n</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span> <span class="n">k1</span> <span class="o">=</span> <span class="n">k0</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (((__pyx_v_k0 &gt;= 0) &amp; (__pyx_v_k0 &lt; (__pyx_v_n - 1))) != 0);
  if (__pyx_t_7) {
    __pyx_v_k1 = (__pyx_v_k0 + 1);
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:   <span class="k">elif</span> <span class="p">(</span><span class="n">k0</span><span class="o">==</span><span class="n">n</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span>      <span class="n">k1</span> <span class="o">=</span> <span class="n">k0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_k0 == (__pyx_v_n - 1)) != 0);
  if (__pyx_t_7) {
    __pyx_v_k1 = __pyx_v_k0;
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:   <span class="k">else</span><span class="p">:</span>                <span class="k">return</span> <span class="o">-</span><span class="mf">1100</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = -1100;
    goto __pyx_L0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:   <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">xp</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">k0</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_k0;
  __pyx_v_f = ((__pyx_v_xp - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_6 * __pyx_v_x.strides[0]) )))) / __pyx_v_dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:   <span class="n">out</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">k0</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">k0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_k0;
  __pyx_t_1 = __pyx_v_k1;
  __pyx_t_8 = __pyx_v_k0;
  (__pyx_v_out[0]) = ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_y.data + __pyx_t_6 * __pyx_v_y.strides[0]) ))) + (__pyx_v_f * ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_y.data + __pyx_t_1 * __pyx_v_y.strides[0]) ))) - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_y.data + __pyx_t_8 * __pyx_v_y.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">156</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>: <span class="k">def</span> <span class="nf">interp2d</span><span class="p">(</span><span class="n">CFLOAT32</span> <span class="n">xp</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">yp</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">y</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Z</span><span class="p">):</span></pre>
<pre class='cython code score-83 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_5interp2d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_5interp2d = {"interp2d", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_5interp2d, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_5interp2d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __pyx_t_9functions_CFLOAT32 __pyx_v_xp;
  __pyx_t_9functions_CFLOAT32 __pyx_v_yp;
  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Z = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("interp2d (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xp,&amp;__pyx_n_s_yp,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_Z,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_yp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp2d", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp2d", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp2d", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp2d", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "interp2d") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_xp = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_xp == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
    __pyx_v_yp = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_yp == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
    __pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 161, __pyx_L3_error)</span>
    __pyx_v_y = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(0, 161, __pyx_L3_error)</span>
    __pyx_v_Z = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Z.memview)) __PYX_ERR(0, 161, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("interp2d", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.interp2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_4interp2d(__pyx_self, __pyx_v_xp, __pyx_v_yp, __pyx_v_x, __pyx_v_y, __pyx_v_Z);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_4interp2d(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_9functions_CFLOAT32 __pyx_v_xp, __pyx_t_9functions_CFLOAT32 __pyx_v_yp, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __Pyx_memviewslice __pyx_v_Z) {
  __pyx_t_9functions_CFLOAT32 __pyx_v_out;
  struct __pyx_t_9functions_ItpMatrix __pyx_v_imat;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("interp2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.interp2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Z, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_xp, __pyx_n_s_yp, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_Z, __pyx_n_s_out, __pyx_n_s_imat);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_5interp2d, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_interp2d, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_interp2d, 161, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">162</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">out</span></pre>
<pre class="cython line score-102" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:   <span class="k">cdef</span> <span class="kt">ItpMatrix</span> <span class="nf">imat</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;Z&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Z</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;dx&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s">&#39;dy&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span></pre>
<pre class='cython code score-102 '>  __pyx_t_2 = 0;
  __pyx_t_1.x = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_2 * __pyx_v_x.strides[0]) ))));
  __pyx_t_2 = 0;
  __pyx_t_1.y = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_y.data + __pyx_t_2 * __pyx_v_y.strides[0]) ))));
  __pyx_t_2 = 0;
  __pyx_t_1.Z = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Z.data + __pyx_t_2 * __pyx_v_Z.strides[0]) ))));
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CFLOAT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CFLOAT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_8 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_4 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3); if (unlikely((__pyx_t_9 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1.dx = ((__pyx_t_9functions_CFLOAT32)__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CFLOAT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CFLOAT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3); if (unlikely((__pyx_t_9 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1.dy = ((__pyx_t_9functions_CFLOAT32)__pyx_t_9);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:                          <span class="s">&#39;nx&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;ny&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)}</span></pre>
<pre class='cython code score-4 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_x); 
  __pyx_t_1.nx = ((__pyx_t_9functions_CINT32)__pyx_t_10);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_y); 
  __pyx_t_1.ny = ((__pyx_t_9functions_CINT32)__pyx_t_10);
  __pyx_v_imat = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:   <span class="n">_interp2d</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">imat</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (void)(__pyx_f_9functions__interp2d(__pyx_v_xp, __pyx_v_yp, (&amp;__pyx_v_imat), (&amp;__pyx_v_out)));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_out);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 167, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">168</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>: <span class="c"># error code: -1200</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">_interp2d</span><span class="p">(</span><span class="n">CFLOAT32</span> <span class="n">xp</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">yp</span><span class="p">,</span> <span class="n">ItpMatrix</span><span class="o">*</span> <span class="n">imat</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">out</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions__interp2d(__pyx_t_9functions_CFLOAT32 __pyx_v_xp, __pyx_t_9functions_CFLOAT32 __pyx_v_yp, struct __pyx_t_9functions_ItpMatrix *__pyx_v_imat, __pyx_t_9functions_CFLOAT32 *__pyx_v_out) {
  __pyx_t_9functions_CFLOAT32 __pyx_v_fx;
  __pyx_t_9functions_CFLOAT32 __pyx_v_fy;
  __pyx_t_9functions_CINT32 __pyx_v_kx0;
  __pyx_t_9functions_CINT32 __pyx_v_kx1;
  __pyx_t_9functions_CINT32 __pyx_v_ky0;
  __pyx_t_9functions_CINT32 __pyx_v_ky1;
  __pyx_t_9functions_CINT32 __pyx_v_ny;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_interp2d", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:   <span class="n">xp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">]),</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_imat[0]).x[0]);
  __pyx_t_2 = ((__pyx_v_imat[0]).x[((__pyx_v_imat[0]).nx - 1)]);
  __pyx_t_3 = __pyx_v_xp;
  if (((__pyx_t_2 &lt; __pyx_t_3) != 0)) {
    __pyx_t_4 = __pyx_t_2;
  } else {
    __pyx_t_4 = __pyx_t_3;
  }
  __pyx_t_2 = __pyx_t_4;
  if (((__pyx_t_1 &gt; __pyx_t_2) != 0)) {
    __pyx_t_4 = __pyx_t_1;
  } else {
    __pyx_t_4 = __pyx_t_2;
  }
  __pyx_v_xp = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:   <span class="n">yp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">yp</span><span class="p">,</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">]),</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_imat[0]).y[0]);
  __pyx_t_1 = ((__pyx_v_imat[0]).y[((__pyx_v_imat[0]).ny - 1)]);
  __pyx_t_2 = __pyx_v_yp;
  if (((__pyx_t_1 &lt; __pyx_t_2) != 0)) {
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_3 = __pyx_t_2;
  }
  __pyx_t_1 = __pyx_t_3;
  if (((__pyx_t_4 &gt; __pyx_t_1) != 0)) {
    __pyx_t_3 = __pyx_t_4;
  } else {
    __pyx_t_3 = __pyx_t_1;
  }
  __pyx_v_yp = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">fx</span><span class="p">,</span> <span class="nf">fy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">kx0</span><span class="p">,</span> <span class="nf">kx1</span><span class="p">,</span> <span class="nf">ky0</span><span class="p">,</span> <span class="nf">ky1</span><span class="p">,</span> <span class="nf">ny</span><span class="o">=</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_imat[0]).ny;
  __pyx_v_ny = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">180</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:   <span class="n">kx0</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">((</span><span class="n">xp</span><span class="o">-</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_kx0 = ((__pyx_t_9functions_CINT32)floor(((__pyx_v_xp - ((__pyx_v_imat[0]).x[0])) / (__pyx_v_imat[0]).dx)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">kx0</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">kx0</span><span class="o">&lt;</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span> <span class="n">kx1</span> <span class="o">=</span> <span class="n">kx0</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (((__pyx_v_kx0 &gt;= 0) &amp; (__pyx_v_kx0 &lt; ((__pyx_v_imat[0]).nx - 1))) != 0);
  if (__pyx_t_6) {
    __pyx_v_kx1 = (__pyx_v_kx0 + 1);
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:   <span class="k">elif</span> <span class="n">kx0</span><span class="o">==</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span>         <span class="n">kx1</span> <span class="o">=</span> <span class="n">kx0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((__pyx_v_kx0 == ((__pyx_v_imat[0]).nx - 1)) != 0);
  if (__pyx_t_6) {
    __pyx_v_kx1 = __pyx_v_kx0;
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:   <span class="k">else</span><span class="p">:</span>                           <span class="k">return</span> <span class="o">-</span><span class="mf">1201</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = -1201;
    goto __pyx_L0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">185</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:   <span class="n">ky0</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">((</span><span class="n">yp</span><span class="o">-</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ky0 = ((__pyx_t_9functions_CINT32)floor(((__pyx_v_yp - ((__pyx_v_imat[0]).y[0])) / (__pyx_v_imat[0]).dy)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">ky0</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">ky0</span><span class="o">&lt;</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span> <span class="n">ky1</span> <span class="o">=</span> <span class="n">ky0</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (((__pyx_v_ky0 &gt;= 0) &amp; (__pyx_v_ky0 &lt; ((__pyx_v_imat[0]).ny - 1))) != 0);
  if (__pyx_t_6) {
    __pyx_v_ky1 = (__pyx_v_ky0 + 1);
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:   <span class="k">elif</span> <span class="n">ky0</span><span class="o">==</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span>         <span class="n">ky1</span> <span class="o">=</span> <span class="n">ky0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((__pyx_v_ky0 == ((__pyx_v_imat[0]).ny - 1)) != 0);
  if (__pyx_t_6) {
    __pyx_v_ky1 = __pyx_v_ky0;
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:   <span class="k">else</span><span class="p">:</span>                           <span class="k">return</span> <span class="o">-</span><span class="mf">1202</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = -1202;
    goto __pyx_L0;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">190</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:   <span class="n">fx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">_1</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">_0</span><span class="p">,(</span><span class="n">xp</span><span class="o">-</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">kx0</span><span class="p">])</span><span class="o">/</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_xp - ((__pyx_v_imat[0]).x[__pyx_v_kx0])) / (__pyx_v_imat[0]).dx);
  __pyx_t_4 = __pyx_v_9functions__0;
  if (((__pyx_t_3 &gt; __pyx_t_4) != 0)) {
    __pyx_t_1 = __pyx_t_3;
  } else {
    __pyx_t_1 = __pyx_t_4;
  }
  __pyx_t_3 = __pyx_t_1;
  __pyx_t_1 = __pyx_v_9functions__1;
  if (((__pyx_t_3 &lt; __pyx_t_1) != 0)) {
    __pyx_t_4 = __pyx_t_3;
  } else {
    __pyx_t_4 = __pyx_t_1;
  }
  __pyx_v_fx = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:   <span class="n">fy</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">_1</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">_0</span><span class="p">,(</span><span class="n">yp</span><span class="o">-</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">ky0</span><span class="p">])</span><span class="o">/</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">dy</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_yp - ((__pyx_v_imat[0]).y[__pyx_v_ky0])) / (__pyx_v_imat[0]).dy);
  __pyx_t_3 = __pyx_v_9functions__0;
  if (((__pyx_t_4 &gt; __pyx_t_3) != 0)) {
    __pyx_t_1 = __pyx_t_4;
  } else {
    __pyx_t_1 = __pyx_t_3;
  }
  __pyx_t_4 = __pyx_t_1;
  __pyx_t_1 = __pyx_v_9functions__1;
  if (((__pyx_t_4 &lt; __pyx_t_1) != 0)) {
    __pyx_t_3 = __pyx_t_4;
  } else {
    __pyx_t_3 = __pyx_t_1;
  }
  __pyx_v_fy = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">193</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>:   <span class="n">out</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">_1</span><span class="o">-</span><span class="n">fy</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">_1</span><span class="o">-</span><span class="n">fx</span><span class="p">)</span><span class="o">*</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">kx0</span><span class="o">*</span><span class="n">ny</span><span class="o">+</span><span class="n">ky0</span><span class="p">]</span><span class="o">+</span><span class="n">fx</span><span class="o">*</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">kx1</span><span class="o">*</span><span class="n">ny</span><span class="o">+</span><span class="n">ky0</span><span class="p">])</span> <span class="o">+</span><span class="w">\</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_out[0]) = (((__pyx_v_9functions__1 - __pyx_v_fy) * (((__pyx_v_9functions__1 - __pyx_v_fx) * ((__pyx_v_imat[0]).Z[((__pyx_v_kx0 * __pyx_v_ny) + __pyx_v_ky0)])) + (__pyx_v_fx * ((__pyx_v_imat[0]).Z[((__pyx_v_kx1 * __pyx_v_ny) + __pyx_v_ky0)])))) + (__pyx_v_fy * (((__pyx_v_9functions__1 - __pyx_v_fx) * ((__pyx_v_imat[0]).Z[((__pyx_v_kx0 * __pyx_v_ny) + __pyx_v_ky1)])) + (__pyx_v_fx * ((__pyx_v_imat[0]).Z[((__pyx_v_kx1 * __pyx_v_ny) + __pyx_v_ky1)])))));
</pre><pre class="cython line score-0">&#xA0;<span class="">195</span>:            <span class="n">fy</span><span class="o">*</span><span class="p">((</span><span class="n">_1</span><span class="o">-</span><span class="n">fx</span><span class="p">)</span><span class="o">*</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">kx0</span><span class="o">*</span><span class="n">ny</span><span class="o">+</span><span class="n">ky1</span><span class="p">]</span><span class="o">+</span><span class="n">fx</span><span class="o">*</span><span class="n">imat</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">kx1</span><span class="o">*</span><span class="n">ny</span><span class="o">+</span><span class="n">ky1</span><span class="p">])</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>: <span class="c"># ----------------------------- DIGITIZE FUNCTIONS -----------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">204</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>: <span class="k">def</span> <span class="nf">digitize</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">bins</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">max_dE</span><span class="p">):</span></pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_7digitize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_7digitize = {"digitize", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_7digitize, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_7digitize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_Es = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bins = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("digitize (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Es,&amp;__pyx_n_s_ns,&amp;__pyx_n_s_bins,&amp;__pyx_n_s_max_dE,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("digitize", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bins)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("digitize", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_dE)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("digitize", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "digitize") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_Es = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es.memview)) __PYX_ERR(0, 206, __pyx_L3_error)</span>
    __pyx_v_ns = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns.memview)) __PYX_ERR(0, 206, __pyx_L3_error)</span>
    __pyx_v_bins = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bins.memview)) __PYX_ERR(0, 206, __pyx_L3_error)</span>
    __pyx_v_max_dE = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[3]); if (unlikely((__pyx_v_max_dE == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("digitize", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.digitize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_6digitize(__pyx_self, __pyx_v_Es, __pyx_v_ns, __pyx_v_bins, __pyx_v_max_dE);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_6digitize(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_Es, __Pyx_memviewslice __pyx_v_ns, __Pyx_memviewslice __pyx_v_bins, __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE) {
  PyObject *__pyx_v_cidx = NULL;
  __Pyx_memviewslice __pyx_v__cidx_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_N;
  PyObject *__pyx_v_codes = NULL;
  __Pyx_memviewslice __pyx_v__codes_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CFLOAT32 __pyx_v_ee;
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_k0;
  __pyx_t_9functions_CINT32 __pyx_v_k;
  __pyx_t_9functions_CUINT64 __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("digitize", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.digitize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cidx);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__cidx_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_codes);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__codes_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bins, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_Es, __pyx_n_s_ns, __pyx_n_s_bins, __pyx_n_s_max_dE, __pyx_n_s_cidx, __pyx_n_s_cidx_2, __pyx_n_s_N, __pyx_n_s_codes, __pyx_n_s_codes_2, __pyx_n_s_ee, __pyx_n_s_i, __pyx_n_s_k0, __pyx_n_s_k, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_7digitize, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_digitize, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_digitize, 206, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:   <span class="n">cidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_7, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_7, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_8, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cidx = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_cidx_</span> <span class="o">=</span> <span class="n">cidx</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_cidx, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  __pyx_v__cidx_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">209</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">N</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_ns); 
  __pyx_v_N = ((__pyx_t_9functions_CINT32)__pyx_t_10);
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es); 
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_ns, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">==</span> <span class="mf">65</span></pre>
<pre class='cython code score-7 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bins); 
    if (unlikely(!((__pyx_t_10 == 65) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">213</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:   <span class="n">codes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_codes = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span>[<span class="p">:]</span> <span class="n">_codes_</span> <span class="o">=</span> <span class="n">codes</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(__pyx_v_codes, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  __pyx_v__codes_ = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">ee</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">k0</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __pyx_v_N;
  __pyx_t_14 = __pyx_t_13;
  for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
    __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:     <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_j = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:     <span class="n">k0</span> <span class="o">=</span> <span class="n">_cidx_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    __pyx_v_k0 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx_.data + __pyx_t_16 * __pyx_v__cidx_.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns.data + __pyx_t_16 * __pyx_v_ns.strides[0]) )));
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
      __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:       <span class="n">ee</span> <span class="o">=</span> <span class="n">Es</span><span class="p">[</span><span class="n">k0</span><span class="o">+</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = (__pyx_v_k0 + __pyx_v_k);
      __pyx_v_ee = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es.data + __pyx_t_16 * __pyx_v_Es.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:       <span class="k">if</span> <span class="n">ee</span><span class="o">&lt;</span><span class="n">bins</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="n">max_dE</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = 0;
      __pyx_t_11 = ((__pyx_v_ee &lt; ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_bins.data + __pyx_t_16 * __pyx_v_bins.strides[0]) ))) - __pyx_v_max_dE)) != 0);
      if (__pyx_t_11) {
        goto __pyx_L5_continue;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:       <span class="k">if</span> <span class="n">ee</span><span class="o">&gt;</span><span class="n">bins</span><span class="p">[</span><span class="mf">64</span><span class="p">]</span><span class="o">+</span><span class="n">max_dE</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = 64;
      __pyx_t_11 = ((__pyx_v_ee &gt; ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_bins.data + __pyx_t_16 * __pyx_v_bins.strides[0]) ))) + __pyx_v_max_dE)) != 0);
      if (__pyx_t_11) {
        goto __pyx_L5_continue;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:       <span class="k">while</span> <span class="p">(</span><span class="n">ee</span><span class="o">&gt;=</span><span class="n">bins</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="mf">64</span><span class="p">):</span> <span class="n">j</span><span class="o">+=</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = ((__pyx_v_ee &gt;= (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_bins.data + __pyx_t_20 * __pyx_v_bins.strides[0]) )))) != 0);
        if (__pyx_t_21) {
        } else {
          __pyx_t_11 = __pyx_t_21;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_21 = ((__pyx_v_j &lt; 64) != 0);
        __pyx_t_11 = __pyx_t_21;
        __pyx_L11_bool_binop_done:;
        if (!__pyx_t_11) break;
        __pyx_v_j = (__pyx_v_j + 1);
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">229</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:       <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = ((__pyx_v_j == 0) != 0);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:         <span class="n">_codes_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_16 = __pyx_v_i;
        *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v__codes_.data + __pyx_t_16 * __pyx_v__codes_.strides[0]) )) |= 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L5_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:       <span class="n">_codes_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|=</span> <span class="p">(</span><span class="n">_1_64</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_i;
      *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v__codes_.data + __pyx_t_16 * __pyx_v__codes_.strides[0]) )) |= (__pyx_v_9functions__1_64 &lt;&lt; (__pyx_v_j - 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:       <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">&gt;</span><span class="mf">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ee</span><span class="o">-</span><span class="n">bins</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">):</span> <span class="n">_codes_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|=</span> <span class="n">_1_64</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = ((__pyx_v_j &gt; 1) != 0);
      if (__pyx_t_21) {
      } else {
        __pyx_t_11 = __pyx_t_21;
        goto __pyx_L15_bool_binop_done;
      }
      __pyx_t_20 = (__pyx_v_j - 1);
      __pyx_t_21 = (((__pyx_v_ee - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_bins.data + __pyx_t_20 * __pyx_v_bins.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
      __pyx_t_11 = __pyx_t_21;
      __pyx_L15_bool_binop_done:;
      if (__pyx_t_11) {
        __pyx_t_16 = __pyx_v_i;
        *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v__codes_.data + __pyx_t_16 * __pyx_v__codes_.strides[0]) )) |= (__pyx_v_9functions__1_64 &lt;&lt; (__pyx_v_j - 2));
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:       <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="mf">64</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">ee</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">):</span>  <span class="n">_codes_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|=</span> <span class="n">_1_64</span><span class="o">&lt;&lt;</span><span class="n">j</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = ((__pyx_v_j &lt; 64) != 0);
      if (__pyx_t_21) {
      } else {
        __pyx_t_11 = __pyx_t_21;
        goto __pyx_L18_bool_binop_done;
      }
      __pyx_t_20 = __pyx_v_j;
      __pyx_t_21 = ((((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_bins.data + __pyx_t_20 * __pyx_v_bins.strides[0]) ))) - __pyx_v_ee) &lt; __pyx_v_max_dE) != 0);
      __pyx_t_11 = __pyx_t_21;
      __pyx_L18_bool_binop_done:;
      if (__pyx_t_11) {
        __pyx_t_16 = __pyx_v_i;
        *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v__codes_.data + __pyx_t_16 * __pyx_v__codes_.strides[0]) )) |= (__pyx_v_9functions__1_64 &lt;&lt; __pyx_v_j);
      }
      __pyx_L5_continue:;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:   <span class="k">return</span> <span class="n">codes</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_codes);
  __pyx_r = __pyx_v_codes;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">239</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">241</span>: <span class="c"># ------------------------ SCORE/PROB SUPPORT FUNCTIONS ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">243</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">246</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">247</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>: <span class="c"># Error code -10100</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">CINT32</span> <span class="nf">_match_pair</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">cidx0</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">_n0</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">mtc0</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE __pyx_t_9functions_CINT32 __pyx_f_9functions__match_pair(__Pyx_memviewslice __pyx_v_Es0, __pyx_t_9functions_CINT32 __pyx_v_cidx0, __pyx_t_9functions_CUINT8 __pyx_v__n0, __Pyx_memviewslice __pyx_v_dEs0, __Pyx_memviewslice __pyx_v_mtc0, __Pyx_memviewslice __pyx_v_Es1, __pyx_t_9functions_CINT32 __pyx_v_cidx1, __pyx_t_9functions_CUINT8 __pyx_v__n1, __Pyx_memviewslice __pyx_v_dEs1, __Pyx_memviewslice __pyx_v_mtc1) {
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_j;
  __pyx_t_9functions_CINT32 __pyx_v_n0;
  __pyx_t_9functions_CINT32 __pyx_v_n1;
  __pyx_t_9functions_CFLOAT32 __pyx_v_curr;
  __pyx_t_9functions_CFLOAT32 __pyx_v_right;
  __pyx_t_9functions_CFLOAT32 __pyx_v_bottom;
  __pyx_t_9functions_CUINT8 __pyx_v_do0;
  __pyx_t_9functions_CUINT8 __pyx_v_do1;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_match_pair", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">250</span>:                                <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">cidx1</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">_n1</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">mtc1</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">j</span><span class="p">,</span><span class="nf">k</span><span class="p">,</span> <span class="nf">n0</span><span class="o">=</span><span class="n">_n0</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="n">_n1</span><span class="p">,</span> <span class="n">nadd</span><span class="p">,</span> <span class="n">bb</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n0 = __pyx_v__n0;
  __pyx_v_n1 = __pyx_v__n1;
</pre><pre class="cython line score-0">&#xA0;<span class="">253</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">curr</span><span class="p">,</span> <span class="nf">right</span><span class="p">,</span> <span class="nf">bottom</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:   <span class="k">cdef</span> <span class="kt">CUINT8</span> <span class="nf">do0</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">do1</span><span class="o">=</span><span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_do0 = 1;
  __pyx_v_do1 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">255</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n0</span><span class="p">):</span> <span class="n">mtc0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n0;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    __pyx_t_4 = __pyx_v_i;
    *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_4 * __pyx_v_mtc0.strides[0]) )) = -1;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span> <span class="n">mtc1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n1;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    __pyx_t_4 = __pyx_v_i;
    *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_4 * __pyx_v_mtc1.strides[0]) )) = -1;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:   <span class="n">i</span><span class="o">=</span><span class="n">j</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
  __pyx_v_j = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:   <span class="k">while</span> <span class="bp">True</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:     <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">n0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">n1</span><span class="p">):</span> <span class="k">break</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = ((__pyx_v_i &gt;= __pyx_v_n0) != 0);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_j &gt;= __pyx_v_n1) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_5) {
      goto __pyx_L8_break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:     <span class="n">curr</span> <span class="o">=</span> <span class="n">Es1</span><span class="p">[</span><span class="n">cidx1</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Es0</span><span class="p">[</span><span class="n">cidx0</span><span class="o">+</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (__pyx_v_cidx1 + __pyx_v_j);
    __pyx_t_7 = (__pyx_v_cidx0 + __pyx_v_i);
    __pyx_v_curr = ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_4 * __pyx_v_Es1.strides[0]) ))) - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_7 * __pyx_v_Es0.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">263</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>:     <span class="c"># Check scores of adjacent matches</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:     <span class="k">if</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">n1</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span> <span class="n">right</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Es1</span><span class="p">[</span><span class="n">cidx1</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">Es0</span><span class="p">[</span><span class="n">cidx0</span><span class="o">+</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = ((__pyx_v_j &lt; (__pyx_v_n1 - 1)) != 0);
    if (__pyx_t_5) {
      __pyx_t_7 = ((__pyx_v_cidx1 + __pyx_v_j) + 1);
      __pyx_t_4 = (__pyx_v_cidx0 + __pyx_v_i);
      __pyx_v_right = fabsf(((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_7 * __pyx_v_Es1.strides[0]) ))) - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_4 * __pyx_v_Es0.strides[0]) )))));
      goto __pyx_L12;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:     <span class="k">else</span><span class="p">:</span>      <span class="n">right</span> <span class="o">=</span> <span class="n">_INF</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_right = __pyx_v_9functions__INF;
    }
    __pyx_L12:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:     <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n0</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span> <span class="n">bottom</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Es1</span><span class="p">[</span><span class="n">cidx1</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Es0</span><span class="p">[</span><span class="n">cidx0</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = ((__pyx_v_i &lt; (__pyx_v_n0 - 1)) != 0);
    if (__pyx_t_5) {
      __pyx_t_4 = (__pyx_v_cidx1 + __pyx_v_j);
      __pyx_t_7 = ((__pyx_v_cidx0 + __pyx_v_i) + 1);
      __pyx_v_bottom = fabsf(((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_4 * __pyx_v_Es1.strides[0]) ))) - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_7 * __pyx_v_Es0.strides[0]) )))));
      goto __pyx_L13;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:     <span class="k">else</span><span class="p">:</span>      <span class="n">bottom</span> <span class="o">=</span> <span class="n">_INF</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_bottom = __pyx_v_9functions__INF;
    }
    __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">269</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:     <span class="k">if</span> <span class="n">do0</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">right</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = (__pyx_v_do0 != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L15_bool_binop_done;
    }
    __pyx_t_6 = ((fabsf(__pyx_v_curr) &lt;= __pyx_v_right) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L15_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:       <span class="n">dEs0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_i;
      *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs0.data + __pyx_t_7 * __pyx_v_dEs0.strides[0]) )) = __pyx_v_curr;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:       <span class="n">mtc0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_i;
      *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_7 * __pyx_v_mtc0.strides[0]) )) = __pyx_v_j;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:       <span class="n">do0</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>      __pyx_v_do0 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:     <span class="k">if</span> <span class="n">do1</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">bottom</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = (__pyx_v_do1 != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L18_bool_binop_done;
    }
    __pyx_t_6 = ((fabsf(__pyx_v_curr) &lt;= __pyx_v_bottom) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L18_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:       <span class="n">dEs1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_j;
      *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs1.data + __pyx_t_7 * __pyx_v_dEs1.strides[0]) )) = __pyx_v_curr;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:       <span class="n">mtc1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_j;
      *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_7 * __pyx_v_mtc1.strides[0]) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:       <span class="n">do1</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>      __pyx_v_do1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">278</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:     <span class="k">if</span> <span class="p">(</span><span class="n">bottom</span><span class="o">&lt;</span><span class="n">_INF</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bottom</span><span class="o">&lt;</span><span class="n">right</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = ((__pyx_v_bottom &lt; __pyx_v_9functions__INF) != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_bottom &lt; __pyx_v_right) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:       <span class="n">i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:       <span class="n">do0</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_v_do0 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:       <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L7_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:     <span class="k">elif</span> <span class="p">(</span><span class="n">right</span><span class="o">&lt;</span><span class="n">_INF</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">right</span><span class="o">&lt;</span><span class="n">bottom</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = ((__pyx_v_right &lt; __pyx_v_9functions__INF) != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L23_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_right &lt; __pyx_v_bottom) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L23_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:       <span class="n">j</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = (__pyx_v_j + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:       <span class="n">do1</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_v_do1 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:       <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L7_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:     <span class="k">elif</span> <span class="p">(</span><span class="n">bottom</span><span class="o">&lt;</span><span class="n">_INF</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bottom</span><span class="o">==</span><span class="n">right</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = ((__pyx_v_bottom &lt; __pyx_v_9functions__INF) != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L25_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_bottom == __pyx_v_right) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L25_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:       <span class="k">if</span> <span class="n">bottom</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Es1</span><span class="p">[</span><span class="n">cidx1</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">Es0</span><span class="p">[</span><span class="n">cidx0</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]):</span> <span class="k">return</span> <span class="o">-</span><span class="mf">10101</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = ((__pyx_v_cidx1 + __pyx_v_j) + 1);
      __pyx_t_4 = ((__pyx_v_cidx0 + __pyx_v_i) + 1);
      __pyx_t_5 = ((__pyx_v_bottom &lt; fabsf(((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_7 * __pyx_v_Es1.strides[0]) ))) - (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_4 * __pyx_v_Es0.strides[0]) )))))) != 0);
      if (__pyx_t_5) {
        __pyx_r = -10101;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">289</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:     <span class="n">i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i = (__pyx_v_i + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:     <span class="n">j</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_j = (__pyx_v_j + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:     <span class="n">do0</span><span class="o">=</span><span class="n">do1</span><span class="o">=</span><span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_v_do0 = 1;
    __pyx_v_do1 = 1;
    __pyx_L7_continue:;
  }
  __pyx_L8_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">293</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n0;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:     <span class="k">if</span> <span class="p">(</span><span class="n">mtc0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">n1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mtc0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">):</span> <span class="k">return</span> <span class="o">-</span><span class="mf">10102</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_6 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_4 * __pyx_v_mtc0.strides[0]) ))) &gt;= __pyx_v_n1) != 0);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L31_bool_binop_done;
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_6 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_4 * __pyx_v_mtc0.strides[0]) ))) &lt; 0) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L31_bool_binop_done:;
    if (__pyx_t_5) {
      __pyx_r = -10102;
      goto __pyx_L0;
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n1;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:     <span class="k">if</span> <span class="p">(</span><span class="n">mtc1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">n0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mtc1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">):</span> <span class="k">return</span> <span class="o">-</span><span class="mf">10103</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_6 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_4 * __pyx_v_mtc1.strides[0]) ))) &gt;= __pyx_v_n0) != 0);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L36_bool_binop_done;
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_6 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_4 * __pyx_v_mtc1.strides[0]) ))) &lt; 0) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L36_bool_binop_done:;
    if (__pyx_t_5) {
      __pyx_r = -10103;
      goto __pyx_L0;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">298</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">300</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">_match_pair_score</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">cidx0</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">_n0</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">mtc0</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions__match_pair_score(__Pyx_memviewslice __pyx_v_Es0, __pyx_t_9functions_CINT32 __pyx_v_cidx0, __pyx_t_9functions_CUINT8 __pyx_v__n0, __Pyx_memviewslice __pyx_v_dEs0, __Pyx_memviewslice __pyx_v_mtc0, __Pyx_memviewslice __pyx_v_Es1, __pyx_t_9functions_CINT32 __pyx_v_cidx1, __pyx_t_9functions_CUINT8 __pyx_v__n1, __Pyx_memviewslice __pyx_v_dEs1, __Pyx_memviewslice __pyx_v_mtc1, __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE, __pyx_t_9functions_CFLOAT32 *__pyx_v_ana, __pyx_t_9functions_CINT32 *__pyx_v_cnt, __pyx_t_9functions_CINT32 *__pyx_v_npairs, __pyx_t_9functions_CINT32 *__pyx_v_nx0, __pyx_t_9functions_CINT32 *__pyx_v_nx1) {
  __pyx_t_9functions_CINT32 __pyx_v_k;
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CUINT8 *__pyx_v_done;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_match_pair_score", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">306</span>:                               <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">cidx1</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">_n1</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">mtc1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>:                               <span class="n">CFLOAT32</span> <span class="n">max_dE</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">ana</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">npairs</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">nx0</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">nx1</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">ret</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:   <span class="n">ret</span> <span class="o">=</span> <span class="n">_match_pair</span><span class="p">(</span><span class="n">Es0</span><span class="p">,</span> <span class="n">cidx0</span><span class="p">,</span> <span class="n">_n0</span><span class="p">,</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">mtc0</span><span class="p">,</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">cidx1</span><span class="p">,</span> <span class="n">_n1</span><span class="p">,</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">mtc1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ret = __pyx_f_9functions__match_pair(__pyx_v_Es0, __pyx_v_cidx0, __pyx_v__n0, __pyx_v_dEs0, __pyx_v_mtc0, __pyx_v_Es1, __pyx_v_cidx1, __pyx_v__n1, __pyx_v_dEs1, __pyx_v_mtc1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:   <span class="k">if</span> <span class="n">ret</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ret &lt; 0) != 0);
  if (__pyx_t_1) {
    __pyx_r = __pyx_v_ret;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">313</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:   <span class="k">cdef</span> <span class="kt">CUINT8</span> *<span class="nf">done</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CUINT8</span><span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n1</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">CUINT8</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_done = ((__pyx_t_9functions_CUINT8 *)malloc((((__pyx_t_9functions_CINT32)__pyx_v__n1) * (sizeof(__pyx_t_9functions_CUINT8)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n1</span><span class="p">):</span> <span class="n">done</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_t_9functions_CINT32)__pyx_v__n1);
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_k = __pyx_t_4;
    (__pyx_v_done[__pyx_v_k]) = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">316</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:   <span class="n">ana</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_0</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_ana[0]) = __pyx_v_9functions__0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:   <span class="n">nx0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_nx0[0]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:   <span class="n">nx1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_nx1[0]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:   <span class="n">npairs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_npairs[0]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:   <span class="n">cnt</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_cnt[0]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>:   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_t_9functions_CINT32)__pyx_v__n0);
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_k = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>:     <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dEs0</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_k;
    __pyx_t_1 = ((fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs0.data + __pyx_t_5 * __pyx_v_dEs0.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:       <span class="n">ana</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">_1</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">dEs0</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">max_dE</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = 0;
      __pyx_t_5 = __pyx_v_k;
      (__pyx_v_ana[__pyx_t_6]) = ((__pyx_v_ana[__pyx_t_6]) + (__pyx_v_9functions__1 - (((__pyx_t_9functions_CFLOAT32)fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs0.data + __pyx_t_5 * __pyx_v_dEs0.strides[0]) ))))) / __pyx_v_max_dE)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:       <span class="k">if</span> <span class="n">mtc1</span><span class="p">[</span><span class="n">mtc0</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">==</span><span class="n">k</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_k;
      __pyx_t_7 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_5 * __pyx_v_mtc0.strides[0]) )));
      __pyx_t_1 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_7 * __pyx_v_mtc1.strides[0]) ))) == __pyx_v_k) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:         <span class="n">done</span><span class="p">[</span><span class="n">mtc0</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CUINT8</span><span class="p">&gt;</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_5 = __pyx_v_k;
        (__pyx_v_done[(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_5 * __pyx_v_mtc0.strides[0]) )))]) = ((__pyx_t_9functions_CUINT8)1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:         <span class="n">npairs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_6 = 0;
        (__pyx_v_npairs[__pyx_t_6]) = ((__pyx_v_npairs[__pyx_t_6]) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:       <span class="n">cnt</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = 0;
      (__pyx_v_cnt[__pyx_t_6]) = ((__pyx_v_cnt[__pyx_t_6]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">329</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:       <span class="n">nx0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_6 = 0;
      (__pyx_v_nx0[__pyx_t_6]) = ((__pyx_v_nx0[__pyx_t_6]) + 1);
    }
    __pyx_L8:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">331</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_t_9functions_CINT32)__pyx_v__n1);
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_k = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:     <span class="k">if</span> <span class="n">done</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_done[__pyx_v_k]) != 0);
    if (__pyx_t_1) {
      goto __pyx_L10_continue;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:     <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dEs1</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_k;
    __pyx_t_1 = ((fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs1.data + __pyx_t_5 * __pyx_v_dEs1.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L13;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>:       <span class="n">ana</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">_1</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">dEs1</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">max_dE</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = 0;
      __pyx_t_5 = __pyx_v_k;
      (__pyx_v_ana[__pyx_t_6]) = ((__pyx_v_ana[__pyx_t_6]) + (__pyx_v_9functions__1 - (((__pyx_t_9functions_CFLOAT32)fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs1.data + __pyx_t_5 * __pyx_v_dEs1.strides[0]) ))))) / __pyx_v_max_dE)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>:       <span class="n">cnt</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = 0;
      (__pyx_v_cnt[__pyx_t_6]) = ((__pyx_v_cnt[__pyx_t_6]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:       <span class="n">nx1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_6 = 0;
      (__pyx_v_nx1[__pyx_t_6]) = ((__pyx_v_nx1[__pyx_t_6]) + 1);
    }
    __pyx_L13:;
    __pyx_L10_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:   <span class="k">if</span> <span class="n">cnt</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0</span><span class="p">:</span> <span class="n">ana</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">/=</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">cnt</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_cnt[0]) &gt; 0) != 0);
  if (__pyx_t_1) {
    __pyx_t_6 = 0;
    (__pyx_v_ana[__pyx_t_6]) = ((__pyx_v_ana[__pyx_t_6]) / ((__pyx_t_9functions_CFLOAT32)(__pyx_v_cnt[0])));
    goto __pyx_L14;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:   <span class="k">else</span><span class="p">:</span>        <span class="n">ana</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_0</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    (__pyx_v_ana[0]) = __pyx_v_9functions__0;
  }
  __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>:   <span class="n">free</span><span class="p">(</span><span class="n">done</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_done);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">345</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>: <span class="c"># @cython.cdivision(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>: <span class="c"># @cython.boundscheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>: <span class="c"># @cython.wraparound(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>: <span class="c"># error code -22000</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">_match_pair_prob</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">cidx0</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">_n0</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">mtc0</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions__match_pair_prob(__Pyx_memviewslice __pyx_v_Es0, __pyx_t_9functions_CINT32 __pyx_v_cidx0, __pyx_t_9functions_CUINT8 __pyx_v__n0, __Pyx_memviewslice __pyx_v_dEs0, __Pyx_memviewslice __pyx_v_mtc0, __Pyx_memviewslice __pyx_v_Es1, __pyx_t_9functions_CINT32 __pyx_v_cidx1, __pyx_t_9functions_CUINT8 __pyx_v__n1, __Pyx_memviewslice __pyx_v_dEs1, __Pyx_memviewslice __pyx_v_mtc1, struct __pyx_t_9functions_LprobStrct *__pyx_v_lprob, struct __pyx_t_9functions_PinfoStrct *__pyx_v_pinfo, __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE) {
  __pyx_t_9functions_CINT32 __pyx_v_k;
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CINT32 __pyx_v_n0;
  __pyx_t_9functions_CINT32 __pyx_v_n1;
  __pyx_t_9functions_CUINT8 *__pyx_v_done;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_match_pair_prob", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("functions._match_pair_prob", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">352</span>:                              <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">cidx1</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">_n1</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">mtc1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>:                              <span class="n">LprobStrct</span><span class="o">*</span> <span class="n">lprob</span><span class="p">,</span> <span class="n">PinfoStrct</span><span class="o">*</span> <span class="n">pinfo</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">max_dE</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">ret</span><span class="p">,</span> <span class="nf">n0</span><span class="o">=</span><span class="n">_n0</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="n">_n1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n0 = __pyx_v__n0;
  __pyx_v_n1 = __pyx_v__n1;
</pre><pre class="cython line score-0">&#xA0;<span class="">356</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:   <span class="n">ret</span> <span class="o">=</span> <span class="n">_match_pair</span><span class="p">(</span><span class="n">Es0</span><span class="p">,</span> <span class="n">cidx0</span><span class="p">,</span> <span class="n">_n0</span><span class="p">,</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">mtc0</span><span class="p">,</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">cidx1</span><span class="p">,</span> <span class="n">_n1</span><span class="p">,</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">mtc1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ret = __pyx_f_9functions__match_pair(__pyx_v_Es0, __pyx_v_cidx0, __pyx_v__n0, __pyx_v_dEs0, __pyx_v_mtc0, __pyx_v_Es1, __pyx_v_cidx1, __pyx_v__n1, __pyx_v_dEs1, __pyx_v_mtc1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:   <span class="k">if</span> <span class="n">ret</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ret &lt; 0) != 0);
  if (__pyx_t_1) {
    __pyx_r = __pyx_v_ret;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">359</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:   <span class="k">cdef</span> <span class="kt">CUINT8</span> *<span class="nf">done</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CUINT8</span><span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">CUINT8</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_done = ((__pyx_t_9functions_CUINT8 *)malloc((__pyx_v_n1 * (sizeof(__pyx_t_9functions_CUINT8)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span> <span class="n">done</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n1;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_k = __pyx_t_4;
    (__pyx_v_done[__pyx_v_k]) = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">362</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:   <span class="n">lprob</span><span class="o">.</span><span class="n">nx0</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_lprob-&gt;nx0 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:   <span class="n">lprob</span><span class="o">.</span><span class="n">nx1</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_lprob-&gt;nx1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:   <span class="n">lprob</span><span class="o">.</span><span class="n">npairs</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_lprob-&gt;npairs = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:   <span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_lprob-&gt;cnt = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n0;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_k = __pyx_t_4;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:     <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dEs0</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_5 = __pyx_v_k;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_dEs0.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dEs0.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
    }
    __pyx_t_1 = ((fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs0.data + __pyx_t_5 * __pyx_v_dEs0.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:       <span class="n">ret</span> <span class="o">=</span> <span class="n">_interp_ede</span><span class="p">((</span><span class="n">Es0</span><span class="p">[</span><span class="n">cidx0</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">Es1</span><span class="p">[</span><span class="n">cidx1</span><span class="o">+</span><span class="n">mtc0</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span><span class="o">/</span><span class="n">_2</span><span class="p">,</span> <span class="n">dEs0</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">pinfo</span><span class="p">,</span> <span class="n">lprob</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>      __pyx_t_5 = (__pyx_v_cidx0 + __pyx_v_k);
      __pyx_t_6 = -1;
      if (__pyx_t_5 &lt; 0) {
        __pyx_t_5 += __pyx_v_Es0.shape[0];
        if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_Es0.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
      }
      __pyx_t_7 = __pyx_v_k;
      __pyx_t_6 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_mtc0.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_mtc0.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
      }
      __pyx_t_8 = (__pyx_v_cidx1 + (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_7 * __pyx_v_mtc0.strides[0]) ))));
      __pyx_t_6 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_Es1.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_Es1.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
      }
      __pyx_t_9 = ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_5 * __pyx_v_Es0.strides[0]) ))) + (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_8 * __pyx_v_Es1.strides[0]) ))));
      if (unlikely(__pyx_v_9functions__2 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
      }
      __pyx_t_7 = __pyx_v_k;
      __pyx_t_6 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_dEs0.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dEs0.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
      }
      __pyx_v_ret = __pyx_f_9functions__interp_ede((__pyx_t_9 / __pyx_v_9functions__2), (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs0.data + __pyx_t_7 * __pyx_v_dEs0.strides[0]) ))), __pyx_v_pinfo, __pyx_v_lprob);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:       <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_ret &lt; 0) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:         <span class="n">free</span><span class="p">(</span><span class="n">done</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        free(__pyx_v_done);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:         <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>        __pyx_r = __pyx_v_ret;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">373</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">374</span>:       <span class="k">if</span> <span class="n">mtc1</span><span class="p">[</span><span class="n">mtc0</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">==</span><span class="n">k</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>      __pyx_t_7 = __pyx_v_k;
      __pyx_t_6 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_mtc0.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_mtc0.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>
      }
      __pyx_t_8 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_7 * __pyx_v_mtc0.strides[0]) )));
      __pyx_t_6 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_mtc1.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_mtc1.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>
      }
      __pyx_t_1 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_8 * __pyx_v_mtc1.strides[0]) ))) == __pyx_v_k) != 0);
      if (__pyx_t_1) {
/* … */
        goto __pyx_L10;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">375</span>:         <span class="n">done</span><span class="p">[</span><span class="n">mtc0</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CUINT8</span><span class="p">&gt;</span><span class="mf">1</span></pre>
<pre class='cython code score-2 '>        __pyx_t_7 = __pyx_v_k;
        __pyx_t_6 = -1;
        if (__pyx_t_7 &lt; 0) {
          __pyx_t_7 += __pyx_v_mtc0.shape[0];
          if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_mtc0.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 375, __pyx_L1_error)</span>
        }
        (__pyx_v_done[(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc0.data + __pyx_t_7 * __pyx_v_mtc0.strides[0]) )))]) = ((__pyx_t_9functions_CUINT8)1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>:         <span class="n">lprob</span><span class="o">.</span><span class="n">npairs</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_v_lprob-&gt;npairs = (__pyx_v_lprob-&gt;npairs + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:         <span class="n">lprob</span><span class="o">.</span><span class="n">lnx0</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        (__pyx_v_lprob-&gt;lnx0[(__pyx_v_lprob-&gt;cnt - 1)]) = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">378</span>:         <span class="n">lprob</span><span class="o">.</span><span class="n">lnx1</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        (__pyx_v_lprob-&gt;lnx1[(__pyx_v_lprob-&gt;cnt - 1)]) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">379</span>:       <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:         <span class="n">lprob</span><span class="o">.</span><span class="n">lnx0</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        (__pyx_v_lprob-&gt;lnx0[(__pyx_v_lprob-&gt;cnt - 1)]) = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:         <span class="n">lprob</span><span class="o">.</span><span class="n">lnx1</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>        (__pyx_v_lprob-&gt;lnx1[(__pyx_v_lprob-&gt;cnt - 1)]) = 0;
      }
      __pyx_L10:;
</pre><pre class="cython line score-0">&#xA0;<span class="">382</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">nx0</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_lprob-&gt;nx0 = (__pyx_v_lprob-&gt;nx0 + 1);
    }
    __pyx_L8:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">384</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">385</span>:   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n1;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_k = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:     <span class="k">if</span> <span class="n">done</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_done[__pyx_v_k]) != 0);
    if (__pyx_t_1) {
      goto __pyx_L11_continue;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">387</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>:     <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dEs1</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = __pyx_v_k;
    __pyx_t_6 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_dEs1.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dEs1.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
    }
    __pyx_t_1 = ((fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs1.data + __pyx_t_7 * __pyx_v_dEs1.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L14;
    }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>:       <span class="n">ret</span> <span class="o">=</span> <span class="n">_interp_ede</span><span class="p">((</span><span class="n">Es0</span><span class="p">[</span><span class="n">cidx0</span><span class="o">+</span><span class="n">mtc1</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">+</span><span class="n">Es1</span><span class="p">[</span><span class="n">cidx1</span><span class="o">+</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">_2</span><span class="p">,</span> <span class="n">dEs1</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">pinfo</span><span class="p">,</span> <span class="n">lprob</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>      __pyx_t_7 = __pyx_v_k;
      __pyx_t_6 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_mtc1.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_mtc1.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 389, __pyx_L1_error)</span>
      }
      __pyx_t_8 = (__pyx_v_cidx0 + (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_mtc1.data + __pyx_t_7 * __pyx_v_mtc1.strides[0]) ))));
      __pyx_t_6 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_Es0.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_Es0.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 389, __pyx_L1_error)</span>
      }
      __pyx_t_5 = (__pyx_v_cidx1 + __pyx_v_k);
      __pyx_t_6 = -1;
      if (__pyx_t_5 &lt; 0) {
        __pyx_t_5 += __pyx_v_Es1.shape[0];
        if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_Es1.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 389, __pyx_L1_error)</span>
      }
      __pyx_t_9 = ((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_8 * __pyx_v_Es0.strides[0]) ))) + (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_5 * __pyx_v_Es1.strides[0]) ))));
      if (unlikely(__pyx_v_9functions__2 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 389, __pyx_L1_error)</span>
      }
      __pyx_t_5 = __pyx_v_k;
      __pyx_t_6 = -1;
      if (__pyx_t_5 &lt; 0) {
        __pyx_t_5 += __pyx_v_dEs1.shape[0];
        if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dEs1.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 389, __pyx_L1_error)</span>
      }
      __pyx_v_ret = __pyx_f_9functions__interp_ede((__pyx_t_9 / __pyx_v_9functions__2), (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_dEs1.data + __pyx_t_5 * __pyx_v_dEs1.strides[0]) ))), __pyx_v_pinfo, __pyx_v_lprob);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:       <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_ret &lt; 0) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:         <span class="n">free</span><span class="p">(</span><span class="n">done</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        free(__pyx_v_done);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:         <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>        __pyx_r = __pyx_v_ret;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">393</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">lnx0</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_lprob-&gt;lnx0[(__pyx_v_lprob-&gt;cnt - 1)]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">lnx1</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_lprob-&gt;lnx1[(__pyx_v_lprob-&gt;cnt - 1)]) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">396</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">nx1</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_lprob-&gt;nx1 = (__pyx_v_lprob-&gt;nx1 + 1);
    }
    __pyx_L14:;
    __pyx_L11_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">398</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:   <span class="k">if</span> <span class="n">_n0</span><span class="o">==</span><span class="n">_n1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v__n0 == __pyx_v__n1) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L16;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lprob-&gt;mL = ((__pyx_t_9functions_CINT32)__pyx_v__n0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">mH</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_lprob-&gt;mL;
    __pyx_v_lprob-&gt;mH = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lprob</span><span class="o">.</span><span class="n">nx0</span><span class="p">,</span><span class="n">lprob</span><span class="o">.</span><span class="n">nx1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_lprob-&gt;nx1;
    __pyx_t_3 = __pyx_v_lprob-&gt;nx0;
    if (((__pyx_t_2 &lt; __pyx_t_3) != 0)) {
      __pyx_t_4 = __pyx_t_2;
    } else {
      __pyx_t_4 = __pyx_t_3;
    }
    __pyx_v_lprob-&gt;nx = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">403</span>:   <span class="k">elif</span> <span class="n">_n0</span><span class="o">&gt;</span><span class="n">_n1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v__n0 &gt; __pyx_v__n1) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L16;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lprob-&gt;mL = ((__pyx_t_9functions_CINT32)__pyx_v__n1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">mH</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lprob-&gt;mH = ((__pyx_t_9functions_CINT32)__pyx_v__n0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">nx1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_lprob-&gt;nx1;
    __pyx_v_lprob-&gt;nx = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">407</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n0</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_lprob-&gt;mL = ((__pyx_t_9functions_CINT32)__pyx_v__n0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">409</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">mH</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">_n1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lprob-&gt;mH = ((__pyx_t_9functions_CINT32)__pyx_v__n1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">nx0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_lprob-&gt;nx0;
    __pyx_v_lprob-&gt;nx = __pyx_t_4;
  }
  __pyx_L16:;
</pre><pre class="cython line score-0">&#xA0;<span class="">411</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">412</span>:   <span class="n">free</span><span class="p">(</span><span class="n">done</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_done);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">414</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>: <span class="c"># @cython.cdivision(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>: <span class="c"># @cython.boundscheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>: <span class="c"># @cython.wraparound(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">419</span>: <span class="c"># error code -23000</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">CINT32</span> <span class="nf">_interp_ede</span><span class="p">(</span><span class="n">CFLOAT32</span> <span class="n">ee</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">dEs</span><span class="p">,</span> <span class="n">PinfoStrct</span><span class="o">*</span> <span class="n">pinfo</span><span class="p">,</span> <span class="n">LprobStrct</span><span class="o">*</span> <span class="n">lprob</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE __pyx_t_9functions_CINT32 __pyx_f_9functions__interp_ede(__pyx_t_9functions_CFLOAT32 __pyx_v_ee, __pyx_t_9functions_CFLOAT32 __pyx_v_dEs, struct __pyx_t_9functions_PinfoStrct *__pyx_v_pinfo, struct __pyx_t_9functions_LprobStrct *__pyx_v_lprob) {
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CFLOAT32 __pyx_v_val;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_interp_ede", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("functions._interp_ede", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>:   <span class="k">if</span> <span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="o">&gt;=</span><span class="n">lprob</span><span class="o">.</span><span class="n">lmax</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">23000</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_lprob-&gt;cnt &gt;= __pyx_v_lprob-&gt;lmax) != 0);
  if (__pyx_t_1) {
    __pyx_r = -23000;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">423</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">ret</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">424</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">val</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">426</span>:   <span class="n">ret</span> <span class="o">=</span> <span class="n">_interp2d</span><span class="p">(</span><span class="n">ee</span><span class="p">,</span> <span class="n">dEs</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">pinfo</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">Mno</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ret = __pyx_f_9functions__interp2d(__pyx_v_ee, __pyx_v_dEs, (&amp;(__pyx_v_pinfo[0]).Mno), (&amp;__pyx_v_val));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>:   <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span>  <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ret &lt; 0) != 0);
  if (__pyx_t_1) {
    __pyx_r = __pyx_v_ret;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>:   <span class="k">if</span> <span class="n">val</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">23001</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_val &lt; 0.) != 0);
  if (__pyx_t_1) {
    __pyx_r = -23001;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">429</span>:   <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CFLOAT64</span><span class="p">&gt;</span><span class="n">val</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_lprob-&gt;plr[__pyx_v_lprob-&gt;cnt]) = ((__pyx_t_9functions_CFLOAT64)__pyx_v_val);
</pre><pre class="cython line score-0">&#xA0;<span class="">430</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">431</span>:   <span class="n">ret</span> <span class="o">=</span> <span class="n">_interp2d</span><span class="p">(</span><span class="n">ee</span><span class="p">,</span> <span class="n">dEs</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">pinfo</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">Mok</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ret = __pyx_f_9functions__interp2d(__pyx_v_ee, __pyx_v_dEs, (&amp;(__pyx_v_pinfo[0]).Mok), (&amp;__pyx_v_val));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">432</span>:   <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span>  <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ret &lt; 0) != 0);
  if (__pyx_t_1) {
    __pyx_r = __pyx_v_ret;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">433</span>:   <span class="k">if</span> <span class="n">val</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">23002</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_val &lt; 0.) != 0);
  if (__pyx_t_1) {
    __pyx_r = -23002;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">434</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">435</span>:   <span class="k">if</span> <span class="n">val</span><span class="o">==</span><span class="n">_0</span><span class="p">:</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">_INF_64</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_val == __pyx_v_9functions__0) != 0);
  if (__pyx_t_1) {
    (__pyx_v_lprob-&gt;plr[__pyx_v_lprob-&gt;cnt]) = __pyx_v_9functions__INF_64;
    goto __pyx_L8;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">436</span>:   <span class="k">else</span><span class="p">:</span>       <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="p">]</span> <span class="o">/=</span> <span class="p">&lt;</span><span class="kt">CFLOAT64</span><span class="p">&gt;</span><span class="n">val</span></pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_2 = __pyx_v_lprob-&gt;cnt;
    if (unlikely(((__pyx_t_9functions_CFLOAT64)__pyx_v_val) == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>
    }
    (__pyx_v_lprob-&gt;plr[__pyx_t_2]) = ((__pyx_v_lprob-&gt;plr[__pyx_t_2]) / ((__pyx_t_9functions_CFLOAT64)__pyx_v_val));
  }
  __pyx_L8:;
</pre><pre class="cython line score-0">&#xA0;<span class="">437</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">438</span>:   <span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_lprob-&gt;cnt = (__pyx_v_lprob-&gt;cnt + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">439</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">440</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">441</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>: <span class="c"># @cython.cdivision(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">444</span>: <span class="c"># @cython.boundscheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">445</span>: <span class="c"># @cython.wraparound(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>: <span class="c"># error code -24000</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">447</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">_calc_prob</span><span class="p">(</span><span class="n">LprobStrct</span><span class="o">*</span> <span class="n">lprob</span><span class="p">,</span> <span class="n">PinfoStrct</span><span class="o">*</span> <span class="n">pinfo</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">nr_max</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="o">*</span> <span class="n">pret</span><span class="p">,</span> <span class="n">CINT32</span><span class="o">*</span> <span class="n">nxret</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions__calc_prob(struct __pyx_t_9functions_LprobStrct *__pyx_v_lprob, struct __pyx_t_9functions_PinfoStrct *__pyx_v_pinfo, __pyx_t_9functions_CINT32 __pyx_v_nr_max, __pyx_t_9functions_CFLOAT32 *__pyx_v_pret, __pyx_t_9functions_CINT32 *__pyx_v_nxret) {
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CINT32 __pyx_v_nx;
  __pyx_t_9functions_CINT32 __pyx_v_nx_best;
  __pyx_t_9functions_CINT32 __pyx_v_iok0;
  __pyx_t_9functions_CFLOAT64 __pyx_v_pprod;
  __pyx_t_9functions_CFLOAT64 __pyx_v_pp;
  __pyx_t_9functions_CFLOAT64 __pyx_v_cc;
  __pyx_t_9functions_CFLOAT64 __pyx_v_pp_best;
  __pyx_t_9functions_CINT32 __pyx_v_j;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_calc_prob", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("functions._calc_prob", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">448</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">ret</span><span class="p">,</span> <span class="nf">nx</span><span class="p">,</span> <span class="nf">nx_best</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nx_best = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">449</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">iok0</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span><span class="o">*</span><span class="n">pinfo</span><span class="o">.</span><span class="n">nj</span><span class="o">*</span><span class="n">pinfo</span><span class="o">.</span><span class="n">nk</span> <span class="o">+</span> <span class="n">lprob</span><span class="o">.</span><span class="n">mH</span><span class="o">*</span><span class="n">pinfo</span><span class="o">.</span><span class="n">nk</span></pre>
<pre class='cython code score-0 '>  __pyx_v_iok0 = (((__pyx_v_lprob-&gt;mL * __pyx_v_pinfo-&gt;nj) * __pyx_v_pinfo-&gt;nk) + (__pyx_v_lprob-&gt;mH * __pyx_v_pinfo-&gt;nk));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT64</span> <span class="nf">pprod</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">pp</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">pp_best</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pprod = 1.;
  __pyx_v_pp_best = 0.;
</pre><pre class="cython line score-0">&#xA0;<span class="">451</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">452</span>:   <span class="c"># cdef CINT32 nx_min = min(lprob.nx0,lprob.nx1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">453</span>:   <span class="c"># cdef CINT32 nx_max = nx_min + nr_max</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">455</span>:   <span class="c"># sort lprob by pno/pok ratios (low ratios lead to high probabilities)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">456</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="p">):</span> <span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_lprob-&gt;cnt;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    (__pyx_v_lprob-&gt;isort[__pyx_v_i]) = __pyx_v_i;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:   <span class="n">ret</span> <span class="o">=</span> <span class="n">argsort_F64</span><span class="p">(</span><span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">,</span> <span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">,</span> <span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ret = argsort_F64(__pyx_v_lprob-&gt;plr, __pyx_v_lprob-&gt;isort, __pyx_v_lprob-&gt;cnt, 1, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:   <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_ret &lt; 0) != 0);
  if (__pyx_t_4) {
    __pyx_r = __pyx_v_ret;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">459</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_max</span><span class="p">,</span> <span class="n">lprob</span><span class="o">.</span><span class="n">cnt</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_lprob-&gt;cnt;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = __pyx_v_nr_max; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:     <span class="k">if</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">_INF_64</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (((__pyx_v_lprob-&gt;plr[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]) == __pyx_v_9functions__INF_64) != 0);
    if (__pyx_t_4) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:       <span class="n">pprod</span> <span class="o">==</span> <span class="n">_INF_64</span></pre>
<pre class='cython code score-0 '>      (void)((__pyx_v_pprod == __pyx_v_9functions__INF_64));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>:       <span class="k">break</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L7_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">464</span>:     <span class="n">pprod</span> <span class="o">*=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>    __pyx_v_pprod = (__pyx_v_pprod * (__pyx_v_lprob-&gt;plr[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
  }
  __pyx_L7_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">465</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:   <span class="k">if</span> <span class="n">pprod</span> <span class="o">!=</span> <span class="n">_INF_64</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_pprod != __pyx_v_9functions__INF_64) != 0);
  if (__pyx_t_4) {
/* … */
    goto __pyx_L9;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_max</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = (__pyx_v_nr_max + 1);
    __pyx_t_6 = __pyx_t_5;
    for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_6; __pyx_t_1+=1) {
      __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:       <span class="n">ret</span> <span class="o">=</span> <span class="n">_lines_combs_rec</span><span class="p">(</span><span class="n">lprob</span><span class="p">,</span><span class="n">pprod</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">nr_max</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ret = __pyx_f_9functions__lines_combs_rec(__pyx_v_lprob, __pyx_v_pprod, 0, 0, __pyx_v_i, __pyx_v_nr_max);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:       <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-0 '>      __pyx_t_4 = ((__pyx_v_ret &lt; 0) != 0);
      if (__pyx_t_4) {
        __pyx_r = __pyx_v_ret;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ret</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_ret;
      __pyx_t_3 = __pyx_t_2;
      for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_3; __pyx_t_7+=1) {
        __pyx_v_j = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:         <span class="n">pp</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">pprods</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_v_pp = (__pyx_v_lprob-&gt;pprods[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:         <span class="n">nx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lprob</span><span class="o">.</span><span class="n">nxs0</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lprob</span><span class="o">.</span><span class="n">nxs1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = (__pyx_v_lprob-&gt;nxs1[__pyx_v_j]);
        __pyx_t_9 = (__pyx_v_lprob-&gt;nxs0[__pyx_v_j]);
        if (((__pyx_t_8 &lt; __pyx_t_9) != 0)) {
          __pyx_t_10 = __pyx_t_8;
        } else {
          __pyx_t_10 = __pyx_t_9;
        }
        __pyx_v_nx = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:         <span class="n">cc</span> <span class="o">=</span> <span class="n">pinfo</span><span class="o">.</span><span class="n">Coks</span><span class="p">[</span><span class="n">iok0</span><span class="o">+</span><span class="n">nx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_v_cc = (__pyx_v_pinfo-&gt;Coks[(__pyx_v_iok0 + __pyx_v_nx)]);
</pre><pre class="cython line score-0">&#xA0;<span class="">474</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">475</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">pp</span> <span class="o">==</span> <span class="n">_INF_64</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cc</span> <span class="o">==</span> <span class="n">_INF_64</span><span class="p">):</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = ((__pyx_v_pp == __pyx_v_9functions__INF_64) != 0);
        if (!__pyx_t_11) {
        } else {
          __pyx_t_4 = __pyx_t_11;
          goto __pyx_L16_bool_binop_done;
        }
        __pyx_t_11 = ((__pyx_v_cc == __pyx_v_9functions__INF_64) != 0);
        __pyx_t_4 = __pyx_t_11;
        __pyx_L16_bool_binop_done:;
        if (__pyx_t_4) {
          goto __pyx_L13_continue;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">pp</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cc</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = ((__pyx_v_pp == 0.) != 0);
        if (!__pyx_t_11) {
        } else {
          __pyx_t_4 = __pyx_t_11;
          goto __pyx_L19_bool_binop_done;
        }
        __pyx_t_11 = ((__pyx_v_cc == 0.) != 0);
        __pyx_t_4 = __pyx_t_11;
        __pyx_L19_bool_binop_done:;
        if (__pyx_t_4) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:           <span class="n">pp_best</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-0 '>          __pyx_v_pp_best = 1.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:           <span class="n">nx_best</span> <span class="o">=</span> <span class="n">nx</span></pre>
<pre class='cython code score-0 '>          __pyx_v_nx_best = __pyx_v_nx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:           <span class="k">break</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L14_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">480</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">481</span>:         <span class="n">pp</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">pp</span><span class="o">*</span><span class="n">cc</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>        __pyx_t_12 = (1. + (__pyx_v_pp * __pyx_v_cc));
        if (unlikely(__pyx_t_12 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 481, __pyx_L1_error)</span>
        }
        __pyx_v_pp = (((__pyx_t_9functions_CFLOAT64)1.) / __pyx_t_12);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:         <span class="k">if</span> <span class="n">pp</span><span class="o">&gt;</span><span class="n">pp_best</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_4 = ((__pyx_v_pp &gt; __pyx_v_pp_best) != 0);
        if (__pyx_t_4) {
/* … */
        }
        __pyx_L13_continue:;
      }
      __pyx_L14_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:           <span class="n">pp_best</span> <span class="o">=</span> <span class="n">pp</span></pre>
<pre class='cython code score-0 '>          __pyx_v_pp_best = __pyx_v_pp;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:           <span class="n">nx_best</span> <span class="o">=</span> <span class="n">nx</span></pre>
<pre class='cython code score-0 '>          __pyx_v_nx_best = __pyx_v_nx;
</pre><pre class="cython line score-0">&#xA0;<span class="">485</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:       <span class="k">if</span> <span class="n">pp_best</span> <span class="o">&gt;=</span> <span class="mf">1.</span><span class="p">:</span> <span class="k">break</span></pre>
<pre class='cython code score-0 '>      __pyx_t_4 = ((__pyx_v_pp_best &gt;= 1.) != 0);
      if (__pyx_t_4) {
        goto __pyx_L11_break;
      }
    }
    __pyx_L11_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">487</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:     <span class="n">pp_best</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_pp_best = 0.;
  }
  __pyx_L9:;
</pre><pre class="cython line score-0">&#xA0;<span class="">489</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">pp_best</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">pp_best</span><span class="o">&gt;</span><span class="mf">1.</span><span class="p">):</span> <span class="k">return</span> <span class="o">-</span><span class="mf">24000</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = ((__pyx_v_pp_best &lt; 0.) != 0);
  if (!__pyx_t_11) {
  } else {
    __pyx_t_4 = __pyx_t_11;
    goto __pyx_L24_bool_binop_done;
  }
  __pyx_t_11 = ((__pyx_v_pp_best &gt; 1.) != 0);
  __pyx_t_4 = __pyx_t_11;
  __pyx_L24_bool_binop_done:;
  if (__pyx_t_4) {
    __pyx_r = -24000;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:   <span class="n">pret</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">pp_best</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_pret[0]) = ((__pyx_t_9functions_CFLOAT32)__pyx_v_pp_best);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:   <span class="n">nxret</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx_best</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_nxret[0]) = __pyx_v_nx_best;
</pre><pre class="cython line score-0">&#xA0;<span class="">493</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:   <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">495</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">497</span>: <span class="c"># @cython.cdivision(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>: <span class="c"># @cython.boundscheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">499</span>: <span class="c"># @cython.wraparound(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">500</span>: <span class="c"># error code -2100</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>: <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">_lines_combs_rec</span><span class="p">(</span><span class="n">LprobStrct</span><span class="o">*</span> <span class="n">lprob</span><span class="p">,</span> <span class="n">CFLOAT64</span> <span class="n">pprod</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">i0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">j0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">left</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">nr_max</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static __pyx_t_9functions_CINT32 __pyx_f_9functions__lines_combs_rec(struct __pyx_t_9functions_LprobStrct *__pyx_v_lprob, __pyx_t_9functions_CFLOAT64 __pyx_v_pprod, __pyx_t_9functions_CINT32 __pyx_v_i0, __pyx_t_9functions_CINT32 __pyx_v_j0, __pyx_t_9functions_CINT32 __pyx_v_left, __pyx_t_9functions_CINT32 __pyx_v_nr_max) {
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_j;
  __pyx_t_9functions_CINT32 __pyx_v_j1;
  __pyx_t_9functions_CINT32 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_lines_combs_rec", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">502</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">j</span><span class="p">,</span><span class="nf">j1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">503</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>:   <span class="k">if</span> <span class="n">left</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_left == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:     <span class="k">if</span> <span class="n">j0</span><span class="o">&gt;=</span><span class="n">lprob</span><span class="o">.</span><span class="n">imax</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">2100</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_j0 &gt;= __pyx_v_lprob-&gt;imax) != 0);
    if (__pyx_t_1) {
      __pyx_r = -2100;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nxs0</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">nx0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_lprob-&gt;nx0;
    (__pyx_v_lprob-&gt;nxs0[__pyx_v_j0]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nxs1</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">nx1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_lprob-&gt;nx1;
    (__pyx_v_lprob-&gt;nxs1[__pyx_v_j0]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">508</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">pprods</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pprod</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_lprob-&gt;pprods[__pyx_v_j0]) = __pyx_v_pprod;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="n">nr_max</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_nr_max;
    __pyx_t_3 = __pyx_t_2;
    for (__pyx_t_4 = __pyx_v_i0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:       <span class="k">if</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">_INF_64</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = (((__pyx_v_lprob-&gt;plr[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]) == __pyx_v_9functions__INF_64) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">511</span>:         <span class="n">lprob</span><span class="o">.</span><span class="n">pprods</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_INF_64</span></pre>
<pre class='cython code score-0 '>        (__pyx_v_lprob-&gt;pprods[__pyx_v_j0]) = __pyx_v_9functions__INF_64;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:         <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L6_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">pprods</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">*=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_j0;
      (__pyx_v_lprob-&gt;pprods[__pyx_t_5]) = ((__pyx_v_lprob-&gt;pprods[__pyx_t_5]) * (__pyx_v_lprob-&gt;plr[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
    }
    __pyx_L6_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>:     <span class="k">return</span> <span class="n">j0</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_j0 + 1);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">515</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>:   <span class="k">if</span> <span class="n">left</span><span class="o">==</span><span class="n">nr_max</span><span class="o">-</span><span class="n">i0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_left == (__pyx_v_nr_max - __pyx_v_i0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>:     <span class="k">if</span> <span class="n">j0</span><span class="o">&gt;=</span><span class="n">lprob</span><span class="o">.</span><span class="n">imax</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">2101</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_j0 &gt;= __pyx_v_lprob-&gt;imax) != 0);
    if (__pyx_t_1) {
      __pyx_r = -2101;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">518</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nxs0</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">nx0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_lprob-&gt;nx0;
    (__pyx_v_lprob-&gt;nxs0[__pyx_v_j0]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">519</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">nxs1</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">nx1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_lprob-&gt;nx1;
    (__pyx_v_lprob-&gt;nxs1[__pyx_v_j0]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">520</span>:     <span class="n">lprob</span><span class="o">.</span><span class="n">pprods</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pprod</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_lprob-&gt;pprods[__pyx_v_j0]) = __pyx_v_pprod;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="n">nr_max</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_nr_max;
    __pyx_t_3 = __pyx_t_2;
    for (__pyx_t_4 = __pyx_v_i0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">nxs0</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">lnx0</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_j0;
      (__pyx_v_lprob-&gt;nxs0[__pyx_t_5]) = ((__pyx_v_lprob-&gt;nxs0[__pyx_t_5]) + (__pyx_v_lprob-&gt;lnx0[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">523</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">nxs1</span><span class="p">[</span><span class="n">j0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">lnx1</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_j0;
      (__pyx_v_lprob-&gt;nxs1[__pyx_t_5]) = ((__pyx_v_lprob-&gt;nxs1[__pyx_t_5]) + (__pyx_v_lprob-&gt;lnx1[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">524</span>:     <span class="k">return</span> <span class="n">j0</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_j0 + 1);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">525</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">526</span>:   <span class="k">if</span> <span class="n">left</span><span class="o">&gt;</span><span class="n">nr_max</span><span class="o">-</span><span class="n">i0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">2102</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_left &gt; (__pyx_v_nr_max - __pyx_v_i0)) != 0);
  if (__pyx_t_1) {
    __pyx_r = -2102;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">527</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">528</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="n">nr_max</span><span class="o">-</span><span class="n">left</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((__pyx_v_nr_max - __pyx_v_left) + 1);
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_2 = __pyx_v_i0; __pyx_t_2 &lt; __pyx_t_7; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">529</span>:     <span class="c"># current pair is not matching</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:     <span class="n">j1</span> <span class="o">=</span> <span class="n">_lines_combs_rec</span><span class="p">(</span><span class="n">lprob</span><span class="p">,</span><span class="n">pprod</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span><span class="n">j0</span><span class="p">,</span><span class="n">left</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">nr_max</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_j1 = __pyx_f_9functions__lines_combs_rec(__pyx_v_lprob, __pyx_v_pprod, (__pyx_v_i + 1), __pyx_v_j0, (__pyx_v_left - 1), __pyx_v_nr_max);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:     <span class="k">if</span> <span class="n">j1</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">j1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_j1 &lt; 0) != 0);
    if (__pyx_t_1) {
      __pyx_r = __pyx_v_j1;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">532</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">533</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j0</span><span class="p">,</span><span class="n">j1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_j1;
    __pyx_t_4 = __pyx_t_3;
    for (__pyx_t_5 = __pyx_v_j0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_j = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">534</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">nxs0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">lnx0</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_v_j;
      (__pyx_v_lprob-&gt;nxs0[__pyx_t_8]) = ((__pyx_v_lprob-&gt;nxs0[__pyx_t_8]) + (__pyx_v_lprob-&gt;lnx0[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">535</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">nxs1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">lnx1</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_v_j;
      (__pyx_v_lprob-&gt;nxs1[__pyx_t_8]) = ((__pyx_v_lprob-&gt;nxs1[__pyx_t_8]) + (__pyx_v_lprob-&gt;lnx1[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">536</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:     <span class="n">j0</span> <span class="o">=</span> <span class="n">j1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_j0 = __pyx_v_j1;
</pre><pre class="cython line score-0">&#xA0;<span class="">538</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">539</span>:     <span class="c"># for next cycles, current pair will be matching</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">540</span>:     <span class="k">if</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">_INF_64</span><span class="p">:</span> <span class="k">break</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (((__pyx_v_lprob-&gt;plr[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]) == __pyx_v_9functions__INF_64) != 0);
    if (__pyx_t_1) {
      goto __pyx_L14_break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">541</span>:     <span class="n">pprod</span> <span class="o">*=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">plr</span><span class="p">[</span><span class="n">lprob</span><span class="o">.</span><span class="n">isort</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>    __pyx_v_pprod = (__pyx_v_pprod * (__pyx_v_lprob-&gt;plr[(__pyx_v_lprob-&gt;isort[__pyx_v_i])]));
  }
  __pyx_L14_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">542</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">543</span>:   <span class="k">return</span> <span class="n">j0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_j0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">544</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">545</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">546</span>: <span class="c"># ---------------------------------- SCORING -----------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">547</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">548</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>: <span class="c"># Error code: -10000</span></pre>
<pre class="cython line score-216" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">554</span>: <span class="k">def</span> <span class="nf">score_sing</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns0</span><span class="p">,</span> <span class="n">CUINT64</span><span class="p">[:]</span> <span class="n">codes0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">i0</span><span class="p">,</span></pre>
<pre class='cython code score-216 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_9score_sing(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_9score_sing = {"score_sing", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_9score_sing, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_9score_sing(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_Es0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_codes0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_i0;
  __Pyx_memviewslice __pyx_v_Es1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_codes1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_j0;
  __pyx_t_9functions_CUINT8 __pyx_v_pself;
  __pyx_t_9functions_CINT32 __pyx_v_shape0;
  __pyx_t_9functions_CINT32 __pyx_v_shape1;
  __pyx_t_9functions_CFLOAT32 __pyx_v_density;
  __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE;
  __pyx_t_9functions_CFLOAT32 __pyx_v_min_simil;
  __pyx_t_9functions_CFLOAT32 __pyx_v_min_dig;
  __pyx_t_9functions_CFLOAT32 __pyx_v_min_ana;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("score_sing (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Es0,&amp;__pyx_n_s_ns0,&amp;__pyx_n_s_codes0,&amp;__pyx_n_s_i0,&amp;__pyx_n_s_Es1,&amp;__pyx_n_s_ns1,&amp;__pyx_n_s_codes1,&amp;__pyx_n_s_j0,&amp;__pyx_n_s_pself,&amp;__pyx_n_s_shape0,&amp;__pyx_n_s_shape1,&amp;__pyx_n_s_density,&amp;__pyx_n_s_max_dE,&amp;__pyx_n_s_min_simil,&amp;__pyx_n_s_min_dig,&amp;__pyx_n_s_min_ana,0};
    PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 1); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_codes0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 2); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 3); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 4); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 5); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_codes1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 6); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_j0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 7); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pself)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 8); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 9); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 10); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (likely((values[11] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 11); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (likely((values[12] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_dE)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 12); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (likely((values[13] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_simil)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 13); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (likely((values[14] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_dig)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 14); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (likely((values[15] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_ana)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, 15); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "score_sing") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 16) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
      values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
      values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
    }
    __pyx_v_Es0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es0.memview)) __PYX_ERR(0, 554, __pyx_L3_error)</span>
    __pyx_v_ns0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns0.memview)) __PYX_ERR(0, 554, __pyx_L3_error)</span>
    __pyx_v_codes0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_codes0.memview)) __PYX_ERR(0, 554, __pyx_L3_error)</span>
    __pyx_v_i0 = __Pyx_PyInt_As_npy_int32(values[3]); if (unlikely((__pyx_v_i0 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
    __pyx_v_Es1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es1.memview)) __PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_ns1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns1.memview)) __PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_codes1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_codes1.memview)) __PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_j0 = __Pyx_PyInt_As_npy_int32(values[7]); if (unlikely((__pyx_v_j0 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_pself = __Pyx_PyInt_As_npy_uint8(values[8]); if (unlikely((__pyx_v_pself == ((npy_uint8)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_shape0 = __Pyx_PyInt_As_npy_int32(values[9]); if (unlikely((__pyx_v_shape0 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_shape1 = __Pyx_PyInt_As_npy_int32(values[10]); if (unlikely((__pyx_v_shape1 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 555, __pyx_L3_error)</span>
    __pyx_v_density = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_density == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
    __pyx_v_max_dE = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_max_dE == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
    __pyx_v_min_simil = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[13]); if (unlikely((__pyx_v_min_simil == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
    __pyx_v_min_dig = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[14]); if (unlikely((__pyx_v_min_dig == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
    __pyx_v_min_ana = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[15]); if (unlikely((__pyx_v_min_ana == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score_sing", 1, 16, 16, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.score_sing", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_8score_sing(__pyx_self, __pyx_v_Es0, __pyx_v_ns0, __pyx_v_codes0, __pyx_v_i0, __pyx_v_Es1, __pyx_v_ns1, __pyx_v_codes1, __pyx_v_j0, __pyx_v_pself, __pyx_v_shape0, __pyx_v_shape1, __pyx_v_density, __pyx_v_max_dE, __pyx_v_min_simil, __pyx_v_min_dig, __pyx_v_min_ana);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_8score_sing(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_Es0, __Pyx_memviewslice __pyx_v_ns0, __Pyx_memviewslice __pyx_v_codes0, __pyx_t_9functions_CINT32 __pyx_v_i0, __Pyx_memviewslice __pyx_v_Es1, __Pyx_memviewslice __pyx_v_ns1, __Pyx_memviewslice __pyx_v_codes1, __pyx_t_9functions_CINT32 __pyx_v_j0, __pyx_t_9functions_CUINT8 __pyx_v_pself, __pyx_t_9functions_CINT32 __pyx_v_shape0, __pyx_t_9functions_CINT32 __pyx_v_shape1, __pyx_t_9functions_CFLOAT32 __pyx_v_density, __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE, __pyx_t_9functions_CFLOAT32 __pyx_v_min_simil, __pyx_t_9functions_CFLOAT32 __pyx_v_min_dig, __pyx_t_9functions_CFLOAT32 __pyx_v_min_ana) {
  PyObject *__pyx_v_cidx0 = NULL;
  __Pyx_memviewslice __pyx_v__cidx0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_cidx1 = NULL;
  __Pyx_memviewslice __pyx_v__cidx1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_len0;
  __pyx_t_9functions_CINT32 __pyx_v_len1;
  __pyx_t_9functions_CUINT64 __pyx_v_max_data;
  __pyx_t_9functions_CINT32 __pyx_v_lmax;
  PyObject *__pyx_v_indptr = NULL;
  __Pyx_memviewslice __pyx_v__indptr_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_indices = NULL;
  __Pyx_memviewslice __pyx_v__indices_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_data = NULL;
  __Pyx_memviewslice __pyx_v__data_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_nbit0 = NULL;
  __Pyx_memviewslice __pyx_v__nbit0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_nbit1 = NULL;
  __Pyx_memviewslice __pyx_v__nbit1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_dEs0 = NULL;
  __Pyx_memviewslice __pyx_v__dEs0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_dEs1 = NULL;
  __Pyx_memviewslice __pyx_v__dEs1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mtc0 = NULL;
  __Pyx_memviewslice __pyx_v__mtc0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mtc1 = NULL;
  __Pyx_memviewslice __pyx_v__mtc1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CUINT64 __pyx_v_iseq;
  __pyx_t_9functions_CFLOAT32 __pyx_v_dig;
  __pyx_t_9functions_CFLOAT32 __pyx_v_ana;
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_j;
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CINT32 __pyx_v_cnt;
  __pyx_t_9functions_CINT32 __pyx_v_npairs;
  __pyx_t_9functions_CINT32 __pyx_v_nx0;
  __pyx_t_9functions_CINT32 __pyx_v_nx1;
  __pyx_t_9functions_CINT32 __pyx_v_mL;
  __pyx_t_9functions_CINT32 __pyx_v_mH;
  __pyx_t_9functions_CINT32 __pyx_v_nx;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("score_sing", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.score_sing", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cidx0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__cidx0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cidx1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__cidx1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_indptr);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__indptr_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_indices);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__indices_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__data_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nbit0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__nbit0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nbit1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__nbit1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dEs0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__dEs0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dEs1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__dEs1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtc0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__mtc0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtc1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__mtc1_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_codes0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_codes1, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(57, __pyx_n_s_Es0, __pyx_n_s_ns0, __pyx_n_s_codes0, __pyx_n_s_i0, __pyx_n_s_Es1, __pyx_n_s_ns1, __pyx_n_s_codes1, __pyx_n_s_j0, __pyx_n_s_pself, __pyx_n_s_shape0, __pyx_n_s_shape1, __pyx_n_s_density, __pyx_n_s_max_dE, __pyx_n_s_min_simil, __pyx_n_s_min_dig, __pyx_n_s_min_ana, __pyx_n_s_cidx0, __pyx_n_s_cidx0_2, __pyx_n_s_cidx1, __pyx_n_s_cidx1_2, __pyx_n_s_len0, __pyx_n_s_len1, __pyx_n_s_max_data, __pyx_n_s_lmax, __pyx_n_s_indptr, __pyx_n_s_indptr_2, __pyx_n_s_indices, __pyx_n_s_indices_2, __pyx_n_s_data, __pyx_n_s_data_2, __pyx_n_s_nbit0, __pyx_n_s_nbit0_2, __pyx_n_s_nbit1, __pyx_n_s_nbit1_2, __pyx_n_s_dEs0, __pyx_n_s_dEs0_2, __pyx_n_s_dEs1, __pyx_n_s_dEs1_2, __pyx_n_s_mtc0, __pyx_n_s_mtc0_2, __pyx_n_s_mtc1, __pyx_n_s_mtc1_2, __pyx_n_s_iseq, __pyx_n_s_dig, __pyx_n_s_ana, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_ret, __pyx_n_s_cnt, __pyx_n_s_npairs, __pyx_n_s_nx0, __pyx_n_s_nx1, __pyx_n_s_mm, __pyx_n_s_mL, __pyx_n_s_mH, __pyx_n_s_nx);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_9score_sing, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_score_sing, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__34 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(16, 0, 57, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_score_sing, 554, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">555</span>:                <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns1</span><span class="p">,</span> <span class="n">CUINT64</span><span class="p">[:]</span> <span class="n">codes1</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">j0</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">pself</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">shape0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">shape1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">556</span>:                <span class="n">CFLOAT32</span> <span class="n">density</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">max_dE</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">min_simil</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">min_dig</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">min_ana</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">557</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">558</span>:   <span class="n">cidx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_7, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_7, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_8, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cidx0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">559</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_cidx0_</span> <span class="o">=</span> <span class="n">cidx0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_cidx0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  __pyx_v__cidx0_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">560</span>:   <span class="n">cidx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_6, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_6, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_8, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_8, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_8, __pyx_int_0);
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_cidx1 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_cidx1_</span> <span class="o">=</span> <span class="n">cidx1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_cidx1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 561, __pyx_L1_error)</span>
  __pyx_v__cidx1_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">562</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">563</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">len0</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">ns0</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_ns0); 
  __pyx_v_len0 = ((__pyx_t_9functions_CINT32)__pyx_t_10);
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">564</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns0</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es0); 
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 564, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 564, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 564, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 564, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 564, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 564, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">565</span>:   <span class="k">assert</span> <span class="n">len0</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes0</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_codes0); 
    if (unlikely(!((__pyx_v_len0 == __pyx_t_10) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">566</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">len1</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">ns1</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_ns1); 
  __pyx_v_len1 = ((__pyx_t_9functions_CINT32)__pyx_t_10);
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">568</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns1</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es1); 
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:   <span class="k">assert</span> <span class="n">len1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes1</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_codes1); 
    if (unlikely(!((__pyx_v_len1 == __pyx_t_10) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">570</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">571</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">max_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">density</span><span class="o">*</span><span class="n">len0</span><span class="o">*</span><span class="n">len1</span><span class="p">))</span></pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ceil);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_density * __pyx_v_len0) * __pyx_v_len1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_12 = __Pyx_PyInt_As_npy_uint64(__pyx_t_2); if (unlikely((__pyx_t_12 == ((npy_uint64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_max_data = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">572</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">lmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">ns0</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">ns1</span><span class="p">))</span></pre>
<pre class='cython code score-24 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_11) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    __pyx_t_2 = __pyx_t_5;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = __pyx_t_1;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_13 = __Pyx_PyInt_As_npy_int32(__pyx_t_2); if (unlikely((__pyx_t_13 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_lmax = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">573</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">574</span>:   <span class="n">indptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape0</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_shape0 + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_indptr = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">575</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span>[<span class="p">:]</span> <span class="n">_indptr_</span> <span class="o">=</span> <span class="n">indptr</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(__pyx_v_indptr, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  __pyx_v__indptr_ = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">576</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">577</span>:   <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">max_data</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_npy_uint64(__pyx_v_max_data);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_indices = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">578</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_indices_</span> <span class="o">=</span> <span class="n">indices</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_indices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 578, __pyx_L1_error)</span>
  __pyx_v__indices_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">579</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">580</span>:   <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_full_like);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_indices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_indices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_data = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span>[<span class="p">:]</span> <span class="n">_data_</span> <span class="o">=</span> <span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(__pyx_v_data, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 581, __pyx_L1_error)</span>
  __pyx_v__data_ = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">582</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">583</span>:   <span class="n">nbit0</span> <span class="o">=</span> <span class="n">_nbits64</span><span class="p">(</span><span class="n">codes0</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_nbits64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_codes0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_nbit0 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_nbit0_</span> <span class="o">=</span> <span class="n">nbit0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_nbit0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  __pyx_v__nbit0_ = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:   <span class="n">nbit1</span> <span class="o">=</span> <span class="n">_nbits64</span><span class="p">(</span><span class="n">codes1</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_nbits64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_codes1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_nbit1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_nbit1_</span> <span class="o">=</span> <span class="n">nbit1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_nbit1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  __pyx_v__nbit1_ = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">587</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">588</span>:   <span class="n">dEs0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dEs0 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">589</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_dEs0_</span> <span class="o">=</span> <span class="n">dEs0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_dEs0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 589, __pyx_L1_error)</span>
  __pyx_v__dEs0_ = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:   <span class="n">dEs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dEs1 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_dEs1_</span> <span class="o">=</span> <span class="n">dEs1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_dEs1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 591, __pyx_L1_error)</span>
  __pyx_v__dEs1_ = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">592</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">593</span>:   <span class="n">mtc0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_neg_1);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_mtc0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">594</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_mtc0_</span> <span class="o">=</span> <span class="n">mtc0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_mtc0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 594, __pyx_L1_error)</span>
  __pyx_v__mtc0_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">595</span>:   <span class="n">mtc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_neg_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_mtc1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">596</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_mtc1_</span> <span class="o">=</span> <span class="n">mtc1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_mtc1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 596, __pyx_L1_error)</span>
  __pyx_v__mtc1_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">597</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">598</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">599</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">iseq</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_iseq = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">600</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">dig</span><span class="p">,</span> <span class="nf">ana</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">601</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">ret</span><span class="p">,</span> <span class="nf">cnt</span><span class="p">,</span> <span class="nf">npairs</span><span class="p">,</span> <span class="nf">nx0</span><span class="p">,</span> <span class="nf">nx1</span><span class="p">,</span> <span class="nf">mm</span><span class="p">,</span> <span class="nf">mL</span><span class="p">,</span> <span class="nf">mH</span><span class="p">,</span> <span class="nf">nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">602</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">603</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __pyx_v_len0;
  __pyx_t_16 = __pyx_t_13;
  for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">604</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_len1;
    __pyx_t_19 = __pyx_t_18;
    for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
      __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">605</span>:       <span class="k">if</span> <span class="n">pself</span> <span class="ow">and</span> <span class="p">(</span><span class="n">j0</span><span class="o">+</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="p">):</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = (__pyx_v_pself != 0);
      if (__pyx_t_21) {
      } else {
        __pyx_t_11 = __pyx_t_21;
        goto __pyx_L8_bool_binop_done;
      }
      __pyx_t_21 = (((__pyx_v_j0 + __pyx_v_j) &lt;= (__pyx_v_i0 + __pyx_v_i)) != 0);
      __pyx_t_11 = __pyx_t_21;
      __pyx_L8_bool_binop_done:;
      if (__pyx_t_11) {
        goto __pyx_L5_continue;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:       <span class="k">if</span> <span class="n">bits_count</span><span class="p">(</span><span class="n">codes0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="n">codes1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="nb">min</span><span class="p">(</span><span class="n">_nbit0_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">_nbit1_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">min_simil</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_i;
      __pyx_t_23 = __pyx_v_j;
      __pyx_t_24 = __pyx_v_j;
      __pyx_t_25 = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__nbit1_.data + __pyx_t_24 * __pyx_v__nbit1_.strides[0]) )));
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_26 = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__nbit0_.data + __pyx_t_24 * __pyx_v__nbit0_.strides[0]) )));
      if (((__pyx_t_25 &lt; __pyx_t_26) != 0)) {
        __pyx_t_27 = __pyx_t_25;
      } else {
        __pyx_t_27 = __pyx_t_26;
      }
      __pyx_t_11 = (((__pyx_f_9functions_bits_count(((*((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_codes0.data + __pyx_t_22 * __pyx_v_codes0.strides[0]) ))) &amp; (*((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_codes1.data + __pyx_t_23 * __pyx_v_codes1.strides[0]) ))))) / __pyx_t_27) &lt; __pyx_v_min_simil) != 0);
      if (__pyx_t_11) {
        goto __pyx_L5_continue;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">607</span>:       <span class="n">ret</span> <span class="o">=</span> <span class="n">_match_pair_score</span><span class="p">(</span><span class="n">Es0</span><span class="p">,</span> <span class="n">_cidx0_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">_dEs0_</span><span class="p">,</span> <span class="n">_mtc0_</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>      __pyx_t_23 = __pyx_v_i;
      __pyx_t_22 = __pyx_v_i;
/* … */
      __pyx_v_ret = __pyx_f_9functions__match_pair_score(__pyx_v_Es0, (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_23 * __pyx_v__cidx0_.strides[0]) ))), (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_22 * __pyx_v_ns0.strides[0]) ))), __pyx_v__dEs0_, __pyx_v__mtc0_, __pyx_v_Es1, (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_24 * __pyx_v__cidx1_.strides[0]) ))), (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_28 * __pyx_v_ns1.strides[0]) ))), __pyx_v__dEs1_, __pyx_v__mtc1_, __pyx_v_max_dE, (&amp;__pyx_v_ana), (&amp;__pyx_v_cnt), (&amp;__pyx_v_npairs), (&amp;__pyx_v_nx0), (&amp;__pyx_v_nx1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">608</span>:                               <span class="n">Es1</span><span class="p">,</span> <span class="n">_cidx1_</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ns1</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_dEs1_</span><span class="p">,</span> <span class="n">_mtc1_</span><span class="p">,</span> <span class="n">max_dE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ana</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cnt</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">npairs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nx0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nx1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_j;
      __pyx_t_28 = __pyx_v_j;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">609</span>:       <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-1 '>      __pyx_t_11 = ((__pyx_v_ret &lt; 0) != 0);
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_ret);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 609, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_r = __pyx_t_5;
        __pyx_t_5 = 0;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">610</span>:       <span class="k">if</span> <span class="n">ana</span><span class="o">==</span><span class="n">_0</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = ((__pyx_v_ana == __pyx_v_9functions__0) != 0);
      if (__pyx_t_11) {
        goto __pyx_L5_continue;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">611</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">612</span>:       <span class="k">if</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">ns1</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_28 = __pyx_v_i;
      __pyx_t_24 = __pyx_v_j;
      __pyx_t_11 = (((*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_28 * __pyx_v_ns0.strides[0]) ))) == (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_24 * __pyx_v_ns1.strides[0]) )))) != 0);
      if (__pyx_t_11) {
/* … */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">613</span>:         <span class="n">mL</span> <span class="o">=</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_i;
        __pyx_v_mL = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_24 * __pyx_v_ns0.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">614</span>:         <span class="n">mH</span> <span class="o">=</span> <span class="n">mL</span></pre>
<pre class='cython code score-0 '>        __pyx_v_mH = __pyx_v_mL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">615</span>:         <span class="n">nx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nx0</span><span class="p">,</span><span class="n">nx1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_t_29 = __pyx_v_nx1;
        __pyx_t_30 = __pyx_v_nx0;
        if (((__pyx_t_29 &lt; __pyx_t_30) != 0)) {
          __pyx_t_31 = __pyx_t_29;
        } else {
          __pyx_t_31 = __pyx_t_30;
        }
        __pyx_v_nx = __pyx_t_31;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">616</span>:       <span class="k">elif</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">ns1</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_i;
      __pyx_t_28 = __pyx_v_j;
      __pyx_t_11 = (((*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_24 * __pyx_v_ns0.strides[0]) ))) &gt; (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_28 * __pyx_v_ns1.strides[0]) )))) != 0);
      if (__pyx_t_11) {
/* … */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">617</span>:         <span class="n">mL</span> <span class="o">=</span> <span class="n">ns1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_j;
        __pyx_v_mL = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_28 * __pyx_v_ns1.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">618</span>:         <span class="n">mH</span> <span class="o">=</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_i;
        __pyx_v_mH = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_28 * __pyx_v_ns0.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">619</span>:         <span class="n">nx</span> <span class="o">=</span> <span class="n">nx1</span></pre>
<pre class='cython code score-0 '>        __pyx_v_nx = __pyx_v_nx1;
</pre><pre class="cython line score-0">&#xA0;<span class="">620</span>:       <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">621</span>:         <span class="n">mL</span> <span class="o">=</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_28 = __pyx_v_i;
        __pyx_v_mL = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_28 * __pyx_v_ns0.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">622</span>:         <span class="n">mH</span> <span class="o">=</span> <span class="n">ns1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_j;
        __pyx_v_mH = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_28 * __pyx_v_ns1.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">623</span>:         <span class="n">nx</span> <span class="o">=</span> <span class="n">nx0</span></pre>
<pre class='cython code score-0 '>        __pyx_v_nx = __pyx_v_nx0;
      }
      __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">624</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">625</span>:       <span class="n">dig</span> <span class="o">=</span> <span class="n">_1</span> <span class="o">-</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">nx</span><span class="o">/</span><span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">mL</span></pre>
<pre class='cython code score-0 '>      __pyx_v_dig = (__pyx_v_9functions__1 - (((__pyx_t_9functions_CFLOAT32)__pyx_v_nx) / ((__pyx_t_9functions_CFLOAT32)__pyx_v_mL)));
</pre><pre class="cython line score-0">&#xA0;<span class="">626</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">627</span>:       <span class="k">if</span> <span class="p">(</span><span class="n">dig</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dig</span><span class="o">&gt;</span><span class="mf">1.</span><span class="p">):</span> <span class="k">return</span> <span class="o">-</span><span class="mf">10000</span></pre>
<pre class='cython code score-2 '>      __pyx_t_21 = ((__pyx_v_dig &lt; 0.) != 0);
      if (!__pyx_t_21) {
      } else {
        __pyx_t_11 = __pyx_t_21;
        goto __pyx_L15_bool_binop_done;
      }
      __pyx_t_21 = ((__pyx_v_dig &gt; 1.) != 0);
      __pyx_t_11 = __pyx_t_21;
      __pyx_L15_bool_binop_done:;
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_10000);
        __pyx_r = __pyx_int_neg_10000;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:       <span class="k">if</span> <span class="p">(</span><span class="n">ana</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ana</span><span class="o">&gt;</span><span class="mf">1.</span><span class="p">):</span> <span class="k">return</span> <span class="o">-</span><span class="mf">10001</span></pre>
<pre class='cython code score-2 '>      __pyx_t_21 = ((__pyx_v_ana &lt; 0.) != 0);
      if (!__pyx_t_21) {
      } else {
        __pyx_t_11 = __pyx_t_21;
        goto __pyx_L18_bool_binop_done;
      }
      __pyx_t_21 = ((__pyx_v_ana &gt; 1.) != 0);
      __pyx_t_11 = __pyx_t_21;
      __pyx_L18_bool_binop_done:;
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_10001);
        __pyx_r = __pyx_int_neg_10001;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">629</span>:       <span class="k">if</span> <span class="p">(</span><span class="n">ana</span><span class="o">&lt;</span><span class="n">min_ana</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dig</span><span class="o">&lt;</span><span class="n">min_dig</span><span class="p">):</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = ((__pyx_v_ana &lt; __pyx_v_min_ana) != 0);
      if (!__pyx_t_21) {
      } else {
        __pyx_t_11 = __pyx_t_21;
        goto __pyx_L21_bool_binop_done;
      }
      __pyx_t_21 = ((__pyx_v_dig &lt; __pyx_v_min_dig) != 0);
      __pyx_t_11 = __pyx_t_21;
      __pyx_L21_bool_binop_done:;
      if (__pyx_t_11) {
        goto __pyx_L5_continue;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">630</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>:       <span class="n">_data_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;(</span><span class="mf">65535</span><span class="o">*</span><span class="n">ana</span><span class="p">))</span><span class="o">&lt;&lt;</span><span class="mf">48</span><span class="p">)</span><span class="o">+</span><span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;(</span><span class="mf">65535</span><span class="o">*</span><span class="n">dig</span><span class="p">))</span><span class="o">&lt;&lt;</span><span class="mf">32</span><span class="p">)</span><span class="o">+</span><span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;</span><span class="n">mH</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mf">16</span><span class="p">)</span><span class="o">+</span><span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;</span><span class="n">mL</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mf">8</span><span class="p">)</span><span class="o">+</span><span class="p">(&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_iseq;
      *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v__data_.data + __pyx_t_12 * __pyx_v__data_.strides[0]) )) = (((((((__pyx_t_9functions_CUINT64)(65535.0 * __pyx_v_ana)) &lt;&lt; 48) + (((__pyx_t_9functions_CUINT64)(65535.0 * __pyx_v_dig)) &lt;&lt; 32)) + (((__pyx_t_9functions_CUINT64)__pyx_v_mH) &lt;&lt; 16)) + (((__pyx_t_9functions_CUINT64)__pyx_v_mL) &lt;&lt; 8)) + ((__pyx_t_9functions_CUINT64)__pyx_v_nx));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:       <span class="n">_indices_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">j0</span><span class="o">+</span><span class="n">j</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_iseq;
      *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__indices_.data + __pyx_t_12 * __pyx_v__indices_.strides[0]) )) = (__pyx_v_j0 + __pyx_v_j);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">633</span>:       <span class="n">iseq</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_iseq = (__pyx_v_iseq + 1);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">634</span>:       <span class="k">if</span> <span class="n">iseq</span> <span class="o">&gt;=</span> <span class="n">max_data</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">10002</span></pre>
<pre class='cython code score-2 '>      __pyx_t_11 = ((__pyx_v_iseq &gt;= __pyx_v_max_data) != 0);
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_10002);
        __pyx_r = __pyx_int_neg_10002;
        goto __pyx_L0;
      }
      __pyx_L5_continue:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">635</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">636</span>:     <span class="n">_indptr_</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">iseq</span></pre>
<pre class='cython code score-0 '>    __pyx_t_28 = ((__pyx_v_i0 + __pyx_v_i) + 1);
    *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v__indptr_.data + __pyx_t_28 * __pyx_v__indptr_.strides[0]) )) = __pyx_v_iseq;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">637</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">638</span>:   <span class="n">_indptr_</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">iseq</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14.data = __pyx_v__indptr_.data;
  __pyx_t_14.memview = __pyx_v__indptr_.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
  __pyx_t_8 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_14,
    __pyx_v__indptr_.shape[0], __pyx_v__indptr_.strides[0], __pyx_v__indptr_.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_8,
    ((__pyx_v_i0 + __pyx_v_i) + 1),
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
}

{
      __pyx_t_9functions_CUINT64 __pyx_temp_scalar = __pyx_v_iseq;
      {
          Py_ssize_t __pyx_temp_extent_0 = __pyx_t_14.shape[0];
          Py_ssize_t __pyx_temp_stride_0 = __pyx_t_14.strides[0];
          char *__pyx_temp_pointer_0;
          Py_ssize_t __pyx_temp_idx_0;
          __pyx_temp_pointer_0 = __pyx_t_14.data;
          for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 &lt; __pyx_temp_extent_0; __pyx_temp_idx_0++) {
            *((__pyx_t_9functions_CUINT64 *) __pyx_temp_pointer_0) = __pyx_temp_scalar;
            __pyx_temp_pointer_0 += __pyx_temp_stride_0;
          }
      }
  }
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">639</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">640</span>:   <span class="k">return</span> <span class="n">csr_array</span><span class="p">((</span><span class="n">data</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">indices</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">indptr</span><span class="p">),</span> <span class="p">(</span><span class="n">shape0</span><span class="p">,</span> <span class="n">shape1</span><span class="p">))</span></pre>
<pre class='cython code score-62 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_csr_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_data, 0, __pyx_v_iseq, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_indices, 0, __pyx_v_iseq, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indptr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_indptr);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_indptr);
  __pyx_t_3 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_npy_int32(__pyx_v_shape0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_shape1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_3);
  __pyx_t_6 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_2, __pyx_t_7};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_2, __pyx_t_7};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_8, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_8, __pyx_t_7);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">641</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">642</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">643</span>: <span class="c"># # -------------------------------- PROBABILITY ---------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">644</span>: <span class="c"># # ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">645</span>: <span class="c"># # ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">646</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">647</span>: <span class="c"># @cython.cdivision(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">648</span>: <span class="c"># @cython.boundscheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">649</span>: <span class="c"># @cython.wraparound(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">650</span>: <span class="c"># error code -20000</span></pre>
<pre class="cython line score-230" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">651</span>: <span class="k">def</span> <span class="nf">prob_sing</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns0</span><span class="p">,</span> <span class="n">CUINT64</span><span class="p">[:]</span> <span class="n">codes0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">i0</span><span class="p">,</span></pre>
<pre class='cython code score-230 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_11prob_sing(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_11prob_sing = {"prob_sing", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_11prob_sing, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_11prob_sing(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_Es0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_codes0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_i0;
  __Pyx_memviewslice __pyx_v_Es1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_codes1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_j0;
  __pyx_t_9functions_CINT32 __pyx_v_shape0;
  __pyx_t_9functions_CINT32 __pyx_v_shape1;
  __pyx_t_9functions_CUINT8 __pyx_v_pself;
  __pyx_t_9functions_CFLOAT32 __pyx_v_density;
  __pyx_t_9functions_CFLOAT32 __pyx_v_min_simil;
  __pyx_t_9functions_CFLOAT32 __pyx_v_min_dig;
  __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE;
  __pyx_t_9functions_CFLOAT32 __pyx_v_min_prob;
  PyObject *__pyx_v_pfit = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prob_sing (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Es0,&amp;__pyx_n_s_ns0,&amp;__pyx_n_s_codes0,&amp;__pyx_n_s_i0,&amp;__pyx_n_s_Es1,&amp;__pyx_n_s_ns1,&amp;__pyx_n_s_codes1,&amp;__pyx_n_s_j0,&amp;__pyx_n_s_shape0,&amp;__pyx_n_s_shape1,&amp;__pyx_n_s_pself,&amp;__pyx_n_s_density,&amp;__pyx_n_s_min_simil,&amp;__pyx_n_s_min_dig,&amp;__pyx_n_s_max_dE,&amp;__pyx_n_s_min_prob,&amp;__pyx_n_s_pfit,0};
    PyObject* values[17] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 1); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_codes0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 2); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 3); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 4); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 5); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_codes1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 6); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_j0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 7); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 8); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 9); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pself)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 10); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (likely((values[11] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 11); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (likely((values[12] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_simil)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 12); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (likely((values[13] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_dig)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 13); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (likely((values[14] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_dE)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 14); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (likely((values[15] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_prob)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 15); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (likely((values[16] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pfit)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, 16); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "prob_sing") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 17) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
      values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
      values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
      values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
    }
    __pyx_v_Es0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es0.memview)) __PYX_ERR(0, 651, __pyx_L3_error)</span>
    __pyx_v_ns0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns0.memview)) __PYX_ERR(0, 651, __pyx_L3_error)</span>
    __pyx_v_codes0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_codes0.memview)) __PYX_ERR(0, 651, __pyx_L3_error)</span>
    __pyx_v_i0 = __Pyx_PyInt_As_npy_int32(values[3]); if (unlikely((__pyx_v_i0 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
    __pyx_v_Es1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es1.memview)) __PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_ns1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns1.memview)) __PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_codes1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_codes1.memview)) __PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_j0 = __Pyx_PyInt_As_npy_int32(values[7]); if (unlikely((__pyx_v_j0 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_shape0 = __Pyx_PyInt_As_npy_int32(values[8]); if (unlikely((__pyx_v_shape0 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_shape1 = __Pyx_PyInt_As_npy_int32(values[9]); if (unlikely((__pyx_v_shape1 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_pself = __Pyx_PyInt_As_npy_uint8(values[10]); if (unlikely((__pyx_v_pself == ((npy_uint8)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_density = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_density == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L3_error)</span>
    __pyx_v_min_simil = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_min_simil == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L3_error)</span>
    __pyx_v_min_dig = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[13]); if (unlikely((__pyx_v_min_dig == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L3_error)</span>
    __pyx_v_max_dE = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[14]); if (unlikely((__pyx_v_max_dE == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L3_error)</span>
    __pyx_v_min_prob = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[15]); if (unlikely((__pyx_v_min_prob == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L3_error)</span>
    __pyx_v_pfit = values[16];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prob_sing", 1, 17, 17, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.prob_sing", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_10prob_sing(__pyx_self, __pyx_v_Es0, __pyx_v_ns0, __pyx_v_codes0, __pyx_v_i0, __pyx_v_Es1, __pyx_v_ns1, __pyx_v_codes1, __pyx_v_j0, __pyx_v_shape0, __pyx_v_shape1, __pyx_v_pself, __pyx_v_density, __pyx_v_min_simil, __pyx_v_min_dig, __pyx_v_max_dE, __pyx_v_min_prob, __pyx_v_pfit);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_10prob_sing(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_Es0, __Pyx_memviewslice __pyx_v_ns0, __Pyx_memviewslice __pyx_v_codes0, __pyx_t_9functions_CINT32 __pyx_v_i0, __Pyx_memviewslice __pyx_v_Es1, __Pyx_memviewslice __pyx_v_ns1, __Pyx_memviewslice __pyx_v_codes1, __pyx_t_9functions_CINT32 __pyx_v_j0, __pyx_t_9functions_CINT32 __pyx_v_shape0, __pyx_t_9functions_CINT32 __pyx_v_shape1, __pyx_t_9functions_CUINT8 __pyx_v_pself, __pyx_t_9functions_CFLOAT32 __pyx_v_density, __pyx_t_9functions_CFLOAT32 __pyx_v_min_simil, __pyx_t_9functions_CFLOAT32 __pyx_v_min_dig, __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE, __pyx_t_9functions_CFLOAT32 __pyx_v_min_prob, PyObject *__pyx_v_pfit) {
  PyObject *__pyx_v__cidx0 = NULL;
  __Pyx_memviewslice __pyx_v_cidx0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__cidx1 = NULL;
  __Pyx_memviewslice __pyx_v_cidx1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_len0;
  __pyx_t_9functions_CINT32 __pyx_v_len1;
  __pyx_t_9functions_CUINT64 __pyx_v_iseq_max;
  __pyx_t_9functions_CUINT64 __pyx_v_iseq;
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_j;
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CINT32 __pyx_v_nxret;
  __pyx_t_9functions_CINT32 __pyx_v_mL;
  __pyx_t_9functions_CINT32 __pyx_v_mH;
  __pyx_t_9functions_CINT32 __pyx_v_nx_max;
  __pyx_t_9functions_CINT32 __pyx_v_nr_max;
  __pyx_t_9functions_CINT32 __pyx_v_lmax;
  __pyx_t_9functions_CFLOAT32 __pyx_v_pret;
  PyObject *__pyx_v__indptr = NULL;
  __Pyx_memviewslice __pyx_v_indptr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__indices = NULL;
  __Pyx_memviewslice __pyx_v_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__data = NULL;
  __Pyx_memviewslice __pyx_v_data = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__nbit0 = NULL;
  __Pyx_memviewslice __pyx_v_nbit0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__nbit1 = NULL;
  __Pyx_memviewslice __pyx_v_nbit1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__dEs0 = NULL;
  __Pyx_memviewslice __pyx_v_dEs0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__dEs1 = NULL;
  __Pyx_memviewslice __pyx_v_dEs1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__mtc0 = NULL;
  __Pyx_memviewslice __pyx_v_mtc0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__mtc1 = NULL;
  __Pyx_memviewslice __pyx_v_mtc1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pok_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pok_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pno_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pno_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pok_val = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pno_val = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__Coks = NULL;
  __Pyx_memviewslice __pyx_v_Coks = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_9functions_ItpMatrix __pyx_v_Mok;
  struct __pyx_t_9functions_ItpMatrix __pyx_v_Mno;
  struct __pyx_t_9functions_PinfoStrct __pyx_v_pinfo;
  PyObject *__pyx_v__plr = NULL;
  __Pyx_memviewslice __pyx_v_plr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__lnx0 = NULL;
  __Pyx_memviewslice __pyx_v_lnx0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__lnx1 = NULL;
  __Pyx_memviewslice __pyx_v_lnx1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__isort = NULL;
  __Pyx_memviewslice __pyx_v_isort = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_imax;
  PyObject *__pyx_v__pprod = NULL;
  __Pyx_memviewslice __pyx_v_pprod = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__nxs0 = NULL;
  __Pyx_memviewslice __pyx_v_nxs0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v__nxs1 = NULL;
  __Pyx_memviewslice __pyx_v_nxs1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_9functions_LprobStrct __pyx_v_lprob;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prob_sing", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.prob_sing", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__cidx0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cidx0, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__cidx1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cidx1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__indptr);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indptr, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__indices);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indices, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__data);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_data, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__nbit0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nbit0, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__nbit1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nbit1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__dEs0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dEs0, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__dEs1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dEs1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__mtc0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mtc0, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__mtc1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mtc1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pok_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pok_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pno_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pno_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pok_val, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pno_val, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__Coks);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Coks, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__plr);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_plr, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__lnx0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_lnx0, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__lnx1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_lnx1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__isort);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_isort, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__pprod);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pprod, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__nxs0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nxs0, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__nxs1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nxs1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_codes0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_codes1, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(80, __pyx_n_s_Es0, __pyx_n_s_ns0, __pyx_n_s_codes0, __pyx_n_s_i0, __pyx_n_s_Es1, __pyx_n_s_ns1, __pyx_n_s_codes1, __pyx_n_s_j0, __pyx_n_s_shape0, __pyx_n_s_shape1, __pyx_n_s_pself, __pyx_n_s_density, __pyx_n_s_min_simil, __pyx_n_s_min_dig, __pyx_n_s_max_dE, __pyx_n_s_min_prob, __pyx_n_s_pfit, __pyx_n_s_cidx0_3, __pyx_n_s_cidx0, __pyx_n_s_cidx1_3, __pyx_n_s_cidx1, __pyx_n_s_len0, __pyx_n_s_len1, __pyx_n_s_iseq_max, __pyx_n_s_iseq, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_ret, __pyx_n_s_nxret, __pyx_n_s_mL, __pyx_n_s_mH, __pyx_n_s_nx_max, __pyx_n_s_nr_max, __pyx_n_s_lmax, __pyx_n_s_pret, __pyx_n_s_indptr_3, __pyx_n_s_indptr, __pyx_n_s_indices_3, __pyx_n_s_indices, __pyx_n_s_data_3, __pyx_n_s_data, __pyx_n_s_nbit0_3, __pyx_n_s_nbit0, __pyx_n_s_nbit1_3, __pyx_n_s_nbit1, __pyx_n_s_dEs0_3, __pyx_n_s_dEs0, __pyx_n_s_dEs1_3, __pyx_n_s_dEs1, __pyx_n_s_mtc0_3, __pyx_n_s_mtc0, __pyx_n_s_mtc1_3, __pyx_n_s_mtc1, __pyx_n_s_pok_x, __pyx_n_s_pok_y, __pyx_n_s_pno_x, __pyx_n_s_pno_y, __pyx_n_s_pok_val, __pyx_n_s_pno_val, __pyx_n_s_Coks_2, __pyx_n_s_Coks, __pyx_n_s_Mok, __pyx_n_s_Mno, __pyx_n_s_pinfo, __pyx_n_s_plr_2, __pyx_n_s_plr, __pyx_n_s_lnx0_2, __pyx_n_s_lnx0, __pyx_n_s_lnx1_2, __pyx_n_s_lnx1, __pyx_n_s_isort_2, __pyx_n_s_isort, __pyx_n_s_imax, __pyx_n_s_pprod, __pyx_n_s_pprod_2, __pyx_n_s_nxs0_2, __pyx_n_s_nxs0, __pyx_n_s_nxs1_2, __pyx_n_s_nxs1, __pyx_n_s_lprob);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_11prob_sing, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_prob_sing, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__36 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(17, 0, 80, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_prob_sing, 651, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">652</span>:               <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns1</span><span class="p">,</span> <span class="n">CUINT64</span><span class="p">[:]</span> <span class="n">codes1</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">j0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">shape0</span><span class="p">,</span> <span class="n">CINT32</span> <span class="n">shape1</span><span class="p">,</span> <span class="n">CUINT8</span> <span class="n">pself</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">density</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">653</span>:               <span class="n">CFLOAT32</span> <span class="n">min_simil</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">min_dig</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">max_dE</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">min_prob</span><span class="p">,</span> <span class="n">pfit</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">654</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">655</span>:   <span class="n">_cidx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_7, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_7, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_8, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__cidx0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">656</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">cidx0</span> <span class="o">=</span> <span class="n">_cidx0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__cidx0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
  __pyx_v_cidx0 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">657</span>:   <span class="n">_cidx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_6, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_6, __pyx_int_0, __pyx_int_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_8, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_8, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_8, __pyx_int_0);
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v__cidx1 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">658</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">cidx1</span> <span class="o">=</span> <span class="n">_cidx1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__cidx1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  __pyx_v_cidx1 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">659</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">660</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">len0</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">ns0</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_ns0); 
  __pyx_v_len0 = ((__pyx_t_9functions_CINT32)__pyx_t_10);
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">661</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns0</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es0); 
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 661, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 661, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 661, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 661, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 661, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">662</span>:   <span class="k">assert</span> <span class="n">len0</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes0</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_codes0); 
    if (unlikely(!((__pyx_v_len0 == __pyx_t_10) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">663</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">664</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">len1</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">ns1</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_ns1); 
  __pyx_v_len1 = ((__pyx_t_9functions_CINT32)__pyx_t_10);
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">665</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns1</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es1); 
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">666</span>:   <span class="k">assert</span> <span class="n">len1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes1</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_codes1); 
    if (unlikely(!((__pyx_v_len1 == __pyx_t_10) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 666, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">667</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pfit</span><span class="o">.</span><span class="n">pok_x</span><span class="p">)</span> <span class="o">==</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pok_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-36 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_x);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_val);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">669</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pfit</span><span class="o">.</span><span class="n">pok_y</span><span class="p">)</span> <span class="o">==</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pok_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-36 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_y);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_val);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">670</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pfit</span><span class="o">.</span><span class="n">pno_x</span><span class="p">)</span> <span class="o">==</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pno_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-36 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_x);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_val);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">671</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pfit</span><span class="o">.</span><span class="n">pno_y</span><span class="p">)</span> <span class="o">==</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pno_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-36 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_y);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_val);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">672</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">iseq_max</span><span class="p">,</span><span class="nf">iseq</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_iseq = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">674</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">j</span><span class="p">,</span><span class="nf">ret</span><span class="p">,</span><span class="nf">nxret</span><span class="p">,</span> <span class="nf">mL</span><span class="p">,</span><span class="nf">mH</span><span class="p">,</span><span class="nf">nx_max</span><span class="p">,</span><span class="nf">nr_max</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">lmax</span><span class="o">=</span><span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">ns0</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">ns1</span><span class="p">))</span></pre>
<pre class='cython code score-24 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_11) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = __pyx_t_1;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    __pyx_t_2 = __pyx_t_5;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_13 = __Pyx_PyInt_As_npy_int32(__pyx_t_2); if (unlikely((__pyx_t_13 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_lmax = ((__pyx_t_9functions_CINT32)__pyx_t_13);
</pre><pre class="cython line score-0">&#xA0;<span class="">676</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">pret</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">677</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">678</span>:   <span class="k">assert</span> <span class="n">lmax</span> <span class="o">&lt;</span> <span class="mf">256</span></pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    if (unlikely(!((__pyx_v_lmax &lt; 0x100) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">679</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">680</span>:   <span class="n">iseq_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">density</span><span class="o">*</span><span class="n">len0</span><span class="o">*</span><span class="n">len1</span><span class="p">))</span></pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ceil);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_density * __pyx_v_len0) * __pyx_v_len1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_14 = __Pyx_PyInt_As_npy_uint64(__pyx_t_2); if (unlikely((__pyx_t_14 == ((npy_uint64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_iseq_max = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">681</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">682</span>:   <span class="n">_indptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape0</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_shape0 + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v__indptr = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">683</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span>[<span class="p">:]</span> <span class="n">indptr</span> <span class="o">=</span> <span class="n">_indptr</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(__pyx_v__indptr, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
  __pyx_v_indptr = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">684</span>:   <span class="n">_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">iseq_max</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_npy_uint64(__pyx_v_iseq_max);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v__indices = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">685</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">_indices</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__indices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 685, __pyx_L1_error)</span>
  __pyx_v_indices = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">686</span>:   <span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_full_like);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_indices, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CINT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CINT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_uint64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__data = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">687</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span>[<span class="p">:]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">_data</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT64(__pyx_v__data, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 687, __pyx_L1_error)</span>
  __pyx_v_data = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">688</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">689</span>:   <span class="n">_nbit0</span> <span class="o">=</span> <span class="n">_nbits64</span><span class="p">(</span><span class="n">codes0</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_nbits64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_codes0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__nbit0 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">690</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">nbit0</span> <span class="o">=</span> <span class="n">_nbit0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v__nbit0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 690, __pyx_L1_error)</span>
  __pyx_v_nbit0 = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">691</span>:   <span class="n">_nbit1</span> <span class="o">=</span> <span class="n">_nbits64</span><span class="p">(</span><span class="n">codes1</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_nbits64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_codes1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__nbit1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">692</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">nbit1</span> <span class="o">=</span> <span class="n">_nbit1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v__nbit1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
  __pyx_v_nbit1 = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">693</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">694</span>:   <span class="n">_dEs0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v__dEs0 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">695</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">dEs0</span> <span class="o">=</span> <span class="n">_dEs0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v__dEs0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  __pyx_v_dEs0 = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">696</span>:   <span class="n">_dEs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v__dEs1 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">697</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">dEs1</span> <span class="o">=</span> <span class="n">_dEs1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v__dEs1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
  __pyx_v_dEs1 = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">698</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">699</span>:   <span class="n">_mtc0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v__mtc0 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">700</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">mtc0</span> <span class="o">=</span> <span class="n">_mtc0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__mtc0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 700, __pyx_L1_error)</span>
  __pyx_v_mtc0 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">701</span>:   <span class="n">_mtc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__mtc1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">702</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">mtc1</span> <span class="o">=</span> <span class="n">_mtc1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__mtc1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
  __pyx_v_mtc1 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">703</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">704</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">pok_x</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pok_x</span></pre>
<pre class='cython code score-3 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_x);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 704, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 704, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pok_x = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">705</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">pok_y</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pok_y</span></pre>
<pre class='cython code score-3 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_y);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pok_y = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">706</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">pno_x</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pno_x</span></pre>
<pre class='cython code score-3 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_x);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pno_x = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">707</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">pno_y</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pno_y</span></pre>
<pre class='cython code score-3 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_y);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pno_y = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">708</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">pok_val</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pok_val</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pok_val);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_n_u_C) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_n_u_C);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pok_val = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">709</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">pno_val</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">pno_val</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_pno_val);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_n_u_C) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_n_u_C);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pno_val = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">710</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">711</span>:   <span class="n">_Coks</span> <span class="o">=</span> <span class="n">pfit</span><span class="o">.</span><span class="n">poks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_poks);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_3 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_n_u_C) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_n_u_C);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v__Coks = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">712</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT64</span>[<span class="p">:]</span> <span class="n">Coks</span> <span class="o">=</span> <span class="n">_Coks</span></pre>
<pre class='cython code score-0 '>  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT64(__pyx_v__Coks, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
  __pyx_v_Coks = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">713</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">_Coks</span><span class="o">.</span><span class="n">shape</span><span class="p">)):</span></pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_prod);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v__Coks, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_5); if (unlikely((__pyx_t_18 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_19 = __pyx_t_18;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_19; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">714</span>:     <span class="k">if</span> <span class="n">Coks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">Coks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_INF_64</span></pre>
<pre class='cython code score-4 '>    __pyx_t_20 = __pyx_v_i;
    __pyx_t_8 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_v_Coks.shape[0];
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_Coks.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (((*((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_Coks.data + __pyx_t_20 * __pyx_v_Coks.strides[0]) ))) == 0.) != 0);
    if (__pyx_t_11) {
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_Coks.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_Coks.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
      }
      *((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_Coks.data + __pyx_t_20 * __pyx_v_Coks.strides[0]) )) = __pyx_v_9functions__INF_64;
      goto __pyx_L5;
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">715</span>:     <span class="k">else</span><span class="p">:</span>             <span class="n">Coks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">Coks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mf">1.</span></pre>
<pre class='cython code score-9 '>    /*else*/ {
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_Coks.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_Coks.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L1_error)</span>
      }
      __pyx_t_21 = (*((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_Coks.data + __pyx_t_20 * __pyx_v_Coks.strides[0]) )));
      if (unlikely(__pyx_t_21 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L1_error)</span>
      }
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_Coks.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_Coks.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L1_error)</span>
      }
      *((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_Coks.data + __pyx_t_20 * __pyx_v_Coks.strides[0]) )) = ((((__pyx_t_9functions_CFLOAT64)1.) / __pyx_t_21) - 1.);
    }
    __pyx_L5:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">716</span>: </pre>
<pre class="cython line score-108" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">717</span>:   <span class="k">cdef</span> <span class="kt">ItpMatrix</span> <span class="nf">Mok</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pok_x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pok_y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;Z&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pok_val</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;dx&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">pok_x</span><span class="p">)),</span> <span class="s">&#39;dy&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">pok_y</span><span class="p">)),</span></pre>
<pre class='cython code score-108 '>  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pok_x.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pok_x.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  }
  __pyx_t_22.x = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_pok_x.data + __pyx_t_20 * __pyx_v_pok_x.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pok_y.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pok_y.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  }
  __pyx_t_22.y = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_pok_y.data + __pyx_t_20 * __pyx_v_pok_y.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pok_val.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pok_val.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  }
  __pyx_t_22.Z = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_pok_val.data + __pyx_t_20 * __pyx_v_pok_val.strides[0]) ))));
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_pok_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CFLOAT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CFLOAT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_5); if (unlikely((__pyx_t_23 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_22.dx = ((__pyx_t_9functions_CFLOAT32)__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_pok_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CFLOAT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CFLOAT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_5); if (unlikely((__pyx_t_23 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_22.dy = ((__pyx_t_9functions_CFLOAT32)__pyx_t_23);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">718</span>:                         <span class="s">&#39;nx&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">pok_x</span><span class="p">),</span> <span class="s">&#39;ny&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">pok_y</span><span class="p">)}</span></pre>
<pre class='cython code score-4 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_pok_x); 
  __pyx_t_22.nx = ((__pyx_t_9functions_CINT32)__pyx_t_10);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_pok_y); 
  __pyx_t_22.ny = ((__pyx_t_9functions_CINT32)__pyx_t_10);
  __pyx_v_Mok = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">719</span>: </pre>
<pre class="cython line score-108" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">720</span>:   <span class="k">cdef</span> <span class="kt">ItpMatrix</span> <span class="nf">Mno</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pno_x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pno_y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;Z&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pno_val</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;dx&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">pno_x</span><span class="p">)),</span> <span class="s">&#39;dy&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">pno_y</span><span class="p">)),</span></pre>
<pre class='cython code score-108 '>  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pno_x.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pno_x.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  }
  __pyx_t_22.x = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_pno_x.data + __pyx_t_20 * __pyx_v_pno_x.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pno_y.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pno_y.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  }
  __pyx_t_22.y = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_pno_y.data + __pyx_t_20 * __pyx_v_pno_y.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pno_val.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pno_val.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  }
  __pyx_t_22.Z = (&amp;(*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_pno_val.data + __pyx_t_20 * __pyx_v_pno_val.strides[0]) ))));
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_pno_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CFLOAT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CFLOAT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_5); if (unlikely((__pyx_t_23 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_22.dx = ((__pyx_t_9functions_CFLOAT32)__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_pno_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CFLOAT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CFLOAT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_5); if (unlikely((__pyx_t_23 == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_22.dy = ((__pyx_t_9functions_CFLOAT32)__pyx_t_23);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">721</span>:                         <span class="s">&#39;nx&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">pno_x</span><span class="p">),</span> <span class="s">&#39;ny&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">pno_y</span><span class="p">)}</span></pre>
<pre class='cython code score-4 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_pno_x); 
  __pyx_t_22.nx = ((__pyx_t_9functions_CINT32)__pyx_t_10);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_pno_y); 
  __pyx_t_22.ny = ((__pyx_t_9functions_CINT32)__pyx_t_10);
  __pyx_v_Mno = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">722</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">723</span>:   <span class="k">cdef</span> <span class="kt">PinfoStrct</span> <span class="nf">pinfo</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Mok&#39;</span><span class="p">:</span> <span class="n">Mok</span><span class="p">,</span> <span class="s">&#39;Mno&#39;</span><span class="p">:</span> <span class="n">Mno</span><span class="p">,</span> <span class="s">&#39;Coks&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Coks</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-2 '>  __pyx_t_24.Mok = __pyx_v_Mok;
  __pyx_t_24.Mno = __pyx_v_Mno;
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_Coks.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_Coks.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 723, __pyx_L1_error)</span>
  }
  __pyx_t_24.Coks = (&amp;(*((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_Coks.data + __pyx_t_20 * __pyx_v_Coks.strides[0]) ))));
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:                            <span class="s">&#39;ni&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;(</span><span class="n">pfit</span><span class="o">.</span><span class="n">poks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="s">&#39;nj&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;(</span><span class="n">pfit</span><span class="o">.</span><span class="n">poks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="s">&#39;nk&#39;</span><span class="p">:</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;(</span><span class="n">pfit</span><span class="o">.</span><span class="n">poks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">])}</span></pre>
<pre class='cython code score-42 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_poks);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_13 = __Pyx_PyInt_As_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_13 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_24.ni = ((__pyx_t_9functions_CINT32)__pyx_t_13);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_poks);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_13 = __Pyx_PyInt_As_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_13 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_24.nj = ((__pyx_t_9functions_CINT32)__pyx_t_13);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pfit, __pyx_n_s_poks);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_13 = __Pyx_PyInt_As_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_13 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_24.nk = ((__pyx_t_9functions_CINT32)__pyx_t_13);
  __pyx_v_pinfo = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">725</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:   <span class="n">_plr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v__plr = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">727</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT64</span>[<span class="p">:]</span> <span class="n">plr</span> <span class="o">=</span> <span class="n">_plr</span></pre>
<pre class='cython code score-0 '>  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT64(__pyx_v__plr, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 727, __pyx_L1_error)</span>
  __pyx_v_plr = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">728</span>:   <span class="n">_lnx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v__lnx0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">729</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">lnx0</span> <span class="o">=</span> <span class="n">_lnx0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__lnx0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 729, __pyx_L1_error)</span>
  __pyx_v_lnx0 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">730</span>:   <span class="n">_lnx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v__lnx1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">731</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">lnx1</span> <span class="o">=</span> <span class="n">_lnx1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__lnx1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
  __pyx_v_lnx1 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">732</span>:   <span class="n">_isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__isort = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">733</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">isort</span> <span class="o">=</span> <span class="n">_isort</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__isort, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
  __pyx_v_isort = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">734</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">735</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">imax</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">pinfo</span><span class="o">.</span><span class="n">nk</span><span class="o">//</span><span class="mf">2</span><span class="p">,</span> <span class="n">pinfo</span><span class="o">.</span><span class="n">nk</span><span class="p">)</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_imax = (__pyx_f_9functions_binom(__Pyx_div_long(__pyx_v_pinfo.nk, 2), __pyx_v_pinfo.nk) + 1);
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:   <span class="n">_pprod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_imax);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v__pprod = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">737</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT64</span>[<span class="p">:]</span> <span class="n">pprod</span> <span class="o">=</span> <span class="n">_pprod</span></pre>
<pre class='cython code score-0 '>  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT64(__pyx_v__pprod, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
  __pyx_v_pprod = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">738</span>:   <span class="n">_nxs0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_npy_int32(__pyx_v_imax);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v__nxs0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">739</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">nxs0</span> <span class="o">=</span> <span class="n">_nxs0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__nxs0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  __pyx_v_nxs0 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">740</span>:   <span class="n">_nxs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_npy_int32(__pyx_v_imax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v__nxs1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">741</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">nxs1</span> <span class="o">=</span> <span class="n">_nxs1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v__nxs1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
  __pyx_v_nxs1 = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">742</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">743</span>:   <span class="k">cdef</span> <span class="kt">LprobStrct</span> <span class="nf">lprob</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;plr&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">plr</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;lnx0&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lnx0</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;lnx1&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lnx1</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;isort&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">isort</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;pprods&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">pprod</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;nxs0&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">nxs0</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s">&#39;nxs1&#39;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">nxs1</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-14 '>  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_plr.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_plr.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.plr = (&amp;(*((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_plr.data + __pyx_t_20 * __pyx_v_plr.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_lnx0.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_lnx0.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.lnx0 = (&amp;(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_lnx0.data + __pyx_t_20 * __pyx_v_lnx0.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_lnx1.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_lnx1.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.lnx1 = (&amp;(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_lnx1.data + __pyx_t_20 * __pyx_v_lnx1.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_isort.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_isort.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.isort = (&amp;(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_isort.data + __pyx_t_20 * __pyx_v_isort.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_pprod.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_pprod.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.pprods = (&amp;(*((__pyx_t_9functions_CFLOAT64 *) ( /* dim=0 */ (__pyx_v_pprod.data + __pyx_t_20 * __pyx_v_pprod.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_nxs0.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_nxs0.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.nxs0 = (&amp;(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_nxs0.data + __pyx_t_20 * __pyx_v_nxs0.strides[0]) ))));
  __pyx_t_20 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_nxs1.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_nxs1.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  }
  __pyx_t_25.nxs1 = (&amp;(*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_nxs1.data + __pyx_t_20 * __pyx_v_nxs1.strides[0]) ))));
  __pyx_t_25.mL = 0;
  __pyx_t_25.mH = 0;
  __pyx_t_25.nx0 = 0;
  __pyx_t_25.nx1 = 0;
  __pyx_t_25.nx = 0;
  __pyx_t_25.npairs = 0;
  __pyx_t_25.cnt = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">744</span>:                            <span class="s">&#39;mL&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;mH&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;nx0&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;nx1&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;nx&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;npairs&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;cnt&#39;</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&#39;lmax&#39;</span><span class="p">:</span> <span class="n">lmax</span><span class="p">,</span> <span class="s">&#39;imax&#39;</span><span class="p">:</span> <span class="n">imax</span><span class="p">}</span></pre>
<pre class='cython code score-0 '>  __pyx_t_25.lmax = __pyx_v_lmax;
  __pyx_t_25.imax = __pyx_v_imax;
  __pyx_v_lprob = __pyx_t_25;
</pre><pre class="cython line score-0">&#xA0;<span class="">745</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">746</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __pyx_v_len0;
  __pyx_t_26 = __pyx_t_13;
  for (__pyx_t_27 = 0; __pyx_t_27 &lt; __pyx_t_26; __pyx_t_27+=1) {
    __pyx_v_i = __pyx_t_27;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">747</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_28 = __pyx_v_len1;
    __pyx_t_29 = __pyx_t_28;
    for (__pyx_t_30 = 0; __pyx_t_30 &lt; __pyx_t_29; __pyx_t_30+=1) {
      __pyx_v_j = __pyx_t_30;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">748</span>:       <span class="k">if</span> <span class="n">pself</span> <span class="ow">and</span> <span class="p">(</span><span class="n">j0</span><span class="o">+</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="p">):</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_31 = (__pyx_v_pself != 0);
      if (__pyx_t_31) {
      } else {
        __pyx_t_11 = __pyx_t_31;
        goto __pyx_L11_bool_binop_done;
      }
      __pyx_t_31 = (((__pyx_v_j0 + __pyx_v_j) &lt;= (__pyx_v_i0 + __pyx_v_i)) != 0);
      __pyx_t_11 = __pyx_t_31;
      __pyx_L11_bool_binop_done:;
      if (__pyx_t_11) {
        goto __pyx_L8_continue;
      }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">749</span>:       <span class="k">if</span> <span class="n">bits_count</span><span class="p">(</span><span class="n">codes0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="n">codes1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="nb">min</span><span class="p">(</span><span class="n">nbit0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nbit1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">min_simil</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-13 '>      __pyx_t_20 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_codes0.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_codes0.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      }
      __pyx_t_32 = __pyx_v_j;
      __pyx_t_8 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_codes1.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_codes1.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      }
      __pyx_t_23 = __pyx_f_9functions_bits_count(((*((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_codes0.data + __pyx_t_20 * __pyx_v_codes0.strides[0]) ))) &amp; (*((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_codes1.data + __pyx_t_32 * __pyx_v_codes1.strides[0]) )))));
      __pyx_t_32 = __pyx_v_j;
      __pyx_t_8 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_nbit1.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_nbit1.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      }
      __pyx_t_33 = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_nbit1.data + __pyx_t_32 * __pyx_v_nbit1.strides[0]) )));
      __pyx_t_32 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_nbit0.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_nbit0.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      }
      __pyx_t_34 = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_nbit0.data + __pyx_t_32 * __pyx_v_nbit0.strides[0]) )));
      if (((__pyx_t_33 &lt; __pyx_t_34) != 0)) {
        __pyx_t_35 = __pyx_t_33;
      } else {
        __pyx_t_35 = __pyx_t_34;
      }
      __pyx_t_33 = __pyx_t_35;
      if (unlikely(__pyx_t_33 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      }
      __pyx_t_11 = (((__pyx_t_23 / __pyx_t_33) &lt; __pyx_v_min_simil) != 0);
      if (__pyx_t_11) {
        goto __pyx_L8_continue;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">750</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">751</span>:       <span class="n">ret</span> <span class="o">=</span> <span class="n">_match_pair_prob</span><span class="p">(</span><span class="n">Es0</span><span class="p">,</span> <span class="n">cidx0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ns0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">mtc0</span><span class="p">,</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">cidx1</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ns1</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">mtc1</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>      __pyx_t_32 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_cidx0.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_cidx0.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
      }
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_ns0.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_ns0.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
      }
      __pyx_t_36 = __pyx_v_j;
      __pyx_t_8 = -1;
      if (__pyx_t_36 &lt; 0) {
        __pyx_t_36 += __pyx_v_cidx1.shape[0];
        if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_cidx1.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
      }
      __pyx_t_37 = __pyx_v_j;
      __pyx_t_8 = -1;
      if (__pyx_t_37 &lt; 0) {
        __pyx_t_37 += __pyx_v_ns1.shape[0];
        if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_ns1.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
      }
/* … */
      __pyx_v_ret = __pyx_f_9functions__match_pair_prob(__pyx_v_Es0, (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_cidx0.data + __pyx_t_32 * __pyx_v_cidx0.strides[0]) ))), (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_20 * __pyx_v_ns0.strides[0]) ))), __pyx_v_dEs0, __pyx_v_mtc0, __pyx_v_Es1, (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_cidx1.data + __pyx_t_36 * __pyx_v_cidx1.strides[0]) ))), (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_37 * __pyx_v_ns1.strides[0]) ))), __pyx_v_dEs1, __pyx_v_mtc1, (&amp;__pyx_v_lprob), (&amp;__pyx_v_pinfo), __pyx_v_max_dE);
</pre><pre class="cython line score-0">&#xA0;<span class="">752</span>:                              <span class="o">&amp;</span><span class="n">lprob</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pinfo</span><span class="p">,</span> <span class="n">max_dE</span><span class="p">)</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">753</span>:       <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-1 '>      __pyx_t_11 = ((__pyx_v_ret &lt; 0) != 0);
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_ret);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_r = __pyx_t_3;
        __pyx_t_3 = 0;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">754</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:       <span class="k">if</span> <span class="p">(</span><span class="n">_1</span><span class="o">-</span><span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">lprob</span><span class="o">.</span><span class="n">nx</span><span class="o">/</span><span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">lprob</span><span class="o">.</span><span class="n">mL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_dig</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-5 '>      if (unlikely(((__pyx_t_9functions_CFLOAT32)__pyx_v_lprob.mL) == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
      }
      __pyx_t_11 = (((__pyx_v_9functions__1 - (((__pyx_t_9functions_CFLOAT32)__pyx_v_lprob.nx) / ((__pyx_t_9functions_CFLOAT32)__pyx_v_lprob.mL))) &lt; __pyx_v_min_dig) != 0);
      if (__pyx_t_11) {
        goto __pyx_L8_continue;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">756</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">757</span>:       <span class="n">nx_max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pinfo</span><span class="o">.</span><span class="n">nk</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">((</span><span class="n">_1</span><span class="o">-</span><span class="n">min_dig</span><span class="p">)</span><span class="o">*</span><span class="p">&lt;</span><span class="kt">CFLOAT32</span><span class="p">&gt;</span><span class="n">lprob</span><span class="o">.</span><span class="n">mL</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>      __pyx_t_38 = ((__pyx_t_9functions_CINT32)floor(((__pyx_v_9functions__1 - __pyx_v_min_dig) * ((__pyx_t_9functions_CFLOAT32)__pyx_v_lprob.mL))));
      __pyx_t_18 = (__pyx_v_pinfo.nk - 1);
      if (((__pyx_t_38 &lt; __pyx_t_18) != 0)) {
        __pyx_t_19 = __pyx_t_38;
      } else {
        __pyx_t_19 = __pyx_t_18;
      }
      __pyx_v_nx_max = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">758</span>:       <span class="n">nr_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="n">nx_max</span><span class="o">-</span><span class="n">lprob</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_38 = (__pyx_v_nx_max - __pyx_v_lprob.nx);
      __pyx_t_19 = 0;
      if (((__pyx_t_38 &gt; __pyx_t_19) != 0)) {
        __pyx_t_18 = __pyx_t_38;
      } else {
        __pyx_t_18 = __pyx_t_19;
      }
      __pyx_v_nr_max = __pyx_t_18;
</pre><pre class="cython line score-0">&#xA0;<span class="">759</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">760</span>:       <span class="n">mL</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span></pre>
<pre class='cython code score-0 '>      __pyx_t_38 = __pyx_v_lprob.mL;
      __pyx_v_mL = __pyx_t_38;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">761</span>:       <span class="n">mH</span> <span class="o">=</span> <span class="n">lprob</span><span class="o">.</span><span class="n">mH</span></pre>
<pre class='cython code score-0 '>      __pyx_t_38 = __pyx_v_lprob.mH;
      __pyx_v_mH = __pyx_t_38;
</pre><pre class="cython line score-0">&#xA0;<span class="">762</span>:       <span class="c"># when calc probabilities, limit mL and mH based on the size of poks</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">763</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">mL</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">mL</span><span class="p">,</span><span class="n">pinfo</span><span class="o">.</span><span class="n">ni</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_pinfo.ni - 1);
      __pyx_t_38 = __pyx_v_mL;
      if (((__pyx_t_18 &lt; __pyx_t_38) != 0)) {
        __pyx_t_19 = __pyx_t_18;
      } else {
        __pyx_t_19 = __pyx_t_38;
      }
      __pyx_v_lprob.mL = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">764</span>:       <span class="n">lprob</span><span class="o">.</span><span class="n">mH</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">mH</span><span class="p">,</span><span class="n">pinfo</span><span class="o">.</span><span class="n">nj</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_pinfo.nj - 1);
      __pyx_t_38 = __pyx_v_mH;
      if (((__pyx_t_19 &lt; __pyx_t_38) != 0)) {
        __pyx_t_18 = __pyx_t_19;
      } else {
        __pyx_t_18 = __pyx_t_38;
      }
      __pyx_v_lprob.mH = __pyx_t_18;
</pre><pre class="cython line score-0">&#xA0;<span class="">765</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">766</span>:       <span class="n">ret</span> <span class="o">=</span> <span class="n">_calc_prob</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lprob</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pinfo</span><span class="p">,</span> <span class="n">nr_max</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pret</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nxret</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ret = __pyx_f_9functions__calc_prob((&amp;__pyx_v_lprob), (&amp;__pyx_v_pinfo), __pyx_v_nr_max, (&amp;__pyx_v_pret), (&amp;__pyx_v_nxret));
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">767</span>:       <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-1 '>      __pyx_t_11 = ((__pyx_v_ret &lt; 0) != 0);
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_ret);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_r = __pyx_t_3;
        __pyx_t_3 = 0;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">768</span>:       <span class="k">if</span> <span class="n">pret</span><span class="o">&lt;</span><span class="n">min_prob</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = ((__pyx_v_pret &lt; __pyx_v_min_prob) != 0);
      if (__pyx_t_11) {
        goto __pyx_L8_continue;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">769</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">770</span>:       <span class="k">if</span> <span class="n">iseq</span> <span class="o">&gt;=</span> <span class="n">iseq_max</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">20000</span></pre>
<pre class='cython code score-2 '>      __pyx_t_11 = ((__pyx_v_iseq &gt;= __pyx_v_iseq_max) != 0);
      if (__pyx_t_11) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_20000);
        __pyx_r = __pyx_int_neg_20000;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">771</span>:       <span class="c"># when saving data, use the real values of mH and mL</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">772</span>:       <span class="n">data</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;(</span><span class="o">&lt;</span><span class="n">CUINT32</span><span class="o">*&gt;&amp;</span><span class="n">pret</span><span class="p">)[</span><span class="mf">0</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="mf">32</span><span class="p">)</span> <span class="o">+</span> <span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;</span><span class="n">mH</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mf">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">((&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;</span><span class="n">mL</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mf">8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;</span><span class="n">nxret</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_14 = __pyx_v_iseq;
      __pyx_t_8 = -1;
      if (unlikely(__pyx_t_14 &gt;= (size_t)__pyx_v_data.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>
      }
      *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_14 * __pyx_v_data.strides[0]) )) = ((((((__pyx_t_9functions_CUINT64)(((__pyx_t_9functions_CUINT32 *)(&amp;__pyx_v_pret))[0])) &lt;&lt; 32) + (((__pyx_t_9functions_CUINT64)__pyx_v_mH) &lt;&lt; 16)) + (((__pyx_t_9functions_CUINT64)__pyx_v_mL) &lt;&lt; 8)) + ((__pyx_t_9functions_CUINT64)__pyx_v_nxret));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">773</span>:       <span class="n">indices</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">j0</span><span class="o">+</span><span class="n">j</span></pre>
<pre class='cython code score-2 '>      __pyx_t_14 = __pyx_v_iseq;
      __pyx_t_8 = -1;
      if (unlikely(__pyx_t_14 &gt;= (size_t)__pyx_v_indices.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
      }
      *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indices.data + __pyx_t_14 * __pyx_v_indices.strides[0]) )) = (__pyx_v_j0 + __pyx_v_j);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">774</span>:       <span class="n">iseq</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_iseq = (__pyx_v_iseq + 1);
      __pyx_L8_continue:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">775</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">776</span>:     <span class="n">indptr</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">iseq</span></pre>
<pre class='cython code score-2 '>    __pyx_t_37 = ((__pyx_v_i0 + __pyx_v_i) + 1);
    __pyx_t_8 = -1;
    if (__pyx_t_37 &lt; 0) {
      __pyx_t_37 += __pyx_v_indptr.shape[0];
      if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_indptr.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>
    }
    *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_indptr.data + __pyx_t_37 * __pyx_v_indptr.strides[0]) )) = __pyx_v_iseq;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">777</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">778</span>:   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mf">2</span><span class="p">,</span> <span class="n">shape0</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span> <span class="n">indptr</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">iseq</span></pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (__pyx_v_shape0 + 1);
  __pyx_t_19 = __pyx_t_18;
  for (__pyx_t_13 = ((__pyx_v_i0 + __pyx_v_i) + 2); __pyx_t_13 &lt; __pyx_t_19; __pyx_t_13+=1) {
    __pyx_v_j = __pyx_t_13;
    __pyx_t_37 = __pyx_v_j;
    __pyx_t_8 = -1;
    if (__pyx_t_37 &lt; 0) {
      __pyx_t_37 += __pyx_v_indptr.shape[0];
      if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_indptr.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 778, __pyx_L1_error)</span>
    }
    *((__pyx_t_9functions_CUINT64 *) ( /* dim=0 */ (__pyx_v_indptr.data + __pyx_t_37 * __pyx_v_indptr.strides[0]) )) = __pyx_v_iseq;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">779</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">780</span>:   <span class="k">return</span> <span class="n">csr_array</span><span class="p">((</span><span class="n">data</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">indices</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">indptr</span><span class="p">),</span> <span class="p">(</span><span class="n">shape0</span><span class="p">,</span> <span class="n">shape1</span><span class="p">))</span></pre>
<pre class='cython code score-57 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_csr_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_15.data = __pyx_v_data.data;
  __pyx_t_15.memview = __pyx_v_data.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 0);
  __pyx_t_8 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_15,
    __pyx_v_data.shape[0], __pyx_v_data.strides[0], __pyx_v_data.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_8,
    0,
    __pyx_v_iseq,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
}

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_15, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
  __pyx_t_9.data = __pyx_v_indices.data;
  __pyx_t_9.memview = __pyx_v_indices.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
  __pyx_t_8 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_9,
    __pyx_v_indices.shape[0], __pyx_v_indices.strides[0], __pyx_v_indices.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_8,
    0,
    __pyx_v_iseq,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
}

__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CINT32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CINT32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_indptr, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT64, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT64, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_5);
  __pyx_t_6 = 0;
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_shape0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = __Pyx_PyInt_From_npy_int32(__pyx_v_shape1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2);
  __pyx_t_5 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_7, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_7, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_t_6);
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">781</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">782</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">783</span>: <span class="c"># ------------------------------ SIMPLE MATCHING -------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">784</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">785</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">786</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">787</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">788</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">789</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">790</span>: <span class="k">def</span> <span class="nf">simple_match_symm</span><span class="p">(</span><span class="n">poss</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span></pre>
<pre class='cython code score-46 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_13simple_match_symm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_13simple_match_symm = {"simple_match_symm", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_13simple_match_symm, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_13simple_match_symm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_poss = 0;
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simple_match_symm (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_poss,&amp;__pyx_n_s_key,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_poss)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simple_match_symm", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_match_symm") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_poss = values[0];
    __pyx_v_key = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simple_match_symm", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.simple_match_symm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_12simple_match_symm(__pyx_self, __pyx_v_poss, __pyx_v_key);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_12simple_match_symm(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_poss, PyObject *__pyx_v_key) {
  __pyx_t_9functions_CINT32 __pyx_v_nrow;
  __Pyx_memviewslice __pyx_v_indptr_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_indices_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_score_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_indptr_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_indices_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pidxs_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_j;
  __pyx_t_9functions_CINT32 __pyx_v_rr;
  __pyx_t_9functions_CINT32 __pyx_v_ccol;
  __pyx_t_9functions_CINT32 __pyx_v_crow;
  __pyx_t_9functions_CFLOAT32 __pyx_v_curr;
  PyObject *__pyx_v_match0 = NULL;
  __Pyx_memviewslice __pyx_v__match0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_match1 = NULL;
  __Pyx_memviewslice __pyx_v__match1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simple_match_symm", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.simple_match_symm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indptr_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indices_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_score_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indptr_c, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indices_c, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pidxs_c, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_match0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__match0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_match1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__match1_, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_poss, __pyx_n_s_key, __pyx_n_s_nrow, __pyx_n_s_indptr_r, __pyx_n_s_indices_r, __pyx_n_s_score_r, __pyx_n_s_indptr_c, __pyx_n_s_indices_c, __pyx_n_s_pidxs_c, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_rr, __pyx_n_s_ccol, __pyx_n_s_crow, __pyx_n_s_curr, __pyx_n_s_match0, __pyx_n_s_match0_2, __pyx_n_s_match1, __pyx_n_s_match1_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_13simple_match_symm, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simple_match_symm, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__38 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_simple_match_symm, 790, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">791</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">nrow</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="n">poss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyInt_As_npy_int32(__pyx_t_2); if (unlikely((__pyx_t_3 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_nrow = (((__pyx_t_9functions_CINT32)__pyx_t_3) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">792</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">793</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">indptr_r</span> <span class="o">=</span> <span class="n">poss</span><span class="o">.</span><span class="n">rindptr</span></pre>
<pre class='cython code score-3 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_rindptr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 793, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_indptr_r = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">794</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">indices_r</span> <span class="o">=</span> <span class="n">poss</span><span class="o">.</span><span class="n">rindices</span></pre>
<pre class='cython code score-3 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_rindices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_indices_r = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">795</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">score_r</span> <span class="o">=</span> <span class="n">poss</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_vals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_score_r = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">796</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">797</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">indptr_c</span> <span class="o">=</span> <span class="n">poss</span><span class="o">.</span><span class="n">cindptr</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_cindptr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_indptr_c = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">798</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">indices_c</span> <span class="o">=</span> <span class="n">poss</span><span class="o">.</span><span class="n">cindices</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_cindices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_indices_c = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">799</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">pidxs_c</span> <span class="o">=</span> <span class="n">poss</span><span class="o">.</span><span class="n">cdata</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_cdata);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_pidxs_c = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">800</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">801</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">j</span><span class="p">,</span> <span class="nf">rr</span><span class="p">,</span><span class="nf">ccol</span><span class="p">,</span><span class="nf">crow</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">802</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span> <span class="nf">curr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">803</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">804</span>:   <span class="n">match0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">poss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_match0 = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">805</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_match0_</span> <span class="o">=</span> <span class="n">match0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_match0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
  __pyx_v__match0_ = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">806</span>:   <span class="n">match1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">poss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poss, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_neg_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_match1 = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">807</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_match1_</span> <span class="o">=</span> <span class="n">match1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_match1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 807, __pyx_L1_error)</span>
  __pyx_v__match1_ = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">808</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">809</span>:   <span class="k">for</span> <span class="n">rr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrow</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_nrow;
  __pyx_t_9 = __pyx_t_3;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_rr = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">810</span>:     <span class="n">curr</span> <span class="o">=</span> <span class="n">_0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_curr = __pyx_v_9functions__0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">811</span>:     <span class="n">ccol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ccol = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">812</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indptr_r</span><span class="p">[</span><span class="n">rr</span><span class="p">],</span><span class="n">indptr_r</span><span class="p">[</span><span class="n">rr</span><span class="o">+</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = (__pyx_v_rr + 1);
    __pyx_t_12 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indptr_r.data + __pyx_t_11 * __pyx_v_indptr_r.strides[0]) )));
    __pyx_t_11 = __pyx_v_rr;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indptr_r.data + __pyx_t_11 * __pyx_v_indptr_r.strides[0]) ))); __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">813</span>:       <span class="k">if</span> <span class="n">score_r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="n">curr</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = (((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_score_r.data + __pyx_t_15 * __pyx_v_score_r.strides[0]) ))) &gt; __pyx_v_curr) != 0);
      if (__pyx_t_16) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">814</span>:         <span class="n">curr</span> <span class="o">=</span> <span class="n">score_r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = __pyx_v_j;
        __pyx_v_curr = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_score_r.data + __pyx_t_15 * __pyx_v_score_r.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">815</span>:         <span class="n">ccol</span> <span class="o">=</span> <span class="n">indices_r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = __pyx_v_j;
        __pyx_v_ccol = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indices_r.data + __pyx_t_15 * __pyx_v_indices_r.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">816</span>:     <span class="k">if</span> <span class="n">ccol</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = ((__pyx_v_ccol &lt; 0) != 0);
    if (__pyx_t_16) {
      goto __pyx_L3_continue;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">817</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">818</span>:     <span class="n">curr</span> <span class="o">=</span> <span class="n">_0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_curr = __pyx_v_9functions__0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">819</span>:     <span class="n">crow</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_crow = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">820</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indptr_c</span><span class="p">[</span><span class="n">ccol</span><span class="p">],</span><span class="n">indptr_c</span><span class="p">[</span><span class="n">ccol</span><span class="o">+</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = (__pyx_v_ccol + 1);
    __pyx_t_12 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indptr_c.data + __pyx_t_11 * __pyx_v_indptr_c.strides[0]) )));
    __pyx_t_11 = __pyx_v_ccol;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indptr_c.data + __pyx_t_11 * __pyx_v_indptr_c.strides[0]) ))); __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">821</span>:       <span class="k">if</span> <span class="n">score_r</span><span class="p">[</span><span class="n">pidxs_c</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">curr</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_j;
      __pyx_t_17 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_pidxs_c.data + __pyx_t_15 * __pyx_v_pidxs_c.strides[0]) )));
      __pyx_t_16 = (((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_score_r.data + __pyx_t_17 * __pyx_v_score_r.strides[0]) ))) &gt; __pyx_v_curr) != 0);
      if (__pyx_t_16) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">822</span>:         <span class="n">curr</span> <span class="o">=</span> <span class="n">score_r</span><span class="p">[</span><span class="n">pidxs_c</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = __pyx_v_j;
        __pyx_t_17 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_pidxs_c.data + __pyx_t_15 * __pyx_v_pidxs_c.strides[0]) )));
        __pyx_v_curr = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_score_r.data + __pyx_t_17 * __pyx_v_score_r.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">823</span>:         <span class="n">crow</span> <span class="o">=</span> <span class="n">indices_c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = __pyx_v_j;
        __pyx_v_crow = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_indices_c.data + __pyx_t_15 * __pyx_v_indices_c.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">824</span>:     <span class="k">if</span> <span class="n">crow</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_16 = ((__pyx_v_crow &lt; 0) != 0);
    if (__pyx_t_16) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
      __pyx_r = __pyx_int_neg_1;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">825</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">826</span>:     <span class="k">if</span> <span class="n">crow</span><span class="o">!=</span><span class="n">rr</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = ((__pyx_v_crow != __pyx_v_rr) != 0);
    if (__pyx_t_16) {
      goto __pyx_L3_continue;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">827</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">828</span>:     <span class="k">if</span> <span class="n">_match0_</span><span class="p">[</span><span class="n">rr</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">2</span></pre>
<pre class='cython code score-2 '>    __pyx_t_11 = __pyx_v_rr;
    __pyx_t_16 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__match0_.data + __pyx_t_11 * __pyx_v__match0_.strides[0]) ))) &gt;= 0) != 0);
    if (__pyx_t_16) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_2);
      __pyx_r = __pyx_int_neg_2;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">829</span>:     <span class="k">if</span> <span class="n">_match1_</span><span class="p">[</span><span class="n">ccol</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">3</span></pre>
<pre class='cython code score-2 '>    __pyx_t_11 = __pyx_v_ccol;
    __pyx_t_16 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__match1_.data + __pyx_t_11 * __pyx_v__match1_.strides[0]) ))) &gt;= 0) != 0);
    if (__pyx_t_16) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_3);
      __pyx_r = __pyx_int_neg_3;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">830</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">831</span>:     <span class="n">_match0_</span><span class="p">[</span><span class="n">rr</span><span class="p">]</span> <span class="o">=</span> <span class="n">ccol</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_rr;
    *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__match0_.data + __pyx_t_11 * __pyx_v__match0_.strides[0]) )) = __pyx_v_ccol;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">832</span>:     <span class="n">_match1_</span><span class="p">[</span><span class="n">ccol</span><span class="p">]</span> <span class="o">=</span> <span class="n">rr</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_ccol;
    *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__match1_.data + __pyx_t_11 * __pyx_v__match1_.strides[0]) )) = __pyx_v_rr;
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">833</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">834</span>:   <span class="k">return</span> <span class="n">match0</span><span class="p">,</span> <span class="n">match1</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_match0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_match0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_match0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_match1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_match1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_match1);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">835</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">837</span>: <span class="c"># ------------------------- PYTHON INTEFACE FUNCTIONS --------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">838</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">839</span>: <span class="c"># ------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">840</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">841</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">842</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">843</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">844</span>: <span class="k">def</span> <span class="nf">find_dEs</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">):</span></pre>
<pre class='cython code score-48 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_15find_dEs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_15find_dEs = {"find_dEs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_15find_dEs, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_15find_dEs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_Es0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Es1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_dEs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Es0,&amp;__pyx_n_s_Es1,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_dEs", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_dEs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_Es0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es0.memview)) __PYX_ERR(0, 844, __pyx_L3_error)</span>
    __pyx_v_Es1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es1.memview)) __PYX_ERR(0, 844, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_dEs", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.find_dEs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_14find_dEs(__pyx_self, __pyx_v_Es0, __pyx_v_Es1);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_14find_dEs(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_Es0, __Pyx_memviewslice __pyx_v_Es1) {
  __pyx_t_9functions_CUINT8 __pyx_v_n0;
  __pyx_t_9functions_CUINT8 __pyx_v_n1;
  PyObject *__pyx_v_dEs0 = NULL;
  __Pyx_memviewslice __pyx_v__dEs0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_dEs1 = NULL;
  __Pyx_memviewslice __pyx_v__dEs1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mtc0 = NULL;
  __Pyx_memviewslice __pyx_v__mtc0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mtc1 = NULL;
  __Pyx_memviewslice __pyx_v__mtc1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_dEs", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.find_dEs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dEs0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__dEs0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dEs1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__dEs1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtc0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__mtc0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtc1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__mtc1_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es1, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_Es0, __pyx_n_s_Es1, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_dEs0, __pyx_n_s_dEs0_2, __pyx_n_s_dEs1, __pyx_n_s_dEs1_2, __pyx_n_s_mtc0, __pyx_n_s_mtc0_2, __pyx_n_s_mtc1, __pyx_n_s_mtc1_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_15find_dEs, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_dEs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__40 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_find_dEs, 844, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">845</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">846</span>:   <span class="k">cdef</span> <span class="kt">CUINT8</span> <span class="nf">n0</span><span class="o">=</span><span class="p">&lt;</span><span class="kt">CUINT8</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">Es0</span><span class="p">),</span> <span class="n">n1</span><span class="o">=</span><span class="p">&lt;</span><span class="kt">CUINT8</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">Es1</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es0); 
  __pyx_v_n0 = ((__pyx_t_9functions_CUINT8)__pyx_t_1);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es1); 
  __pyx_v_n1 = ((__pyx_t_9functions_CUINT8)__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">847</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">848</span>:   <span class="n">dEs0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_npy_uint8(__pyx_v_n0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dEs0 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">849</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_dEs0_</span> <span class="o">=</span> <span class="n">dEs0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_dEs0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 849, __pyx_L1_error)</span>
  __pyx_v__dEs0_ = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">850</span>:   <span class="n">dEs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_npy_uint8(__pyx_v_n1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_dEs1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">851</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_dEs1_</span> <span class="o">=</span> <span class="n">dEs1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_dEs1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
  __pyx_v__dEs1_ = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">852</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">853</span>:   <span class="n">mtc0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_npy_uint8(__pyx_v_n0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_mtc0 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">854</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_mtc0_</span> <span class="o">=</span> <span class="n">mtc0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_mtc0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 854, __pyx_L1_error)</span>
  __pyx_v__mtc0_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">855</span>:   <span class="n">mtc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_uint8(__pyx_v_n1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_mtc1 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">856</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_mtc1_</span> <span class="o">=</span> <span class="n">mtc1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_mtc1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
  __pyx_v__mtc1_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">857</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">858</span>:   <span class="n">_match_pair</span><span class="p">(</span><span class="n">Es0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">_dEs0_</span><span class="p">,</span> <span class="n">_mtc0_</span><span class="p">,</span> <span class="n">Es1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">_dEs1_</span><span class="p">,</span> <span class="n">_mtc1_</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (void)(__pyx_f_9functions__match_pair(__pyx_v_Es0, 0, __pyx_v_n0, __pyx_v__dEs0_, __pyx_v__mtc0_, __pyx_v_Es1, 0, __pyx_v_n1, __pyx_v__dEs1_, __pyx_v__mtc1_));
</pre><pre class="cython line score-0">&#xA0;<span class="">859</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">860</span>:   <span class="k">return</span> <span class="n">dEs0</span><span class="p">,</span> <span class="n">dEs1</span><span class="p">,</span> <span class="n">mtc0</span><span class="p">,</span> <span class="n">mtc1</span></pre>
<pre class='cython code score-14 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dEs0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dEs0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_dEs0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dEs1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dEs1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_dEs1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtc0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtc0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_mtc0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtc1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtc1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_v_mtc1);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">861</span>: <span class="c"># -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">862</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">863</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">864</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">865</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">866</span>: <span class="c"># Error code -25000</span></pre>
<pre class="cython line score-124" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">867</span>: <span class="k">def</span> <span class="nf">info_match_lns</span><span class="p">(</span><span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es0</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">As0</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns0</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">idxs0</span><span class="p">,</span></pre>
<pre class='cython code score-124 '>/* Python wrapper */
static PyObject *__pyx_pw_9functions_17info_match_lns(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9functions_17info_match_lns = {"info_match_lns", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9functions_17info_match_lns, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9functions_17info_match_lns(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_Es0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_As0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_idxs0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Es1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_As1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ns1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_idxs1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE;
  __pyx_t_9functions_CFLOAT32 __pyx_v_density;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("info_match_lns (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Es0,&amp;__pyx_n_s_As0,&amp;__pyx_n_s_ns0,&amp;__pyx_n_s_idxs0,&amp;__pyx_n_s_Es1,&amp;__pyx_n_s_As1,&amp;__pyx_n_s_ns1,&amp;__pyx_n_s_idxs1,&amp;__pyx_n_s_max_dE,&amp;__pyx_n_s_density,0};
    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_As0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 1); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 2); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_idxs0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 3); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Es1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 4); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_As1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 5); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ns1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 6); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_idxs1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 7); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_dE)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, 8); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density);
          if (value) { values[9] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "info_match_lns") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_Es0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es0.memview)) __PYX_ERR(0, 867, __pyx_L3_error)</span>
    __pyx_v_As0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_As0.memview)) __PYX_ERR(0, 867, __pyx_L3_error)</span>
    __pyx_v_ns0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns0.memview)) __PYX_ERR(0, 867, __pyx_L3_error)</span>
    __pyx_v_idxs0 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_idxs0.memview)) __PYX_ERR(0, 867, __pyx_L3_error)</span>
    __pyx_v_Es1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Es1.memview)) __PYX_ERR(0, 868, __pyx_L3_error)</span>
    __pyx_v_As1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_As1.memview)) __PYX_ERR(0, 868, __pyx_L3_error)</span>
    __pyx_v_ns1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ns1.memview)) __PYX_ERR(0, 868, __pyx_L3_error)</span>
    __pyx_v_idxs1 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_idxs1.memview)) __PYX_ERR(0, 868, __pyx_L3_error)</span>
    __pyx_v_max_dE = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_max_dE == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
    if (values[9]) {
      __pyx_v_density = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_density == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
    } else {
      __pyx_v_density = __pyx_k_;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("info_match_lns", 0, 9, 10, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.info_match_lns", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9functions_16info_match_lns(__pyx_self, __pyx_v_Es0, __pyx_v_As0, __pyx_v_ns0, __pyx_v_idxs0, __pyx_v_Es1, __pyx_v_As1, __pyx_v_ns1, __pyx_v_idxs1, __pyx_v_max_dE, __pyx_v_density);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9functions_16info_match_lns(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_Es0, __Pyx_memviewslice __pyx_v_As0, __Pyx_memviewslice __pyx_v_ns0, __Pyx_memviewslice __pyx_v_idxs0, __Pyx_memviewslice __pyx_v_Es1, __Pyx_memviewslice __pyx_v_As1, __Pyx_memviewslice __pyx_v_ns1, __Pyx_memviewslice __pyx_v_idxs1, __pyx_t_9functions_CFLOAT32 __pyx_v_max_dE, __pyx_t_9functions_CFLOAT32 __pyx_v_density) {
  __pyx_t_9functions_CINT32 __pyx_v_N;
  __pyx_t_9functions_CINT32 __pyx_v_lmax;
  PyObject *__pyx_v_cidx0 = NULL;
  __Pyx_memviewslice __pyx_v__cidx0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_cidx1 = NULL;
  __Pyx_memviewslice __pyx_v__cidx1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CUINT64 __pyx_v_nMax;
  PyObject *__pyx_v_out_dEs = NULL;
  __Pyx_memviewslice __pyx_v__out_dEs_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_out_Es = NULL;
  __Pyx_memviewslice __pyx_v__out_Es_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_out_As = NULL;
  __Pyx_memviewslice __pyx_v__out_As_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_out_mtc = NULL;
  __Pyx_memviewslice __pyx_v__out_mtc_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_out_cnt = NULL;
  __Pyx_memviewslice __pyx_v__out_cnt_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_dEs0 = NULL;
  __Pyx_memviewslice __pyx_v__dEs0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_dEs1 = NULL;
  __Pyx_memviewslice __pyx_v__dEs1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mtc0 = NULL;
  __Pyx_memviewslice __pyx_v__mtc0_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mtc1 = NULL;
  __Pyx_memviewslice __pyx_v__mtc1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_done = NULL;
  __Pyx_memviewslice __pyx_v__done_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_9functions_CINT32 __pyx_v_i;
  __pyx_t_9functions_CINT32 __pyx_v_k;
  __pyx_t_9functions_CINT32 __pyx_v_ret;
  __pyx_t_9functions_CUINT64 __pyx_v_iseq;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("info_match_lns", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("functions.info_match_lns", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cidx0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__cidx0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cidx1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__cidx1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_dEs);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__out_dEs_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_Es);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__out_Es_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_As);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__out_As_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_mtc);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__out_mtc_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_cnt);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__out_cnt_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dEs0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__dEs0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dEs1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__dEs1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtc0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__mtc0_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtc1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__mtc1_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_done);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v__done_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_As0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_idxs0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Es1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_As1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ns1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_idxs1, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(41, __pyx_n_s_Es0, __pyx_n_s_As0, __pyx_n_s_ns0, __pyx_n_s_idxs0, __pyx_n_s_Es1, __pyx_n_s_As1, __pyx_n_s_ns1, __pyx_n_s_idxs1, __pyx_n_s_max_dE, __pyx_n_s_density, __pyx_n_s_N, __pyx_n_s_lmax, __pyx_n_s_cidx0, __pyx_n_s_cidx0_2, __pyx_n_s_cidx1, __pyx_n_s_cidx1_2, __pyx_n_s_nMax, __pyx_n_s_out_dEs, __pyx_n_s_out_dEs_2, __pyx_n_s_out_Es, __pyx_n_s_out_Es_2, __pyx_n_s_out_As, __pyx_n_s_out_As_2, __pyx_n_s_out_mtc, __pyx_n_s_out_mtc_2, __pyx_n_s_out_cnt, __pyx_n_s_out_cnt_2, __pyx_n_s_dEs0, __pyx_n_s_dEs0_2, __pyx_n_s_dEs1, __pyx_n_s_dEs1_2, __pyx_n_s_mtc0, __pyx_n_s_mtc0_2, __pyx_n_s_mtc1, __pyx_n_s_mtc1_2, __pyx_n_s_done, __pyx_n_s_done_2, __pyx_n_s_i, __pyx_n_s_k, __pyx_n_s_ret, __pyx_n_s_iseq);<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_9functions_17info_match_lns, NULL, __pyx_n_s_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_info_match_lns, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__42 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(10, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_functions_pyx, __pyx_n_s_info_match_lns, 867, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">868</span>:                    <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">CFLOAT32</span><span class="p">[:]</span> <span class="n">As1</span><span class="p">,</span> <span class="n">CUINT8</span><span class="p">[:]</span> <span class="n">ns1</span><span class="p">,</span> <span class="n">CINT32</span><span class="p">[:]</span> <span class="n">idxs1</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">max_dE</span><span class="p">,</span> <span class="n">CFLOAT32</span> <span class="n">density</span><span class="o">=</span><span class="n">_1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_k_ = __pyx_v_9functions__1;
</pre><pre class="cython line score-0">&#xA0;<span class="">869</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">870</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">N</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">idxs0</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_idxs0); 
  __pyx_v_N = ((__pyx_t_9functions_CINT32)__pyx_t_1);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">871</span>:   <span class="k">assert</span> <span class="n">N</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idxs1</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_idxs1); 
    if (unlikely(!((__pyx_v_N == __pyx_t_1) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 871, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">872</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns0</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es0); 
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">873</span>:   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Es1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns1</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(__pyx_assertions_enabled())) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_Es1); 
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_sum, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">874</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">lmax</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CINT32</span><span class="p">&gt;</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">ns0</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">ns1</span><span class="p">))</span></pre>
<pre class='cython code score-24 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_4 = __pyx_t_2;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_4 = __pyx_t_3;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = __Pyx_PyInt_As_npy_int32(__pyx_t_4); if (unlikely((__pyx_t_7 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_lmax = ((__pyx_t_9functions_CINT32)__pyx_t_7);
</pre><pre class="cython line score-0">&#xA0;<span class="">875</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">876</span>:   <span class="n">cidx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_ns0, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_10, __pyx_int_0, __pyx_int_0};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_10, __pyx_int_0, __pyx_int_0};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_11, __pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_11, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_11, __pyx_int_0);
    __pyx_t_10 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cidx0 = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">877</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_cidx0_</span> <span class="o">=</span> <span class="n">cidx0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_cidx0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
  __pyx_v__cidx0_ = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">878</span>:   <span class="n">cidx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ns1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-74 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_ns1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_9functions_CUINT8, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_9functions_CUINT8, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_11 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_9, __pyx_int_0, __pyx_int_0};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_9, __pyx_int_0, __pyx_int_0};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_11, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_11, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_11, __pyx_int_0);
    __pyx_t_9 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_cidx1 = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">879</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_cidx1_</span> <span class="o">=</span> <span class="n">cidx1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_cidx1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 879, __pyx_L1_error)</span>
  __pyx_v__cidx1_ = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">880</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">881</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">nMax</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">CUINT64</span><span class="p">&gt;(</span><span class="mf">2</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">lmax</span><span class="o">*</span><span class="n">density</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nMax = ((__pyx_t_9functions_CUINT64)(((2 * __pyx_v_N) * __pyx_v_lmax) * __pyx_v_density));
</pre><pre class="cython line score-0">&#xA0;<span class="">882</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">883</span>:   <span class="n">out_dEs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_npy_uint64(__pyx_v_nMax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out_dEs = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">884</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_out_dEs_</span> <span class="o">=</span> <span class="n">out_dEs</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_out_dEs, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 884, __pyx_L1_error)</span>
  __pyx_v__out_dEs_ = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">885</span>:   <span class="n">out_Es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_uint64(__pyx_v_nMax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_out_Es = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">886</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_out_Es_</span> <span class="o">=</span> <span class="n">out_Es</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_out_Es, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
  __pyx_v__out_Es_ = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">887</span>:   <span class="n">out_As</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = __Pyx_PyInt_From_npy_uint64(__pyx_v_nMax);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_out_As = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">888</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_out_As_</span> <span class="o">=</span> <span class="n">out_As</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_out_As, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 888, __pyx_L1_error)</span>
  __pyx_v__out_As_ = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">889</span>:   <span class="n">out_mtc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __Pyx_PyInt_From_npy_uint64(__pyx_v_nMax);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_out_mtc = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">890</span>:   <span class="k">cdef</span> <span class="kt">CINT8</span>[<span class="p">:]</span> <span class="n">_out_mtc_</span> <span class="o">=</span> <span class="n">out_mtc</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT8(__pyx_v_out_mtc, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 890, __pyx_L1_error)</span>
  __pyx_v__out_mtc_ = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">891</span>:   <span class="n">out_cnt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_npy_int32(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out_cnt = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">892</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_out_cnt_</span> <span class="o">=</span> <span class="n">out_cnt</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_out_cnt, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  __pyx_v__out_cnt_ = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">893</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">894</span>:   <span class="n">dEs0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dEs0 = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">895</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_dEs0_</span> <span class="o">=</span> <span class="n">dEs0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_dEs0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 895, __pyx_L1_error)</span>
  __pyx_v__dEs0_ = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">896</span>:   <span class="n">dEs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_dEs1 = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">897</span>:   <span class="k">cdef</span> <span class="kt">CFLOAT32</span>[<span class="p">:]</span> <span class="n">_dEs1_</span> <span class="o">=</span> <span class="n">dEs1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CFLOAT32(__pyx_v_dEs1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
  __pyx_v__dEs1_ = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">898</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">899</span>:   <span class="n">mtc0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_neg_1);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_mtc0 = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">900</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_mtc0_</span> <span class="o">=</span> <span class="n">mtc0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_mtc0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  __pyx_v__mtc0_ = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">901</span>:   <span class="n">mtc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_full);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_neg_1);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_mtc1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">902</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span>[<span class="p">:]</span> <span class="n">_mtc1_</span> <span class="o">=</span> <span class="n">mtc1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CINT32(__pyx_v_mtc1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 902, __pyx_L1_error)</span>
  __pyx_v__mtc1_ = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">903</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">904</span>:   <span class="n">done</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_lmax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_done = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">905</span>:   <span class="k">cdef</span> <span class="kt">CUINT8</span>[<span class="p">:]</span> <span class="n">_done_</span> <span class="o">=</span> <span class="n">done</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_9functions_CUINT8(__pyx_v_done, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 905, __pyx_L1_error)</span>
  __pyx_v__done_ = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">906</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">907</span>:   <span class="k">cdef</span> <span class="kt">CINT32</span> <span class="nf">i</span><span class="p">,</span><span class="nf">k</span><span class="p">,</span><span class="nf">ret</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">908</span>:   <span class="k">cdef</span> <span class="kt">CUINT64</span> <span class="nf">iseq</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_iseq = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">909</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">910</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">911</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_N;
  __pyx_t_16 = __pyx_t_7;
  for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">912</span>:     <span class="n">ret</span><span class="o">=</span><span class="n">_match_pair</span><span class="p">(</span><span class="n">Es0</span><span class="p">,</span> <span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">ns0</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">_dEs0_</span><span class="p">,</span> <span class="n">_mtc0_</span><span class="p">,</span> <span class="n">Es1</span><span class="p">,</span> <span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">ns1</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">_dEs1_</span><span class="p">,</span> <span class="n">_mtc1_</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_18 * __pyx_v_idxs0.strides[0]) )));
    __pyx_t_20 = __pyx_v_i;
    __pyx_t_21 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_20 * __pyx_v_idxs0.strides[0]) )));
    __pyx_t_22 = __pyx_v_i;
    __pyx_t_23 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_22 * __pyx_v_idxs1.strides[0]) )));
    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_24 * __pyx_v_idxs1.strides[0]) )));
    __pyx_v_ret = __pyx_f_9functions__match_pair(__pyx_v_Es0, (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_19 * __pyx_v__cidx0_.strides[0]) ))), (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_21 * __pyx_v_ns0.strides[0]) ))), __pyx_v__dEs0_, __pyx_v__mtc0_, __pyx_v_Es1, (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_23 * __pyx_v__cidx1_.strides[0]) ))), (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_25 * __pyx_v_ns1.strides[0]) ))), __pyx_v__dEs1_, __pyx_v__mtc1_);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">913</span>:     <span class="k">if</span> <span class="n">ret</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ret</span></pre>
<pre class='cython code score-1 '>    __pyx_t_5 = ((__pyx_v_ret &lt; 0) != 0);
    if (__pyx_t_5) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_9 = __Pyx_PyInt_From_npy_int32(__pyx_v_ret);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 913, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_r = __pyx_t_9;
      __pyx_t_9 = 0;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">914</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">915</span>:     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lmax</span><span class="p">):</span> <span class="n">_done_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_26 = __pyx_v_lmax;
    __pyx_t_27 = __pyx_t_26;
    for (__pyx_t_28 = 0; __pyx_t_28 &lt; __pyx_t_27; __pyx_t_28+=1) {
      __pyx_v_k = __pyx_t_28;
      __pyx_t_24 = __pyx_v_k;
      *((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v__done_.data + __pyx_t_24 * __pyx_v__done_.strides[0]) )) = 0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">916</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">917</span>:     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns0</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_24 * __pyx_v_idxs0.strides[0]) )));
    __pyx_t_29 = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns0.data + __pyx_t_25 * __pyx_v_ns0.strides[0]) )));
    __pyx_t_30 = __pyx_t_29;
    for (__pyx_t_26 = 0; __pyx_t_26 &lt; __pyx_t_30; __pyx_t_26+=1) {
      __pyx_v_k = __pyx_t_26;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">918</span>:       <span class="n">_out_cnt_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_i;
      *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__out_cnt_.data + __pyx_t_24 * __pyx_v__out_cnt_.strides[0]) )) += 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">919</span>:       <span class="n">_out_dEs_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">_dEs0_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_31 = __pyx_v_iseq;
      *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_dEs_.data + __pyx_t_31 * __pyx_v__out_dEs_.strides[0]) )) = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__dEs0_.data + __pyx_t_24 * __pyx_v__dEs0_.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">920</span>:       <span class="c"># Maybe matching lines</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">921</span>:       <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">_dEs0_</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_5 = ((fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__dEs0_.data + __pyx_t_24 * __pyx_v__dEs0_.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
      if (__pyx_t_5) {
/* … */
        goto __pyx_L10;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">922</span>:         <span class="n">_out_Es_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Es0</span><span class="p">[</span><span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">Es1</span><span class="p">[</span><span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">_mtc0_</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span><span class="o">/</span><span class="n">_2</span></pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_i;
        __pyx_t_25 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_24 * __pyx_v_idxs0.strides[0]) )));
        __pyx_t_22 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_25 * __pyx_v__cidx0_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_23 = __pyx_v_i;
        __pyx_t_20 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_23 * __pyx_v_idxs1.strides[0]) )));
        __pyx_t_21 = __pyx_v_k;
        __pyx_t_18 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_20 * __pyx_v__cidx1_.strides[0]) ))) + (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc0_.data + __pyx_t_21 * __pyx_v__mtc0_.strides[0]) ))));
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_Es_.data + __pyx_t_31 * __pyx_v__out_Es_.strides[0]) )) = (((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_22 * __pyx_v_Es0.strides[0]) ))) + (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_18 * __pyx_v_Es1.strides[0]) )))) / __pyx_v_9functions__2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">923</span>:         <span class="n">_out_As_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">As0</span><span class="p">[</span><span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">As1</span><span class="p">[</span><span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">_mtc0_</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span><span class="o">/</span><span class="n">_2</span></pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_i;
        __pyx_t_23 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_21 * __pyx_v_idxs0.strides[0]) )));
        __pyx_t_20 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_23 * __pyx_v__cidx0_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_18 = __pyx_v_i;
        __pyx_t_24 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_18 * __pyx_v_idxs1.strides[0]) )));
        __pyx_t_25 = __pyx_v_k;
        __pyx_t_22 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_24 * __pyx_v__cidx1_.strides[0]) ))) + (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc0_.data + __pyx_t_25 * __pyx_v__mtc0_.strides[0]) ))));
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_As_.data + __pyx_t_31 * __pyx_v__out_As_.strides[0]) )) = (((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_As0.data + __pyx_t_20 * __pyx_v_As0.strides[0]) ))) + (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_As1.data + __pyx_t_22 * __pyx_v_As1.strides[0]) )))) / __pyx_v_9functions__2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">924</span>:         <span class="k">if</span> <span class="n">_mtc1_</span><span class="p">[</span><span class="n">_mtc0_</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">==</span><span class="n">k</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_25 = __pyx_v_k;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc0_.data + __pyx_t_25 * __pyx_v__mtc0_.strides[0]) )));
        __pyx_t_5 = (((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc1_.data + __pyx_t_18 * __pyx_v__mtc1_.strides[0]) ))) == __pyx_v_k) != 0);
        if (__pyx_t_5) {
/* … */
          goto __pyx_L11;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">925</span>:           <span class="n">_out_mtc_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>          __pyx_t_31 = __pyx_v_iseq;
          *((__pyx_t_9functions_CINT8 *) ( /* dim=0 */ (__pyx_v__out_mtc_.data + __pyx_t_31 * __pyx_v__out_mtc_.strides[0]) )) = 2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">926</span>:           <span class="n">_done_</span><span class="p">[</span><span class="n">_mtc0_</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_t_25 = __pyx_v_k;
          __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc0_.data + __pyx_t_25 * __pyx_v__mtc0_.strides[0]) )));
          *((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v__done_.data + __pyx_t_18 * __pyx_v__done_.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">927</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">928</span>:           <span class="n">_out_mtc_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_31 = __pyx_v_iseq;
          *((__pyx_t_9functions_CINT8 *) ( /* dim=0 */ (__pyx_v__out_mtc_.data + __pyx_t_31 * __pyx_v__out_mtc_.strides[0]) )) = 0;
        }
        __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">929</span>:       <span class="c"># Non-matching lines</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">930</span>:       <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">931</span>:         <span class="n">_out_Es_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">Es0</span><span class="p">[</span><span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_25 = __pyx_v_i;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_25 * __pyx_v_idxs0.strides[0]) )));
        __pyx_t_24 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_18 * __pyx_v__cidx0_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_Es_.data + __pyx_t_31 * __pyx_v__out_Es_.strides[0]) )) = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_24 * __pyx_v_Es0.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">932</span>:         <span class="n">_out_As_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">As0</span><span class="p">[</span><span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_25 = __pyx_v_i;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_25 * __pyx_v_idxs0.strides[0]) )));
        __pyx_t_24 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_18 * __pyx_v__cidx0_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_As_.data + __pyx_t_31 * __pyx_v__out_As_.strides[0]) )) = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_As0.data + __pyx_t_24 * __pyx_v_As0.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">933</span>:         <span class="n">_out_mtc_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CINT8 *) ( /* dim=0 */ (__pyx_v__out_mtc_.data + __pyx_t_31 * __pyx_v__out_mtc_.strides[0]) )) = -1;
      }
      __pyx_L10:;
</pre><pre class="cython line score-0">&#xA0;<span class="">934</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">935</span>:       <span class="n">iseq</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_iseq = (__pyx_v_iseq + 1);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">936</span>:       <span class="k">if</span> <span class="n">iseq</span><span class="o">&gt;=</span><span class="n">nMax</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">25001</span></pre>
<pre class='cython code score-2 '>      __pyx_t_5 = ((__pyx_v_iseq &gt;= __pyx_v_nMax) != 0);
      if (__pyx_t_5) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_25001);
        __pyx_r = __pyx_int_neg_25001;
        goto __pyx_L0;
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">937</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">938</span>:     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns1</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_25 = __pyx_v_i;
    __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_25 * __pyx_v_idxs1.strides[0]) )));
    __pyx_t_29 = (*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v_ns1.data + __pyx_t_18 * __pyx_v_ns1.strides[0]) )));
    __pyx_t_30 = __pyx_t_29;
    for (__pyx_t_26 = 0; __pyx_t_26 &lt; __pyx_t_30; __pyx_t_26+=1) {
      __pyx_v_k = __pyx_t_26;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">939</span>:       <span class="k">if</span> <span class="n">_done_</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      __pyx_t_25 = __pyx_v_k;
      __pyx_t_5 = ((*((__pyx_t_9functions_CUINT8 *) ( /* dim=0 */ (__pyx_v__done_.data + __pyx_t_25 * __pyx_v__done_.strides[0]) ))) != 0);
      if (__pyx_t_5) {
        goto __pyx_L13_continue;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">940</span>:       <span class="n">_out_cnt_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_25 = __pyx_v_i;
      *((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__out_cnt_.data + __pyx_t_25 * __pyx_v__out_cnt_.strides[0]) )) += 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">941</span>:       <span class="n">_out_dEs_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">_dEs1_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_25 = __pyx_v_k;
      __pyx_t_31 = __pyx_v_iseq;
      *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_dEs_.data + __pyx_t_31 * __pyx_v__out_dEs_.strides[0]) )) = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__dEs1_.data + __pyx_t_25 * __pyx_v__dEs1_.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">942</span>:       <span class="c"># Maybe matching lines</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">943</span>:       <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">_dEs1_</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&lt;</span><span class="n">max_dE</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_25 = __pyx_v_k;
      __pyx_t_5 = ((fabsf((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__dEs1_.data + __pyx_t_25 * __pyx_v__dEs1_.strides[0]) )))) &lt; __pyx_v_max_dE) != 0);
      if (__pyx_t_5) {
/* … */
        goto __pyx_L16;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">944</span>:         <span class="n">_out_Es_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Es0</span><span class="p">[</span><span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">_mtc1_</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">+</span><span class="n">Es1</span><span class="p">[</span><span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">_2</span></pre>
<pre class='cython code score-0 '>        __pyx_t_25 = __pyx_v_i;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_25 * __pyx_v_idxs0.strides[0]) )));
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_22 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_18 * __pyx_v__cidx0_.strides[0]) ))) + (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc1_.data + __pyx_t_24 * __pyx_v__mtc1_.strides[0]) ))));
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_23 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_21 * __pyx_v_idxs1.strides[0]) )));
        __pyx_t_20 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_23 * __pyx_v__cidx1_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_Es_.data + __pyx_t_31 * __pyx_v__out_Es_.strides[0]) )) = (((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es0.data + __pyx_t_22 * __pyx_v_Es0.strides[0]) ))) + (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_20 * __pyx_v_Es1.strides[0]) )))) / __pyx_v_9functions__2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">945</span>:         <span class="n">_out_As_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">As0</span><span class="p">[</span><span class="n">_cidx0_</span><span class="p">[</span><span class="n">idxs0</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">_mtc1_</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">+</span><span class="n">As1</span><span class="p">[</span><span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">_2</span></pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_i;
        __pyx_t_23 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs0.data + __pyx_t_21 * __pyx_v_idxs0.strides[0]) )));
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_24 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx0_.data + __pyx_t_23 * __pyx_v__cidx0_.strides[0]) ))) + (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__mtc1_.data + __pyx_t_20 * __pyx_v__mtc1_.strides[0]) ))));
        __pyx_t_25 = __pyx_v_i;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_25 * __pyx_v_idxs1.strides[0]) )));
        __pyx_t_22 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_18 * __pyx_v__cidx1_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_As_.data + __pyx_t_31 * __pyx_v__out_As_.strides[0]) )) = (((*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_As0.data + __pyx_t_24 * __pyx_v_As0.strides[0]) ))) + (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_As1.data + __pyx_t_22 * __pyx_v_As1.strides[0]) )))) / __pyx_v_9functions__2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">946</span>:         <span class="n">_out_mtc_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CINT8 *) ( /* dim=0 */ (__pyx_v__out_mtc_.data + __pyx_t_31 * __pyx_v__out_mtc_.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">947</span>:       <span class="c"># Non-matching lines</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">948</span>:       <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">949</span>:         <span class="n">_out_Es_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">Es1</span><span class="p">[</span><span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_25 = __pyx_v_i;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_25 * __pyx_v_idxs1.strides[0]) )));
        __pyx_t_22 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_18 * __pyx_v__cidx1_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_Es_.data + __pyx_t_31 * __pyx_v__out_Es_.strides[0]) )) = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_Es1.data + __pyx_t_22 * __pyx_v_Es1.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">950</span>:         <span class="n">_out_As_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="n">As1</span><span class="p">[</span><span class="n">_cidx1_</span><span class="p">[</span><span class="n">idxs1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_25 = __pyx_v_i;
        __pyx_t_18 = (*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v_idxs1.data + __pyx_t_25 * __pyx_v_idxs1.strides[0]) )));
        __pyx_t_22 = ((*((__pyx_t_9functions_CINT32 *) ( /* dim=0 */ (__pyx_v__cidx1_.data + __pyx_t_18 * __pyx_v__cidx1_.strides[0]) ))) + __pyx_v_k);
        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v__out_As_.data + __pyx_t_31 * __pyx_v__out_As_.strides[0]) )) = (*((__pyx_t_9functions_CFLOAT32 *) ( /* dim=0 */ (__pyx_v_As1.data + __pyx_t_22 * __pyx_v_As1.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">951</span>:         <span class="n">_out_mtc_</span><span class="p">[</span><span class="n">iseq</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_31 = __pyx_v_iseq;
        *((__pyx_t_9functions_CINT8 *) ( /* dim=0 */ (__pyx_v__out_mtc_.data + __pyx_t_31 * __pyx_v__out_mtc_.strides[0]) )) = -1;
      }
      __pyx_L16:;
</pre><pre class="cython line score-0">&#xA0;<span class="">952</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">953</span>:       <span class="n">iseq</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_iseq = (__pyx_v_iseq + 1);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">954</span>:       <span class="k">if</span> <span class="n">iseq</span><span class="o">&gt;=</span><span class="n">nMax</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mf">25002</span></pre>
<pre class='cython code score-2 '>      __pyx_t_5 = ((__pyx_v_iseq &gt;= __pyx_v_nMax) != 0);
      if (__pyx_t_5) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_25002);
        __pyx_r = __pyx_int_neg_25002;
        goto __pyx_L0;
      }
      __pyx_L13_continue:;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">955</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">956</span>:   <span class="k">return</span> <span class="n">out_dEs</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">out_Es</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">out_As</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">out_mtc</span><span class="p">[:</span><span class="n">iseq</span><span class="p">],</span> <span class="n">out_cnt</span></pre>
<pre class='cython code score-20 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_out_dEs, 0, __pyx_v_iseq, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_out_Es, 0, __pyx_v_iseq, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_out_As, 0, __pyx_v_iseq, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_out_mtc, 0, __pyx_v_iseq, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out_cnt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out_cnt);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4, __pyx_v_out_cnt);
  __pyx_t_9 = 0;
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">957</span>: <span class="c"># -------</span></pre>
</div></body></html>
